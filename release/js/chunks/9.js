webpackJsonp([9],{80:function(e,t,a){var r,n;a(81),r=a(83),n=a(84),e.exports=r||{},e.exports.__esModule&&(e.exports=e.exports.default),n&&(("function"==typeof e.exports?e.exports.options:e.exports).template=n)},81:function(e,t,a){var r=a(82);"string"==typeof r&&(r=[[e.id,r,""]]);a(40)(r,{});r.locals&&(e.exports=r.locals)},82:function(e,t,a){t=e.exports=a(39)(),t.push([e.id,".popuptips-container[_v-d1dee2ce]{position:fixed;left:50%;top:40%;z-index:2000}.panel[_v-d1dee2ce]{position:relative;left:-50%}.fade-transition[_v-d1dee2ce]{-webkit-transition:all 1s ease;transition:all 1s ease}.fade-leave[_v-d1dee2ce]{opacity:0}","",{version:3,sources:["/./src/components/popupTips.vue.style"],names:[],mappings:"AAuCA,kCACA,eAAA,AACA,SAAA,AACA,QAAA,AACA,YAAA,CACA,AACA,oBACA,kBAAA,AACA,SAAA,CACA,AAEA,8BACA,+BAAA,sBAAA,CACA,AAEA,yBACA,SAAA,CACA",file:"popupTips.vue",sourcesContent:['<!-- popupTips.vue -->\n<template>\n\t<div class="popuptips-container" v-if="show" transition="fade">\n\t    <div class="panel panel-{{ tipsType }}">\n\t\t\t<div class="panel-heading">\n\t\t   \t\t<h3 class="panel-title">{{ tipsTitle }}</h3>\n\t\t\t</div>\n\t\t\t<div class="panel-body">\n\t\t    \t{{ tipsContent }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n    name: \'PopupTipsView\',\n    replace: false,\n    props: {\n    \tshow: Boolean,\n    \ttipsType: String,\n    \ttipsTitle: String,\n    \ttipsContent: String\n    },\n    watch: {\n        show(val, oldVal) {\n            if (val === true) {\n            \tsetTimeout(() => {\n            \t\tthis.show = false;\n            \t}, 1000);\n            }\n        },\n    },\n}\n\n</script>\n\n<style scoped>\n.popuptips-container {\n\tposition: fixed;\n\tleft: 50%;\n\ttop: 40%;\n    z-index: 2000;\n}\n.panel {\n\tposition: relative;\n    left: -50%;\n}\n\n.fade-transition {\n  transition: all 1s ease;\n}\n\n.fade-leave {\n  opacity: 0;\n}\n</style>'],sourceRoot:"webpack://"}])},83:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"PopupTipsView",replace:!1,props:{show:Boolean,tipsType:String,tipsTitle:String,tipsContent:String},watch:{show:function(e,t){var a=this;e===!0&&setTimeout(function(){a.show=!1},1e3)}}}},84:function(e,t){e.exports=' <div class=popuptips-container v-if=show transition=fade _v-d1dee2ce=""> <div class="panel panel-{{ tipsType }}" _v-d1dee2ce=""> <div class=panel-heading _v-d1dee2ce=""> <h3 class=panel-title _v-d1dee2ce="">{{ tipsTitle }}</h3> </div> <div class=panel-body _v-d1dee2ce=""> {{ tipsContent }} </div> </div> </div> '},85:function(e,t){"use strict";function a(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="产品名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="产品名称不能为空",t)}function r(e){var t={};return t.ok=!1,e?e.length>12?(t.errorMsg="产品数量长度不能大于12",t):(t.ok=!0,t):(t.errorMsg="产品数量不能为空",t)}function n(e){var t={};return t.ok=!1,!e||e<0?(t.errorMsg="产品价格不能为空且必须为正数",t):(t.ok=!0,t)}function o(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="客户名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="客户名称不能为空",t)}function s(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="收货人名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="收货人名称不能为空",t)}function i(e){var t={};t.ok=!1;var a=/^[0-9]{11}$/;return e?a.test(e)?(t.ok=!0,t):(t.errorMsg="收货人手机格式有误",t):(t.errorMsg="收货人手机不能为空",t)}function l(e,t){var a={};return a.ok=!1,0===e?(a.errorMsg="请选择收货人所在地省市区",a):t?t.length>50?(a.errorMsg="收货人详细地址不能大于50",a):(a.ok=!0,a):(a.errorMsg="收货人详细地址不能为空",a)}function d(e){var t={};return t.ok=!1,!e||e<0?(t.errorMsg="开票金额不能为空且必须为正数",t):(t.ok=!0,t)}function c(e,t){var a={};return a.ok=!1,t?t.length>50?(a.errorMsg=e+"长度不能大于50",a):(a.ok=!0,a):(a.errorMsg=e+"不能为空",a)}function p(e,t){var a={};return a.ok=!1,void 0===e||null===e||""===e?(a.errorMsg="使用额度不能为空",a):e<=0||e>t?(a.errorMsg="使用额度必须为正数且不能超过"+t/100+"元",a):(a.ok=!0,a)}function m(e,t){var a={};return a.ok=!1,void 0===e||null===e||""===e?(a.errorMsg="补充金额不能为空",a):e<=t?(a.errorMsg="补充金额必须大于"+t/100+"元",a):(a.ok=!0,a)}function v(e){var t={};return t.ok=!1,void 0===e||null===e||""===e?(t.errorMsg="额外成本不能为空",t):e<0?(t.errorMsg="额外成本必须大于等于0",t):(t.ok=!0,t)}function u(e,t){var a={};return a.ok=!1,t?t.length>2e3?(a.errorMsg=e+"长度不能大于2000",a):(a.ok=!0,a):(a.errorMsg=e+"不能为空",a)}function b(e,t){var a={};return a.ok=!1,e?e<0?(a.errorMsg="成本必须大于0",a):(a.ok=!0,a):t?(a.ok=!0,a):(a.errorMsg="成本不能为空或者0",a)}function h(e){var t={};return t.ok=!1,void 0===e||null===e||""===e?(t.errorMsg="物流成本不能为空",t):e<0?(t.errorMsg="物流成本必须大于等于0",t):(t.ok=!0,t)}function f(e,t){var a={};return a.ok=!1,t?t.length>2e3?(a.errorMsg=e+"长度不能大于2000",a):(a.ok=!0,a):(a.errorMsg=e+"不能为空",a)}function y(e,t){var a={};return a.ok=!1,!e||e<0?(a.errorMsg="退款金额不能为空且必须为正数",a):e>t?(a.errorMsg="退款金额不能大于"+t/100+"元",a):(a.ok=!0,a)}function g(e){var t={};return t.ok=!1,e?e.length>50?(t.errorMsg="对方账号长度不能大于50",t):(t.ok=!0,t):(t.errorMsg="对方账号不能为空",t)}function A(e){var t={};return t.ok=!1,e?e.length>2e3?(t.errorMsg="退款原因长度不能大于2000",t):(t.ok=!0,t):(t.errorMsg="退款原因不能为空",t)}function _(e,t){var a={};return a.ok=!1,!e||e<0?(a.errorMsg="付款金额不能为空且必须为正数",a):e>t?(a.errorMsg="付款金额不能大于该订单剩余的待支付金额("+t/100+"元)",a):(a.ok=!0,a)}function I(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="供应商名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="供应商名称不能为空",t)}function w(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="真实姓名长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="真实姓名不能为空",t)}function k(e){var t={};return t.ok=!1,e?e.length>50?(t.errorMsg="用户名长度不能大于50",t):(t.ok=!0,t):(t.errorMsg="用户名不能为空",t)}function R(e){var t={};t.ok=!1;var a=/^[a-zA-Z0-9]*$/;return e?e.length>20?(t.errorMsg="密码长度不能超过20",t):a.test(e)?(t.ok=!0,t):(t.errorMsg="密码只能包含英文字母和数字",t):(t.errorMsg="密码不能为空",t)}Object.defineProperty(t,"__esModule",{value:!0});var x="******";t.orderValidator={validateProductName:a,validateProductQuantity:r,validateProductPrice:n,validateCustomerName:o,validateConsigneeName:s,validateConsigneePhone:i,validateConsigneeAddress:l,validateInvoiceAmount:d,validateInvoiceItem:c,validateApplyInvoiceAmount:p,validateExtraAmount:m,validateExtraCost:v,validateAfterSaleItem:u,validateProductCost:b,validateLogisticsCost:h,validateLogisticsItem:f,validateRefundAmount:y,validateRefundAccount:g,validateRefundReason:A},t.financeValidator={validatePaymentAmount:_},t.crmValidator={validateSupplierName:I,validateDisplayName:w,validateUserName:k,validatePassword:R,DEFAULT_PASSWORD:x}},189:function(e,t,a){var r,n;a(190),r=a(192),n=a(198),e.exports=r||{},e.exports.__esModule&&(e.exports=e.exports.default),n&&(("function"==typeof e.exports?e.exports.options:e.exports).template=n)},190:function(e,t,a){var r=a(191);"string"==typeof r&&(r=[[e.id,r,""]]);a(40)(r,{});r.locals&&(e.exports=r.locals)},191:function(e,t,a){t=e.exports=a(39)(),t.push([e.id,".nav-pills>li>a[_v-263b0aa3]{cursor:pointer}.order-table[_v-263b0aa3],.order-thead-table[_v-263b0aa3],.receivables-table[_v-263b0aa3]{table-layout:fixed}.order-table td[_v-263b0aa3],.order-thead-table th[_v-263b0aa3],.receivables-table td[_v-263b0aa3],.receivables-table th[_v-263b0aa3]{text-align:center;vertical-align:middle}.order-table td .btn-link[_v-263b0aa3]{text-decoration:none;cursor:pointer}.order-table td .btn-link[_v-263b0aa3]:hover{text-decoration:underline}","",{version:3,sources:["/./src/views/finance/receivables.vue.style"],names:[],mappings:"AAqNA,6BACA,cAAA,CACA,AAEA,0FACA,kBAAA,CACA,AAEA,sIACA,kBAAA,AACA,qBAAA,CACA,AAEA,uCACA,qBAAA,AACA,cAAA,CACA,AAEA,6CACA,yBAAA,CACA",file:"receivables.vue",sourcesContent:['<!-- receivables.vue -->\n<template>\n    <div class="container-fluid">\n        <ul class="breadcrumb">\n            <li>财务系统</li>\n            <li>收款管理</li>\n        </ul>\n        <ul class="nav nav-pills">\n            <li :class="{\'active\': type === \'WAITING\'}" v-if="permissionList.view"><a @click="getList(\'WAITING\')">待付款录入</a></li>\n            <li :class="{\'active\': type === \'ALL\'}" v-if="permissionList.view"><a @click="getList(\'ALL\')">全部</a></li>\n        </ul>\n        <p class="clearfix"></p>\n        <form class="form-inline" style="margin-bottom:10px;" v-if="permissionList.view">\n            <label class="control-label" for="fitlerType">筛选：</label>\n            <select class="form-control input-sm" id="fitlerType" style="width:80px;" v-model="filterType">\n                <option value="customer">客户信息</option>\n            </select>\n            <input v-if="filterType === \'customer\'" class="form-control input-sm" style="width:120px;margin-left:20px;" type="text" placeholder="请输入客户信息" v-model="customerKeyword">\n            <a class="btn btn-info btn-sm" style="margin-left:30px;padding:6px 20px;" @click="getList(type, \'\', getFilterParams())">查询</a>\n        </form>\n        <h5 v-show="filterParams.customer">{{getQueryDesc()}}</h5>\n        <table class="table order-thead-table">\n            <thead>\n                <tr style="height:45px;background-color:#eee;">\n                    <th style="width:8%;">序号</th>\n                    <th style="width:20%;">订单日期</th>\n                    <th style="width:20%;">订单编号</th>\n                    <th style="width:40%;">客户名称/公司</th>\n                    <th style="width:12%;">订单金额</th>\n                </tr>\n            </thead>\n        </table>\n        <template v-for="orderItem in orderList">\n            <table class="table table-bordered table-hover order-table" style="margin-bottom:0px;">\n                <tbody>\n                    <tr style="height:45px;">\n                        <td style="width:8%;">{{$index + 1}}</td>\n                        <td style="width:20%;">{{orderItem.time | dateFormat \'toDate\'}}</td>\n                        <td style="width:20%;"><a class="btn-link" v-link="{path:\'/order/detail/\'+orderItem.id}" target="_blank">{{orderItem.id}}</a></td>\n                        <td style="width:40%;">{{orderItem.customer.name + (orderItem.customer.company ? \'/\' + orderItem.customer.company : \'\')}}</td>\n                        <td style="width:12%;">{{orderItem.amount + orderItem.freight | realPrice}}元</td>\n                    </tr>\n                </tbody>\n            </table>\n            <table class="table table-bordered table-hover receivables-table">\n                <thead>\n                    <tr style="background-color:#eee;">\n                        <th style="width:5%;">序号</th>\n                        <th style="width:14%;">付款时间</th>\n                        <th style="width:8%;">付款途径</th>\n                        <th style="width:10%;">付款方式</th>\n                        <th style="width:21%;">支付单号</th>\n                        <th style="width:10%;">付款金额</th>\n                        <th style="width:8%;">付款比例</th>\n                        <th style="width:14%;">付款备注</th>\n                        <th style="width:10%;">操作</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr v-if="orderItem.records.length === 0">\n                        <td colspan="7">尚无付款记录</td>\n                        <td>{{orderItem.payment_remark}}</td>\n                        <td>\n                            <a class="btn btn-info btn-sm" @click="clickToShowReceivablesRecordDialog(orderItem)" v-if="permissionList.recordReceivables">收款录入</a>\n                        </td>\n                    </tr>\n                    <template v-else>\n                        <tr v-for="item of orderItem.records">\n                            <td>{{$index + 1}}</td>\n                            <td>{{item.create_time | dateFormat}}</td>\n                            <td>{{item.method === \'PINGXX\' ? \'线上支付\' : \'线下转账\'}}</td>\n                            <td>{{item.method === \'PINGXX\' ? \'Ping++支付\' : (item.method === \'BANK_TRANSFER\' ? \'银行转账\' : \'支付宝转账\')}}</td>\n                            <td>{{item.payment_order_id}}</td>\n                            <td>{{item.amount | realPrice}}元</td>\n                            <td>{{Math.round(item.amount / (orderItem.amount + orderItem.freight) * 100)}}%</td>\n                            <td v-if="$index === 0" :rowspan="orderItem.records.length">{{orderItem.payment_remark}}</td>\n                            <td v-if="$index === 0" :rowspan="orderItem.records.length">\n                                <template v-if="orderItem.status === \'DELIVERY_PAID\' || orderItem.status === \'ONLINE_PAID\' || orderItem.status === \'ONLINE_CONFIRMED\' || orderItem.status === \'FINISHED\'">\n                                    付款成功\n                                </template>\n                                <template v-else>\n                                    <a class="btn btn-info btn-sm" @click="clickToShowReceivablesRecordDialog(orderItem)" v-if="permissionList.recordReceivables">收款录入</a>\n                                </template>\n                            </td>\n                        </tr>\n                    </template>\n                </tbody>\n            </table>\n        </template>\n        <a class="btn btn-primary" v-if="sinceId" @click="getList(type, sinceId, filterParams)">查看更多</a>\n        <record-receivables-dialog :show.sync="dataForRecordReceivablesDialog.show" :data="dataForRecordReceivablesDialog.data"></record-receivables-dialog>\n    </div>\n</template>\n\n<script>\nimport recordReceivablesDialog from \'./comp/recordReceivablesDialog.vue\'\nimport { callback } from \'../../store\'\nimport { unique } from \'../../filters\'\nimport { permissionValidator } from \'../../store/rolePermission.js\'\n\nexport default {\n    name: \'FinanceReceivablesView\',\n    components: {\n        recordReceivablesDialog,\n    },\n    data() {\n        return {\n            type: \'\',\n            sinceId: \'\',\n            orderList: [],\n            permissionList: {\n                view: permissionValidator.financeSystem.receivable.view(),\n                recordReceivables: permissionValidator.financeSystem.receivable.recordReceivables(),\n            },\n            filterType: \'customer\',\n            customerKeyword: \'\',\n            filterParams: {\n                customer: \'\',\n            },\n            dataForRecordReceivablesDialog: {\n                show: false,\n                data: {\n                    orderId: \'\',\n                    paymentMethod: \'\',\n                    paymentAmount: \'\',\n                    paymentOrderId: \'\',\n                    maxPaymentAmount: \'\',\n                },\n            },\n        }\n    },\n    ready() {\n        if (this.permissionList.view) {\n            this.getList(\'WAITING\');\n        }\n    },\n    events: {\n        \'add-receivables\'(data, orderItem) {\n            location.reload();\n        },\n    },\n    methods: {\n        getList(type, sinceId, filterParams) {\n            var url = \'/api/v2/admin/payment/order-list?type=\' + type;\n            if (sinceId) {\n                url += \'&since_id=\' + sinceId;\n            }\n            if (filterParams) {\n                if (filterParams.customer) {\n                    url += \'&customer=\' + filterParams.customer;\n                }\n            }\n            this.$http.get(url)\n            .then((response) => {\n                if (!response.data.result || response.data.result === 0) {\n                    var arr = [];\n                    if (sinceId) {\n                        arr = this.orderList.concat(response.data.orders);\n                    } else {\n                        arr = response.data.orders;\n                    }\n                    this.orderList = unique(arr);\n                    this.type = type;\n                    this.$set("sinceId", response.data.since_id || \'\');\n                    if (filterParams) {\n                        this.filterParams = filterParams;\n                    } else {\n                        this.filterParams = {\n                            customer: \'\',\n                        };\n                    }\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        clickToShowReceivablesRecordDialog(orderItem) {\n            var maxPaymentAmount = orderItem.amount + orderItem.freight;\n            for (let i = 0; i < orderItem.records.length; i++) {\n                maxPaymentAmount -= orderItem.records[i].amount;\n            }\n            this.dataForRecordReceivablesDialog.show = true;\n            this.dataForRecordReceivablesDialog.data.orderId = orderItem.id;\n            this.dataForRecordReceivablesDialog.data.paymentMethod = \'\';\n            this.dataForRecordReceivablesDialog.data.paymentAmount = \'\';\n            this.dataForRecordReceivablesDialog.data.paymentOrderId = \'\';\n            this.dataForRecordReceivablesDialog.data.maxPaymentAmount = maxPaymentAmount;\n            this.dataForRecordReceivablesDialog.data.passingData = orderItem;\n        },\n        getFilterParams() {\n            var filterParams = {\n                customer: \'\',\n            };\n            if (this.filterType === \'customer\') {\n                filterParams.customer = this.customerKeyword;\n            }\n            return filterParams;\n        },\n        getQueryDesc() {\n            if (!this.filterParams.customer) {\n                return;\n            }\n            if (this.filterParams.customer) {\n                return \'客户信息 {\' + this.filterParams.customer + \'} 的查询结果：\';\n            }\n        },\n    }\n}\n</script>\n\n<style scoped>\n.nav-pills > li > a{\n    cursor: pointer;\n}\n\n.order-table, .order-thead-table, .receivables-table{\n    table-layout: fixed;\n}\n\n.order-table td, .order-thead-table th, .receivables-table td, .receivables-table th {\n    text-align: center;\n    vertical-align: middle;\n}\n\n.order-table td .btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.order-table td .btn-link:hover {\n    text-decoration: underline;\n}\n</style>'],sourceRoot:"webpack://"}])},192:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(193),o=r(n),s=a(46),i=a(29),l=a(43);t.default={name:"FinanceReceivablesView",components:{recordReceivablesDialog:o.default},data:function(){return{type:"",sinceId:"",orderList:[],permissionList:{view:l.permissionValidator.financeSystem.receivable.view(),recordReceivables:l.permissionValidator.financeSystem.receivable.recordReceivables()},filterType:"customer",customerKeyword:"",filterParams:{customer:""},dataForRecordReceivablesDialog:{show:!1,data:{orderId:"",paymentMethod:"",paymentAmount:"",paymentOrderId:"",maxPaymentAmount:""}}}},ready:function(){this.permissionList.view&&this.getList("WAITING")},events:{"add-receivables":function(e,t){location.reload()}},methods:{getList:function(e,t,a){var r=this,n="/api/v2/admin/payment/order-list?type="+e;t&&(n+="&since_id="+t),a&&a.customer&&(n+="&customer="+a.customer),this.$http.get(n).then(function(n){if(n.data.result&&0!==n.data.result)s.callback.success(n.data);else{var o=[];o=t?r.orderList.concat(n.data.orders):n.data.orders,r.orderList=(0,i.unique)(o),r.type=e,r.$set("sinceId",n.data.since_id||""),a?r.filterParams=a:r.filterParams={customer:""}}},function(e){s.callback.error(e)})},clickToShowReceivablesRecordDialog:function(e){for(var t=e.amount+e.freight,a=0;a<e.records.length;a++)t-=e.records[a].amount;this.dataForRecordReceivablesDialog.show=!0,this.dataForRecordReceivablesDialog.data.orderId=e.id,this.dataForRecordReceivablesDialog.data.paymentMethod="",this.dataForRecordReceivablesDialog.data.paymentAmount="",this.dataForRecordReceivablesDialog.data.paymentOrderId="",this.dataForRecordReceivablesDialog.data.maxPaymentAmount=t,this.dataForRecordReceivablesDialog.data.passingData=e},getFilterParams:function(){var e={customer:""};return"customer"===this.filterType&&(e.customer=this.customerKeyword),e},getQueryDesc:function(){if(this.filterParams.customer)return this.filterParams.customer?"客户信息 {"+this.filterParams.customer+"} 的查询结果：":void 0}}}},193:function(e,t,a){var r,n;a(194),r=a(196),n=a(197),e.exports=r||{},e.exports.__esModule&&(e.exports=e.exports.default),n&&(("function"==typeof e.exports?e.exports.options:e.exports).template=n)},194:function(e,t,a){var r=a(195);"string"==typeof r&&(r=[[e.id,r,""]]);a(40)(r,{});r.locals&&(e.exports=r.locals)},195:function(e,t,a){t=e.exports=a(39)(),t.push([e.id,".modal[_v-52ff1b12]{height:100%}.modal-dialog[_v-52ff1b12]{top:20%}","",{version:3,sources:["/./src/views/finance/comp/recordReceivablesDialog.vue.style"],names:[],mappings:"AAwHA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"recordReceivablesDialog.vue",sourcesContent:['<!-- recordReceivablesDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n    \t<div class="modal-dialog">\n            <div class="modal-content">\n            \t<div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">收款信息录入</h4>\n                </div>\n                <div class="modal-body">\n                    <form class="form-horizontal">\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="paymentMethod">付款方式<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <select class="form-control input-sm" id="paymentMethod" v-model="data.paymentMethod">\n                                    <option value="BANK_TRANSFER">银行转账</option>\n                                    <option value="ALIPAY_TRANSFER">支付宝转账</option>\n                                </select>\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="paymentAmount">付款金额<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="paymentAmount" type="text" v-model="data.paymentAmount | priceFilter">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="paymentOrderId">支付单号：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="paymentOrderId" type="text" v-model="data.paymentOrderId">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { financeValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'RecordReceivablesDialogView\',\n    components: {\n        popupTips,\n    },\n    props: [\'show\', \'data\', \'passingData\'],\n    data() {\n        return {\n        \tbuttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    methods: {\n    \tvalidatePaymentInfo() {\n            var result;\n            if (!this.data.paymentMethod) {\n                return \'请选择付款方式\';\n            }\n            result = financeValidator.validatePaymentAmount(this.data.paymentAmount, this.data.maxPaymentAmount);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                this.addReceivables();\n            }\n        },\n        addReceivables() {\n        \tvar result = this.validatePaymentInfo();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var url = \'/api/v2/admin/payment/add-record?order_id=\' + this.data.orderId;\n            var data = {\n                method: this.data.paymentMethod,\n                amount: this.data.paymentAmount,\n                order_id: this.data.paymentOrderId,\n            };\n            this.$http.post(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.show = false;\n                    this.$dispatch(\'add-receivables\', data, this.data.passingData);\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \tcloseDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 20%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},196:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(80),o=r(n),s=a(46),i=a(85);t.default={name:"RecordReceivablesDialogView",components:{popupTips:o.default},props:["show","data","passingData"],data:function(){return{buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},methods:{validatePaymentInfo:function(){var e;return this.data.paymentMethod?(e=i.financeValidator.validatePaymentAmount(this.data.paymentAmount,this.data.maxPaymentAmount),e.ok?void 0:e.errorMsg):"请选择付款方式"},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.addReceivables())},addReceivables:function(){var e=this,t=this.validatePaymentInfo();if(t)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=t,void(this.buttonEnabled=!0);var a="/api/v2/admin/payment/add-record?order_id="+this.data.orderId,r={method:this.data.paymentMethod,amount:this.data.paymentAmount,order_id:this.data.paymentOrderId};this.$http.post(a,r).then(function(t){t.data.result&&0!==t.data.result?s.callback.success(t.data):(e.show=!1,e.$dispatch("add-receivables",r,e.data.passingData)),e.buttonEnabled=!0},function(t){s.callback.error(t),e.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},197:function(e,t){e.exports=' <div class=modal v-show=show _v-52ff1b12=""> <div class=modal-dialog _v-52ff1b12=""> <div class=modal-content _v-52ff1b12=""> <div class=modal-header _v-52ff1b12=""> <button type=button class=close @click=closeDialog _v-52ff1b12="">×</button> <h4 class=modal-title _v-52ff1b12="">收款信息录入</h4> </div> <div class=modal-body _v-52ff1b12=""> <form class=form-horizontal _v-52ff1b12=""> <div class=form-group _v-52ff1b12=""> <label class="col-lg-4 control-label" for=paymentMethod _v-52ff1b12="">付款方式<span class=text-danger _v-52ff1b12="">*</span>：</label> <div class=col-lg-6 _v-52ff1b12=""> <select class="form-control input-sm" id=paymentMethod v-model=data.paymentMethod _v-52ff1b12=""> <option value=BANK_TRANSFER _v-52ff1b12="">银行转账</option> <option value=ALIPAY_TRANSFER _v-52ff1b12="">支付宝转账</option> </select> </div> </div> <div class=form-group _v-52ff1b12=""> <label class="col-lg-4 control-label" for=paymentAmount _v-52ff1b12="">付款金额<span class=text-danger _v-52ff1b12="">*</span>：</label> <div class=col-lg-6 _v-52ff1b12=""> <input class="form-control input-sm" id=paymentAmount type=text v-model="data.paymentAmount | priceFilter" _v-52ff1b12=""> </div> </div> <div class=form-group _v-52ff1b12=""> <label class="col-lg-4 control-label" for=paymentOrderId _v-52ff1b12="">支付单号：</label> <div class=col-lg-6 _v-52ff1b12=""> <input class="form-control input-sm" id=paymentOrderId type=text v-model=data.paymentOrderId _v-52ff1b12=""> </div> </div> </form> </div> <div class=modal-footer _v-52ff1b12=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-52ff1b12="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-52ff1b12=""></popup-tips> </div> '},198:function(e,t){e.exports=' <div class=container-fluid _v-263b0aa3=""> <ul class=breadcrumb _v-263b0aa3=""> <li _v-263b0aa3="">财务系统</li> <li _v-263b0aa3="">收款管理</li> </ul> <ul class="nav nav-pills" _v-263b0aa3=""> <li :class="{\'active\': type === \'WAITING\'}" v-if=permissionList.view _v-263b0aa3=""><a @click="getList(\'WAITING\')" _v-263b0aa3="">待付款录入</a></li> <li :class="{\'active\': type === \'ALL\'}" v-if=permissionList.view _v-263b0aa3=""><a @click="getList(\'ALL\')" _v-263b0aa3="">全部</a></li> </ul> <p class=clearfix _v-263b0aa3=""></p> <form class=form-inline style=margin-bottom:10px v-if=permissionList.view _v-263b0aa3=""> <label class=control-label for=fitlerType _v-263b0aa3="">筛选：</label> <select class="form-control input-sm" id=fitlerType style=width:80px v-model=filterType _v-263b0aa3=""> <option value=customer _v-263b0aa3="">客户信息</option> </select> <input v-if="filterType === \'customer\'" class="form-control input-sm" style=width:120px;margin-left:20px type=text placeholder=请输入客户信息 v-model=customerKeyword _v-263b0aa3=""> <a class="btn btn-info btn-sm" style="margin-left:30px;padding:6px 20px" @click="getList(type, \'\', getFilterParams())" _v-263b0aa3="">查询</a> </form> <h5 v-show=filterParams.customer _v-263b0aa3="">{{getQueryDesc()}}</h5> <table class="table order-thead-table" _v-263b0aa3=""> <thead _v-263b0aa3=""> <tr style=height:45px;background-color:#eee _v-263b0aa3=""> <th style=width:8% _v-263b0aa3="">序号</th> <th style=width:20% _v-263b0aa3="">订单日期</th> <th style=width:20% _v-263b0aa3="">订单编号</th> <th style=width:40% _v-263b0aa3="">客户名称/公司</th> <th style=width:12% _v-263b0aa3="">订单金额</th> </tr> </thead> </table> <template v-for="orderItem in orderList" _v-263b0aa3=""> <table class="table table-bordered table-hover order-table" style=margin-bottom:0px _v-263b0aa3=""> <tbody _v-263b0aa3=""> <tr style=height:45px _v-263b0aa3=""> <td style=width:8% _v-263b0aa3="">{{$index + 1}}</td> <td style=width:20% _v-263b0aa3="">{{orderItem.time | dateFormat \'toDate\'}}</td> <td style=width:20% _v-263b0aa3=""><a class=btn-link v-link="{path:\'/order/detail/\'+orderItem.id}" target=_blank _v-263b0aa3="">{{orderItem.id}}</a></td> <td style=width:40% _v-263b0aa3="">{{orderItem.customer.name + (orderItem.customer.company ? \'/\' + orderItem.customer.company : \'\')}}</td> <td style=width:12% _v-263b0aa3="">{{orderItem.amount + orderItem.freight | realPrice}}元</td> </tr> </tbody> </table> <table class="table table-bordered table-hover receivables-table" _v-263b0aa3=""> <thead _v-263b0aa3=""> <tr style=background-color:#eee _v-263b0aa3=""> <th style=width:5% _v-263b0aa3="">序号</th> <th style=width:14% _v-263b0aa3="">付款时间</th> <th style=width:8% _v-263b0aa3="">付款途径</th> <th style=width:10% _v-263b0aa3="">付款方式</th> <th style=width:21% _v-263b0aa3="">支付单号</th> <th style=width:10% _v-263b0aa3="">付款金额</th> <th style=width:8% _v-263b0aa3="">付款比例</th> <th style=width:14% _v-263b0aa3="">付款备注</th> <th style=width:10% _v-263b0aa3="">操作</th> </tr> </thead> <tbody _v-263b0aa3=""> <tr v-if="orderItem.records.length === 0" _v-263b0aa3=""> <td colspan=7 _v-263b0aa3="">尚无付款记录</td> <td _v-263b0aa3="">{{orderItem.payment_remark}}</td> <td _v-263b0aa3=""> <a class="btn btn-info btn-sm" @click=clickToShowReceivablesRecordDialog(orderItem) v-if=permissionList.recordReceivables _v-263b0aa3="">收款录入</a> </td> </tr> <template v-else="" _v-263b0aa3=""> <tr v-for="item of orderItem.records" _v-263b0aa3=""> <td _v-263b0aa3="">{{$index + 1}}</td> <td _v-263b0aa3="">{{item.create_time | dateFormat}}</td> <td _v-263b0aa3="">{{item.method === \'PINGXX\' ? \'线上支付\' : \'线下转账\'}}</td> <td _v-263b0aa3="">{{item.method === \'PINGXX\' ? \'Ping++支付\' : (item.method === \'BANK_TRANSFER\' ? \'银行转账\' : \'支付宝转账\')}}</td> <td _v-263b0aa3="">{{item.payment_order_id}}</td> <td _v-263b0aa3="">{{item.amount | realPrice}}元</td> <td _v-263b0aa3="">{{Math.round(item.amount / (orderItem.amount + orderItem.freight) * 100)}}%</td> <td v-if="$index === 0" :rowspan=orderItem.records.length _v-263b0aa3="">{{orderItem.payment_remark}}</td> <td v-if="$index === 0" :rowspan=orderItem.records.length _v-263b0aa3=""> <template v-if="orderItem.status === \'DELIVERY_PAID\' || orderItem.status === \'ONLINE_PAID\' || orderItem.status === \'ONLINE_CONFIRMED\' || orderItem.status === \'FINISHED\'" _v-263b0aa3=""> 付款成功 </template> <template v-else="" _v-263b0aa3=""> <a class="btn btn-info btn-sm" @click=clickToShowReceivablesRecordDialog(orderItem) v-if=permissionList.recordReceivables _v-263b0aa3="">收款录入</a> </template> </td> </tr> </template> </tbody> </table> </template> <a class="btn btn-primary" v-if=sinceId @click="getList(type, sinceId, filterParams)" _v-263b0aa3="">查看更多</a> <record-receivables-dialog :show.sync=dataForRecordReceivablesDialog.show :data=dataForRecordReceivablesDialog.data _v-263b0aa3=""></record-receivables-dialog> </div> ';
}});
//# sourceMappingURL=9.js.map