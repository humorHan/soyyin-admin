webpackJsonp([11],{70:function(t,e,s){var a,n;s(71),a=s(73),n=s(74),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default),n&&(("function"==typeof t.exports?t.exports.options:t.exports).template=n)},71:function(t,e,s){var a=s(72);"string"==typeof a&&(a=[[t.id,a,""]]);s(40)(a,{});a.locals&&(t.exports=a.locals)},72:function(t,e,s){e=t.exports=s(39)(),e.push([t.id,".modal[_v-93eabb2e]{height:100%}.modal-dialog[_v-93eabb2e]{top:30%}","",{version:3,sources:["/./src/components/popupDialog.vue.style"],names:[],mappings:"AAwDA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"popupDialog.vue",sourcesContent:['<!-- popupDialog.vue -->\n<template>\n    <div class="modal" v-show="showDialog">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">{{ dialogTitle }}</h4>\n                </div>\n                <div class="modal-body">\n                    <p>{{ dialogContent }}</p>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" @click="clickNegativeButton">{{ negativeButtonText }}</button>\n        \t\t\t<button type="button" class="btn btn-primary" @click="clickPositiveButton">{{ positiveButtonText }}</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n\nexport default {\n    name: \'PopupDialogView\',\n    props: {\n    \tshowDialog: Boolean,\n    \tdialogTitle: String,\n    \tdialogContent: String,\n    \tnegativeButtonText: {\n    \t\ttype: String,\n    \t\tdefault: \'取消\'\n    \t},\n    \tpositiveButtonText: {\n    \t\ttype: String,\n    \t\tdefault: \'确定\'\n    \t},\n    },\n    methods: {\n    \tcloseDialog(event) {\n    \t\tthis.showDialog = false;\n    \t},\n    \tclickPositiveButton(event) {\n    \t\tthis.showDialog = false;\n    \t\tthis.$dispatch(\'click-positive-button\');\n    \t},\n    \tclickNegativeButton(event) {\n    \t\tthis.showDialog = false;\n    \t\tthis.$dispatch(\'click-negative-button\');\n    \t},\n    },\n}\n\n</script>\n\n<style scoped>\n.modal {\n\theight: 100%;\n}\n\n.modal-dialog {\n\ttop: 30%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},73:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"PopupDialogView",props:{showDialog:Boolean,dialogTitle:String,dialogContent:String,negativeButtonText:{type:String,default:"取消"},positiveButtonText:{type:String,default:"确定"}},methods:{closeDialog:function(t){this.showDialog=!1},clickPositiveButton:function(t){this.showDialog=!1,this.$dispatch("click-positive-button")},clickNegativeButton:function(t){this.showDialog=!1,this.$dispatch("click-negative-button")}}}},74:function(t,e){t.exports=' <div class=modal v-show=showDialog _v-93eabb2e=""> <div class=modal-dialog _v-93eabb2e=""> <div class=modal-content _v-93eabb2e=""> <div class=modal-header _v-93eabb2e=""> <button type=button class=close @click=closeDialog _v-93eabb2e="">×</button> <h4 class=modal-title _v-93eabb2e="">{{ dialogTitle }}</h4> </div> <div class=modal-body _v-93eabb2e=""> <p _v-93eabb2e="">{{ dialogContent }}</p> </div> <div class=modal-footer _v-93eabb2e=""> <button type=button class="btn btn-default" @click=clickNegativeButton _v-93eabb2e="">{{ negativeButtonText }}</button> <button type=button class="btn btn-primary" @click=clickPositiveButton _v-93eabb2e="">{{ positiveButtonText }}</button> </div> </div> </div> </div> '},80:function(t,e,s){var a,n;s(81),a=s(83),n=s(84),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default),n&&(("function"==typeof t.exports?t.exports.options:t.exports).template=n)},81:function(t,e,s){var a=s(82);"string"==typeof a&&(a=[[t.id,a,""]]);s(40)(a,{});a.locals&&(t.exports=a.locals)},82:function(t,e,s){e=t.exports=s(39)(),e.push([t.id,".popuptips-container[_v-d1dee2ce]{position:fixed;left:50%;top:40%;z-index:2000}.panel[_v-d1dee2ce]{position:relative;left:-50%}.fade-transition[_v-d1dee2ce]{-webkit-transition:all 1s ease;transition:all 1s ease}.fade-leave[_v-d1dee2ce]{opacity:0}","",{version:3,sources:["/./src/components/popupTips.vue.style"],names:[],mappings:"AAuCA,kCACA,eAAA,AACA,SAAA,AACA,QAAA,AACA,YAAA,CACA,AACA,oBACA,kBAAA,AACA,SAAA,CACA,AAEA,8BACA,+BAAA,sBAAA,CACA,AAEA,yBACA,SAAA,CACA",file:"popupTips.vue",sourcesContent:['<!-- popupTips.vue -->\n<template>\n\t<div class="popuptips-container" v-if="show" transition="fade">\n\t    <div class="panel panel-{{ tipsType }}">\n\t\t\t<div class="panel-heading">\n\t\t   \t\t<h3 class="panel-title">{{ tipsTitle }}</h3>\n\t\t\t</div>\n\t\t\t<div class="panel-body">\n\t\t    \t{{ tipsContent }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n    name: \'PopupTipsView\',\n    replace: false,\n    props: {\n    \tshow: Boolean,\n    \ttipsType: String,\n    \ttipsTitle: String,\n    \ttipsContent: String\n    },\n    watch: {\n        show(val, oldVal) {\n            if (val === true) {\n            \tsetTimeout(() => {\n            \t\tthis.show = false;\n            \t}, 1000);\n            }\n        },\n    },\n}\n\n</script>\n\n<style scoped>\n.popuptips-container {\n\tposition: fixed;\n\tleft: 50%;\n\ttop: 40%;\n    z-index: 2000;\n}\n.panel {\n\tposition: relative;\n    left: -50%;\n}\n\n.fade-transition {\n  transition: all 1s ease;\n}\n\n.fade-leave {\n  opacity: 0;\n}\n</style>'],sourceRoot:"webpack://"}])},83:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"PopupTipsView",replace:!1,props:{show:Boolean,tipsType:String,tipsTitle:String,tipsContent:String},watch:{show:function(t,e){var s=this;t===!0&&setTimeout(function(){s.show=!1},1e3)}}}},84:function(t,e){t.exports=' <div class=popuptips-container v-if=show transition=fade _v-d1dee2ce=""> <div class="panel panel-{{ tipsType }}" _v-d1dee2ce=""> <div class=panel-heading _v-d1dee2ce=""> <h3 class=panel-title _v-d1dee2ce="">{{ tipsTitle }}</h3> </div> <div class=panel-body _v-d1dee2ce=""> {{ tipsContent }} </div> </div> </div> '},85:function(t,e){"use strict";function s(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="产品名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="产品名称不能为空",e)}function a(t){var e={};return e.ok=!1,t?t.length>12?(e.errorMsg="产品数量长度不能大于12",e):(e.ok=!0,e):(e.errorMsg="产品数量不能为空",e)}function n(t){var e={};return e.ok=!1,!t||t<0?(e.errorMsg="产品价格不能为空且必须为正数",e):(e.ok=!0,e)}function o(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="客户名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="客户名称不能为空",e)}function r(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="收货人名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="收货人名称不能为空",e)}function i(t){var e={};e.ok=!1;var s=/^[0-9]{11}$/;return t?s.test(t)?(e.ok=!0,e):(e.errorMsg="收货人手机格式有误",e):(e.errorMsg="收货人手机不能为空",e)}function d(t,e){var s={};return s.ok=!1,0===t?(s.errorMsg="请选择收货人所在地省市区",s):e?e.length>50?(s.errorMsg="收货人详细地址不能大于50",s):(s.ok=!0,s):(s.errorMsg="收货人详细地址不能为空",s)}function l(t){var e={};return e.ok=!1,!t||t<0?(e.errorMsg="开票金额不能为空且必须为正数",e):(e.ok=!0,e)}function p(t,e){var s={};return s.ok=!1,e?e.length>50?(s.errorMsg=t+"长度不能大于50",s):(s.ok=!0,s):(s.errorMsg=t+"不能为空",s)}function c(t,e){var s={};return s.ok=!1,void 0===t||null===t||""===t?(s.errorMsg="使用额度不能为空",s):t<=0||t>e?(s.errorMsg="使用额度必须为正数且不能超过"+e/100+"元",s):(s.ok=!0,s)}function u(t,e){var s={};return s.ok=!1,void 0===t||null===t||""===t?(s.errorMsg="补充金额不能为空",s):t<=e?(s.errorMsg="补充金额必须大于"+e/100+"元",s):(s.ok=!0,s)}function v(t){var e={};return e.ok=!1,void 0===t||null===t||""===t?(e.errorMsg="额外成本不能为空",e):t<0?(e.errorMsg="额外成本必须大于等于0",e):(e.ok=!0,e)}function h(t,e){var s={};return s.ok=!1,e?e.length>2e3?(s.errorMsg=t+"长度不能大于2000",s):(s.ok=!0,s):(s.errorMsg=t+"不能为空",s)}function m(t,e){var s={};return s.ok=!1,t?t<0?(s.errorMsg="成本必须大于0",s):(s.ok=!0,s):e?(s.ok=!0,s):(s.errorMsg="成本不能为空或者0",s)}function g(t){var e={};return e.ok=!1,void 0===t||null===t||""===t?(e.errorMsg="物流成本不能为空",e):t<0?(e.errorMsg="物流成本必须大于等于0",e):(e.ok=!0,e)}function b(t,e){var s={};return s.ok=!1,e?e.length>2e3?(s.errorMsg=t+"长度不能大于2000",s):(s.ok=!0,s):(s.errorMsg=t+"不能为空",s)}function f(t,e){var s={};return s.ok=!1,!t||t<0?(s.errorMsg="退款金额不能为空且必须为正数",s):t>e?(s.errorMsg="退款金额不能大于"+e/100+"元",s):(s.ok=!0,s)}function A(t){var e={};return e.ok=!1,t?t.length>50?(e.errorMsg="对方账号长度不能大于50",e):(e.ok=!0,e):(e.errorMsg="对方账号不能为空",e)}function y(t){var e={};return e.ok=!1,t?t.length>2e3?(e.errorMsg="退款原因长度不能大于2000",e):(e.ok=!0,e):(e.errorMsg="退款原因不能为空",e)}function _(t,e){var s={};return s.ok=!1,!t||t<0?(s.errorMsg="付款金额不能为空且必须为正数",s):t>e?(s.errorMsg="付款金额不能大于该订单剩余的待支付金额("+e/100+"元)",s):(s.ok=!0,s)}function D(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="供应商名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="供应商名称不能为空",e)}function w(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="真实姓名长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="真实姓名不能为空",e)}function k(t){var e={};return e.ok=!1,t?t.length>50?(e.errorMsg="用户名长度不能大于50",e):(e.ok=!0,e):(e.errorMsg="用户名不能为空",e)}function U(t){var e={};e.ok=!1;var s=/^[a-zA-Z0-9]*$/;return t?t.length>20?(e.errorMsg="密码长度不能超过20",e):s.test(t)?(e.ok=!0,e):(e.errorMsg="密码只能包含英文字母和数字",e):(e.errorMsg="密码不能为空",e)}Object.defineProperty(e,"__esModule",{value:!0});var E="******";e.orderValidator={validateProductName:s,validateProductQuantity:a,validateProductPrice:n,validateCustomerName:o,validateConsigneeName:r,validateConsigneePhone:i,validateConsigneeAddress:d,validateInvoiceAmount:l,validateInvoiceItem:p,validateApplyInvoiceAmount:c,validateExtraAmount:u,validateExtraCost:v,validateAfterSaleItem:h,validateProductCost:m,validateLogisticsCost:g,validateLogisticsItem:b,validateRefundAmount:f,validateRefundAccount:A,validateRefundReason:y},e.financeValidator={validatePaymentAmount:_},e.crmValidator={validateSupplierName:D,validateDisplayName:w,validateUserName:k,validatePassword:U,DEFAULT_PASSWORD:E}},204:function(t,e,s){var a,n;s(205),a=s(207),n=s(213),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default),n&&(("function"==typeof t.exports?t.exports.options:t.exports).template=n)},205:function(t,e,s){var a=s(206);"string"==typeof a&&(a=[[t.id,a,""]]);s(40)(a,{});a.locals&&(t.exports=a.locals)},206:function(t,e,s){e=t.exports=s(39)(),e.push([t.id,",.user-table[_v-7edee250]{table-layout:fixed}.user-table td[_v-7edee250],.user-table th[_v-7edee250]{text-align:center;vertical-align:middle}.user-table td .btn-link[_v-7edee250]{text-decoration:none;cursor:pointer}.user-table td .btn-link[_v-7edee250]:hover{text-decoration:underline}","",{version:3,sources:["/./src/views/crm/users.vue.style"],names:[],mappings:"AA4LA,0BACA,kBAAA,CACA,AAEA,wDACA,kBAAA,AACA,qBAAA,CACA,AAEA,sCACA,qBAAA,AACA,cAAA,CACA,AAEA,4CACA,yBAAA,CACA",file:"users.vue",sourcesContent:['<!-- users.vue -->\n<template>\n    <div class="container-fluid">\n        <ul class="breadcrumb">\n            <li>CRM系统</li>\n            <li>成员管理</li>\n        </ul>\n        <a class="pull-right btn btn-info btn-sm" v-if="permissionList.addUser" @click="addUser">添加成员</a>\n        <p class="clearfix"></p>\n        <table class="table table-bordered table-hover user-table">\n            <thead>\n                <tr>\n                    <th style="width:5%;">ID</th>\n                    <th style="width:12%;">真实姓名</th>\n                    <th style="width:23%;">用户名</th>\n                    <th style="width:25%;">角色</th>\n                    <th style="width:20%;">手机号</th>\n                    <th style="width:15%;">操作</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr v-for="userItem of userList">\n                    <td>{{userItem.id}}</td>\n                    <td>{{userItem.display_name}}</td>\n                    <td>{{userItem.username}}</td>\n                    <td>{{userItem.roles | rolesFilter}}</td>\n                    <td>{{userItem.phone}}</td>\n                    <td>\n                        <a class="btn-link" v-if="permissionList.editUser" @click="editUser(userItem)">编辑</a>\n                        <a class="btn-link" style="margin-left:20px;" v-if="permissionList.deleteUser" @click="showDeleteUserDialog(userItem)">删除</a>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n        <edit-or-add-user-dialog :show.sync="dataForEditOrAddUserDialog.show" :data="dataForEditOrAddUserDialog.data" :roles="roleList"></edit-or-add-user-dialog>\n        <popup-dialog :show-dialog.sync="dataForPopupDialog.show" :dialog-title="dataForPopupDialog.title" :dialog-content="dataForPopupDialog.content"></popup-dialog>\n    </div>\n</template>\n\n<script>\nimport popupDialog from \'../../components/popupDialog.vue\'\nimport editOrAddUserDialog from \'./comp/editOrAddUserDialog.vue\'\nimport { callback } from \'../../store/index.js\'\nimport { permissionValidator } from \'../../store/rolePermission.js\'\nimport { crmValidator } from \'../../store/dataValidator.js\'\n\nconst DELETE_USER = "DELETE_USER";\n\nexport default {\n    name: \'CrmUsersView\',\n    components: {\n        popupDialog,\n        editOrAddUserDialog,\n    },\n    data() {\n        return {\n            roleList: [],\n            userList: [],\n            permissionList: {\n                view: permissionValidator.crmSystem.member.view(),\n                addUser: permissionValidator.crmSystem.member.addMember(),\n                deleteUser: permissionValidator.crmSystem.member.deleteMember(),\n                editUser: permissionValidator.crmSystem.member.editMember(),\n            },\n            dataForEditOrAddUserDialog: {\n                show: false,\n                data: {\n                    userId: \'\',\n                    displayName: \'\',\n                    username: \'\',\n                    roleIds: \'\',\n                    password: \'\',\n                    phone: \'\',\n                },\n            },\n            dataForPopupDialog: {\n                show: false,\n                title: \'删除确认\',\n                content: \'\',\n            },\n        }\n    },\n    filters: {\n        rolesFilter(roles) {\n            var result = \'\';\n            for (let i = 0; i < roles.length; i++) {\n                if (i === 0) {\n                    result += roles[i].name;\n                } else {\n                    result += \'、\' + roles[i].name;\n                }\n            }\n            return result;\n        },\n    },\n    ready() {\n        if (this.permissionList.view) {\n            this.getUsers();\n        }\n        if (this.permissionList.addUser || this.permissionList.editUser) {\n            this.getRoles();\n        }\n    },\n    events: {\n        \'click-positive-button\'() {\n            if (this.dataForPopupDialog.dialogId === DELETE_USER) {\n                this.deleteUser(this.dataForPopupDialog.passingData);\n            }\n        },\n        \'add-user\'() {\n            location.reload();\n        },\n        \'edit-user\'() {\n            location.reload();\n        },\n    },\n    methods: {\n        getRoles() {\n            var url = \'/api/v2/admin/permissions/role-list\';\n            this.$http.get(url)\n            .then((response) => {\n                if (!response.data.result || response.data.result === 0) {\n                    this.roleList = response.data.data;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        getUsers() {\n            var url = \'/api/v2/admin/users/all\';\n            this.$http.get(url)\n            .then((response) => {\n                if (!response.data.result || response.data.result === 0) {\n                    this.userList = response.data.data;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        addUser() {\n            this.dataForEditOrAddUserDialog.show = true;\n            this.dataForEditOrAddUserDialog.data.userId = \'\';\n            this.dataForEditOrAddUserDialog.data.displayName = \'\';\n            this.dataForEditOrAddUserDialog.data.username = \'\';\n            this.dataForEditOrAddUserDialog.data.roleIds = [];\n            this.dataForEditOrAddUserDialog.data.password = \'\';\n            this.dataForEditOrAddUserDialog.data.phone = \'\';\n        },\n        editUser(userItem) {\n            this.dataForEditOrAddUserDialog.show = true;\n            this.dataForEditOrAddUserDialog.data.userId = userItem.id;\n            this.dataForEditOrAddUserDialog.data.displayName = userItem.display_name;\n            this.dataForEditOrAddUserDialog.data.username = userItem.username;\n            this.dataForEditOrAddUserDialog.data.roleIds = [];\n            for (let i = 0; i < userItem.roles.length; i++) {\n                this.dataForEditOrAddUserDialog.data.roleIds.push(userItem.roles[i].id);\n            }\n            this.dataForEditOrAddUserDialog.data.password = crmValidator.DEFAULT_PASSWORD;\n            this.dataForEditOrAddUserDialog.data.phone = userItem.phone;\n        },\n        showDeleteUserDialog(userItem) {\n            this.dataForPopupDialog.show = true;\n            this.dataForPopupDialog.content = "确定删除此成员？";\n            this.dataForPopupDialog.dialogId = DELETE_USER;\n            this.dataForPopupDialog.passingData = userItem;\n        },\n        deleteUser(userItem) {\n            var url = \'/api/v2/admin/users/delete?id=\' + userItem.id;\n            this.$http.delete(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    location.reload();\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n    }\n}\n</script>\n\n<style scoped>\n.user-table, {\n    table-layout: fixed;\n}\n\n.user-table td, .user-table th {\n    text-align: center;\n    vertical-align: middle;\n}\n\n.user-table td .btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.user-table td .btn-link:hover {\n    text-decoration: underline;\n}\n</style>'],sourceRoot:"webpack://"}])},207:function(t,e,s){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=s(70),o=a(n),r=s(208),i=a(r),d=s(46),l=s(43),p=s(85),c="DELETE_USER";e.default={name:"CrmUsersView",components:{popupDialog:o.default,editOrAddUserDialog:i.default},data:function(){return{roleList:[],userList:[],permissionList:{view:l.permissionValidator.crmSystem.member.view(),addUser:l.permissionValidator.crmSystem.member.addMember(),deleteUser:l.permissionValidator.crmSystem.member.deleteMember(),editUser:l.permissionValidator.crmSystem.member.editMember()},dataForEditOrAddUserDialog:{show:!1,data:{userId:"",displayName:"",username:"",roleIds:"",password:"",phone:""}},dataForPopupDialog:{show:!1,title:"删除确认",content:""}}},filters:{rolesFilter:function(t){for(var e="",s=0;s<t.length;s++)e+=0===s?t[s].name:"、"+t[s].name;return e}},ready:function(){this.permissionList.view&&this.getUsers(),(this.permissionList.addUser||this.permissionList.editUser)&&this.getRoles()},events:{"click-positive-button":function(){this.dataForPopupDialog.dialogId===c&&this.deleteUser(this.dataForPopupDialog.passingData)},"add-user":function(){location.reload()},"edit-user":function(){location.reload()}},methods:{getRoles:function(){var t=this,e="/api/v2/admin/permissions/role-list";this.$http.get(e).then(function(e){e.data.result&&0!==e.data.result?d.callback.success(e.data):t.roleList=e.data.data},function(t){d.callback.error(t)})},getUsers:function(){var t=this,e="/api/v2/admin/users/all";this.$http.get(e).then(function(e){e.data.result&&0!==e.data.result?d.callback.success(e.data):t.userList=e.data.data},function(t){d.callback.error(t)})},addUser:function(){this.dataForEditOrAddUserDialog.show=!0,this.dataForEditOrAddUserDialog.data.userId="",this.dataForEditOrAddUserDialog.data.displayName="",this.dataForEditOrAddUserDialog.data.username="",this.dataForEditOrAddUserDialog.data.roleIds=[],this.dataForEditOrAddUserDialog.data.password="",this.dataForEditOrAddUserDialog.data.phone=""},editUser:function(t){this.dataForEditOrAddUserDialog.show=!0,this.dataForEditOrAddUserDialog.data.userId=t.id,this.dataForEditOrAddUserDialog.data.displayName=t.display_name,this.dataForEditOrAddUserDialog.data.username=t.username,this.dataForEditOrAddUserDialog.data.roleIds=[];for(var e=0;e<t.roles.length;e++)this.dataForEditOrAddUserDialog.data.roleIds.push(t.roles[e].id);this.dataForEditOrAddUserDialog.data.password=p.crmValidator.DEFAULT_PASSWORD,this.dataForEditOrAddUserDialog.data.phone=t.phone},showDeleteUserDialog:function(t){this.dataForPopupDialog.show=!0,this.dataForPopupDialog.content="确定删除此成员？",this.dataForPopupDialog.dialogId=c,this.dataForPopupDialog.passingData=t},deleteUser:function(t){var e="/api/v2/admin/users/delete?id="+t.id;this.$http.delete(e).then(function(t){t.data.result&&0!==t.data.result?d.callback.success(t.data):location.reload()},function(t){d.callback.error(t)})}}}},208:function(t,e,s){var a,n;s(209),a=s(211),n=s(212),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default),n&&(("function"==typeof t.exports?t.exports.options:t.exports).template=n)},209:function(t,e,s){var a=s(210);"string"==typeof a&&(a=[[t.id,a,""]]);s(40)(a,{});a.locals&&(t.exports=a.locals)},210:function(t,e,s){e=t.exports=s(39)(),e.push([t.id,".modal[_v-147c76c7]{height:100%}.modal-dialog[_v-147c76c7]{top:20%}","",{version:3,sources:["/./src/views/crm/comp/editOrAddUserDialog.vue.style"],names:[],mappings:"AA4LA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"editOrAddUserDialog.vue",sourcesContent:['<!-- editOrAddUserDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n    \t<div class="modal-dialog">\n            <div class="modal-content">\n            \t<div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">{{title}}</h4>\n                </div>\n                <div class="modal-body">\n                    <form class="form-horizontal">\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="userDisplayName">真实姓名<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="userDisplayName" type="text" v-model="data.displayName">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="username">用户名<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="username" type="text" v-model="data.username">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="userRole">角色<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-7 checkbox">\n                                <label style="padding-right: 20px;" v-for="role in roles">\n                                    <input type="checkbox" value="{{role.id}}" v-model="data.roleIds" number>{{role.name}}\n                                </label>\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="userPassword">密码<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="userPassword" type="password" v-model="data.password">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="userPhone">手机号码：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="userPhone" type="text" v-model="data.phone">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { crmValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'EditOrAddUserDialogView\',\n    components: {\n        popupTips,\n    },\n    props: [\'show\', \'data\', \'roles\'],\n    data() {\n        return {\n        \tbuttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    computed: {\n        title() {\n            if (this.data.userId) {\n                return \'编辑成员\';\n            } else {\n                return \'新增成员\';\n            }\n        },\n    },\n    methods: {\n    \tvalidateUser() {\n            var result = crmValidator.validateDisplayName(this.data.displayName);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            result = crmValidator.validateUserName(this.data.username);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            if (this.data.roleIds.length === 0) {\n                return "请选择成员角色";\n            }\n            if (this.data.password != crmValidator.DEFAULT_PASSWORD) {\n                result = crmValidator.validatePassword(this.data.password);\n                if (!result.ok) {\n                    return result.errorMsg;\n                }\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                if (this.data.userId) {\n                    this.editUser();\n                } else {\n                    this.addUser();\n                }\n            }\n        },\n        addUser() {\n        \tvar result = this.validateUser();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var url = \'/api/v2/admin/users/add\';\n            var data = {\n                username: this.data.username,\n                password: this.data.password,\n                display_name: this.data.displayName,\n                phone: this.data.phone,\n                role_ids: this.data.roleIds,\n            };\n            this.$http.post(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.show = false;\n                    this.$dispatch(\'add-user\');\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \teditUser() {\n            var result = this.validateUser();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var url = \'/api/v2/admin/users/update?id=\' + this.data.userId;\n            var data = {\n                username: this.data.username,\n                display_name: this.data.displayName,\n                phone: this.data.phone,\n                role_ids: this.data.roleIds,\n            };\n            if (this.data.password != crmValidator.DEFAULT_PASSWORD) {\n                data.password = this.data.password;\n            }\n            this.$http.put(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.show = false;\n                    this.$dispatch(\'edit-user\');\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \tcloseDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 20%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},211:function(t,e,s){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=s(80),o=a(n),r=s(46),i=s(85);e.default={name:"EditOrAddUserDialogView",components:{popupTips:o.default},props:["show","data","roles"],data:function(){return{buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},computed:{title:function(){return this.data.userId?"编辑成员":"新增成员"}},methods:{validateUser:function(){var t=i.crmValidator.validateDisplayName(this.data.displayName);return t.ok?(t=i.crmValidator.validateUserName(this.data.username),t.ok?0===this.data.roleIds.length?"请选择成员角色":this.data.password==i.crmValidator.DEFAULT_PASSWORD||(t=i.crmValidator.validatePassword(this.data.password),t.ok)?void 0:t.errorMsg:t.errorMsg):t.errorMsg},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.data.userId?this.editUser():this.addUser())},addUser:function(){var t=this,e=this.validateUser();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=e,void(this.buttonEnabled=!0);var s="/api/v2/admin/users/add",a={username:this.data.username,password:this.data.password,display_name:this.data.displayName,phone:this.data.phone,role_ids:this.data.roleIds};this.$http.post(s,a).then(function(e){e.data.result&&0!==e.data.result?r.callback.success(e.data):(t.show=!1,t.$dispatch("add-user")),t.buttonEnabled=!0},function(e){r.callback.error(e),t.buttonEnabled=!0})},editUser:function(){var t=this,e=this.validateUser();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=e,void(this.buttonEnabled=!0);var s="/api/v2/admin/users/update?id="+this.data.userId,a={username:this.data.username,display_name:this.data.displayName,phone:this.data.phone,role_ids:this.data.roleIds};this.data.password!=i.crmValidator.DEFAULT_PASSWORD&&(a.password=this.data.password),this.$http.put(s,a).then(function(e){e.data.result&&0!==e.data.result?r.callback.success(e.data):(t.show=!1,t.$dispatch("edit-user")),t.buttonEnabled=!0},function(e){r.callback.error(e),
t.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},212:function(t,e){t.exports=' <div class=modal v-show=show _v-147c76c7=""> <div class=modal-dialog _v-147c76c7=""> <div class=modal-content _v-147c76c7=""> <div class=modal-header _v-147c76c7=""> <button type=button class=close @click=closeDialog _v-147c76c7="">×</button> <h4 class=modal-title _v-147c76c7="">{{title}}</h4> </div> <div class=modal-body _v-147c76c7=""> <form class=form-horizontal _v-147c76c7=""> <div class=form-group _v-147c76c7=""> <label class="col-lg-4 control-label" for=userDisplayName _v-147c76c7="">真实姓名<span class=text-danger _v-147c76c7="">*</span>：</label> <div class=col-lg-6 _v-147c76c7=""> <input class="form-control input-sm" id=userDisplayName type=text v-model=data.displayName _v-147c76c7=""> </div> </div> <div class=form-group _v-147c76c7=""> <label class="col-lg-4 control-label" for=username _v-147c76c7="">用户名<span class=text-danger _v-147c76c7="">*</span>：</label> <div class=col-lg-6 _v-147c76c7=""> <input class="form-control input-sm" id=username type=text v-model=data.username _v-147c76c7=""> </div> </div> <div class=form-group _v-147c76c7=""> <label class="col-lg-4 control-label" for=userRole _v-147c76c7="">角色<span class=text-danger _v-147c76c7="">*</span>：</label> <div class="col-lg-7 checkbox" _v-147c76c7=""> <label style="padding-right: 20px" v-for="role in roles" _v-147c76c7=""> <input type=checkbox value={{role.id}} v-model=data.roleIds number="" _v-147c76c7="">{{role.name}} </label> </div> </div> <div class=form-group _v-147c76c7=""> <label class="col-lg-4 control-label" for=userPassword _v-147c76c7="">密码<span class=text-danger _v-147c76c7="">*</span>：</label> <div class=col-lg-6 _v-147c76c7=""> <input class="form-control input-sm" id=userPassword type=password v-model=data.password _v-147c76c7=""> </div> </div> <div class=form-group _v-147c76c7=""> <label class="col-lg-4 control-label" for=userPhone _v-147c76c7="">手机号码：</label> <div class=col-lg-6 _v-147c76c7=""> <input class="form-control input-sm" id=userPhone type=text v-model=data.phone _v-147c76c7=""> </div> </div> </form> </div> <div class=modal-footer _v-147c76c7=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-147c76c7="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-147c76c7=""></popup-tips> </div> '},213:function(t,e){t.exports=' <div class=container-fluid _v-7edee250=""> <ul class=breadcrumb _v-7edee250=""> <li _v-7edee250="">CRM系统</li> <li _v-7edee250="">成员管理</li> </ul> <a class="pull-right btn btn-info btn-sm" v-if=permissionList.addUser @click=addUser _v-7edee250="">添加成员</a> <p class=clearfix _v-7edee250=""></p> <table class="table table-bordered table-hover user-table" _v-7edee250=""> <thead _v-7edee250=""> <tr _v-7edee250=""> <th style=width:5% _v-7edee250="">ID</th> <th style=width:12% _v-7edee250="">真实姓名</th> <th style=width:23% _v-7edee250="">用户名</th> <th style=width:25% _v-7edee250="">角色</th> <th style=width:20% _v-7edee250="">手机号</th> <th style=width:15% _v-7edee250="">操作</th> </tr> </thead> <tbody _v-7edee250=""> <tr v-for="userItem of userList" _v-7edee250=""> <td _v-7edee250="">{{userItem.id}}</td> <td _v-7edee250="">{{userItem.display_name}}</td> <td _v-7edee250="">{{userItem.username}}</td> <td _v-7edee250="">{{userItem.roles | rolesFilter}}</td> <td _v-7edee250="">{{userItem.phone}}</td> <td _v-7edee250=""> <a class=btn-link v-if=permissionList.editUser @click=editUser(userItem) _v-7edee250="">编辑</a> <a class=btn-link style=margin-left:20px v-if=permissionList.deleteUser @click=showDeleteUserDialog(userItem) _v-7edee250="">删除</a> </td> </tr> </tbody> </table> <edit-or-add-user-dialog :show.sync=dataForEditOrAddUserDialog.show :data=dataForEditOrAddUserDialog.data :roles=roleList _v-7edee250=""></edit-or-add-user-dialog> <popup-dialog :show-dialog.sync=dataForPopupDialog.show :dialog-title=dataForPopupDialog.title :dialog-content=dataForPopupDialog.content _v-7edee250=""></popup-dialog> </div> '}});
//# sourceMappingURL=11.js.map