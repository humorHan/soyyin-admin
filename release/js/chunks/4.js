webpackJsonp([4],[,,,,,function(t,e,n){(function(e,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   3.3.1
	 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function o(t){Z=t}function s(t){G=t}function r(){return function(){return e.nextTick(u)}}function d(){return function(){W(u)}}function l(){var t=0,e=new K(u),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=u,function(){return t.port2.postMessage(0)}}function p(){var t=setTimeout;return function(){return t(u,1)}}function u(){for(var t=0;t<Y;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}Y=0}function v(){try{var t=n(7);return W=t.runOnLoop||t.runOnContext,d()}catch(t){return p()}}function h(t,e){var n=arguments,i=this,a=new this.constructor(m);void 0===a[at]&&z(a);var o=i._state;return o?!function(){var t=n[o-1];G(function(){return R(o,a,t,i._result)})}():E(i,a,t,e),a}function f(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(m);return w(n,t),n}function m(){}function b(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function _(t){try{return t.then}catch(t){return dt.error=t,dt}}function y(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}function A(t,e,n){G(function(t){var i=!1,a=y(n,e,function(n){i||(i=!0,e!==n?w(t,n):P(t,n))},function(e){i||(i=!0,C(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&a&&(i=!0,C(t,a))},t)}function I(t,e){e._state===st?P(t,e._result):e._state===rt?C(t,e._result):E(e,void 0,function(e){return w(t,e)},function(e){return C(t,e)})}function D(t,e,n){e.constructor===t.constructor&&n===h&&e.constructor.resolve===f?I(t,e):n===dt?C(t,dt.error):void 0===n?P(t,e):a(n)?A(t,e,n):P(t,e)}function w(e,n){e===n?C(e,b()):t(n)?D(e,n,_(n)):P(e,n)}function x(t){t._onerror&&t._onerror(t._result),k(t)}function P(t,e){t._state===ot&&(t._result=e,t._state=st,0!==t._subscribers.length&&G(k,t))}function C(t,e){t._state===ot&&(t._state=rt,t._result=e,G(x,t))}function E(t,e,n,i){var a=t._subscribers,o=a.length;t._onerror=null,a[o]=e,a[o+st]=n,a[o+rt]=i,0===o&&t._state&&G(k,t)}function k(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,a=void 0,o=t._result,s=0;s<e.length;s+=3)i=e[s],a=e[s+n],i?R(n,i,a,o):a(o);t._subscribers.length=0}}function F(){this.error=null}function T(t,e){try{return t(e)}catch(t){return lt.error=t,lt}}function R(t,e,n,i){var o=a(n),s=void 0,r=void 0,d=void 0,l=void 0;if(o){if(s=T(n,i),s===lt?(l=!0,r=s.error,s=null):d=!0,e===s)return void C(e,g())}else s=i,d=!0;e._state!==ot||(o&&d?w(e,s):l?C(e,r):t===st?P(e,s):t===rt&&C(e,s))}function O(t,e){try{e(function(e){w(t,e)},function(e){C(t,e)})}catch(e){C(t,e)}}function B(){return ct++}function z(t){t[at]=ct++,t._state=void 0,t._result=void 0,t._subscribers=[]}function S(t,e){this._instanceConstructor=t,this.promise=new t(m),this.promise[at]||z(this.promise),H(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&P(this.promise,this._result))):C(this.promise,M())}function M(){return new Error("Array Methods must be provided an Array")}function N(t){return new S(this,t).promise}function L(t){var e=this;return new e(H(t)?function(n,i){for(var a=t.length,o=0;o<a;o++)e.resolve(t[o]).then(n,i)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function V(t){var e=this,n=new e(m);return C(n,t),n}function q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Q(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function $(t){this[at]=B(),this._result=this._state=void 0,this._subscribers=[],m!==t&&("function"!=typeof t&&q(),this instanceof $?O(this,t):Q())}function U(){var t=void 0;if("undefined"!=typeof i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=$}var j=void 0;j=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var H=j,Y=0,W=void 0,Z=void 0,G=function(t,e){nt[Y]=t,nt[Y+1]=e,Y+=2,2===Y&&(Z?Z(u):it())},J="undefined"!=typeof window?window:void 0,X=J||{},K=X.MutationObserver||X.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),it=void 0;it=tt?r():K?l():et?c():void 0===J?v():p();var at=Math.random().toString(36).substring(16),ot=void 0,st=1,rt=2,dt=new F,lt=new F,ct=0;return S.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===ot&&n<t;n++)this._eachEntry(e[n],n)},S.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===f){var a=_(t);if(a===h&&t._state!==ot)this._settledAt(t._state,e,t._result);else if("function"!=typeof a)this._remaining--,this._result[e]=t;else if(n===$){var o=new n(m);D(o,t,a),this._willSettleAt(o,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},S.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===ot&&(this._remaining--,t===rt?C(i,n):this._result[e]=n),0===this._remaining&&P(i,this._result)},S.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(st,e,t)},function(t){return n._settledAt(rt,e,t)})},$.all=N,$.race=L,$.resolve=f,$.reject=V,$._setScheduler=o,$._setAsap=s,$._asap=G,$.prototype={constructor:$,then:h,catch:function(t){return this.then(null,t)}},U(),$.polyfill=U,$.Promise=$,$})}).call(e,n(6),function(){return this}())},,function(t,e){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var i,a;i=n(59),a=n(60),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(46),a=n(5);e.default={name:"SelectRegionView",ready:function(){this.regions&&this.regions instanceof Array&&this.regions.length>0?this.setAllRegions():this.getProvinceRegions()},props:["regions"],data:function(){return{province:0,city:0,county:0,provinces:[],cities:[],counties:[]}},watch:{regions:function(t,e){this.setAllRegions()}},methods:{regionFilter:function(t){return function(e){return e.region_id===t}},changeProvince:function(t){var e=this;this.city=0,this.county=0,this.cities=[],this.counties=[],this.getCityRegions(this.province).then(function(t){e.dispatchResultRegion()})},changeCity:function(t){var e=this;this.county=0,this.counties=[],this.getCountyRegions(this.city).then(function(t){e.dispatchResultRegion()})},changeCounty:function(t){this.dispatchResultRegion()},dispatchResultRegion:function(){var t={};if(0===this.province||0===this.city)t.region=0;else if(this.counties.length>0&&0===this.county)t.region=0;else{var e=this.provinces.filter(this.regionFilter(this.province))[0],n=this.cities.filter(this.regionFilter(this.city))[0];if(0===this.counties.length)t.region=this.city,t.all_regions=[{id:this.province,name:e?e.name:""},{id:this.city,name:n?n.name:""}];else{var i=this.counties.filter(this.regionFilter(this.county))[0];t.region=this.county,t.all_regions=[{id:this.province,name:e?e.name:""},{id:this.city,name:n?n.name:""},{id:this.county,name:i?i.name:""}]}}this.$dispatch("select-region",t)},setAllRegions:function(){var t=this;this.province=0,this.city=0,this.county=0,this.provinces=[],this.cities=[],this.counties=[],a.Promise.all([this.getProvinceRegions(),this.getCityRegions(this.regions[0]),this.getCountyRegions(this.regions[1])]).then(function(e){t.province=t.regions[0]||0,t.city=t.regions[1]||0,t.county=t.regions[2]||0,t.dispatchResultRegion()})},getProvinceRegions:function(){var t=this;return new a.Promise(function(e,n){var a="/api/v2/web/locations/full-provinces";t.$http.get(a).then(function(a){a.data.provinces?(t.provinces=a.data.provinces,e()):(i.callback.success(a.data),n(a.data))},function(t){i.callback.error(t),n(t)})})},getCityRegions:function(t){var e=this;return t?new a.Promise(function(n,a){var o="/api/v2/web/locations/province-cities?province_id="+t;e.$http.get(o).then(function(t){t.data.cities?(e.cities=t.data.cities,n()):(i.callback.success(t.data),a(t.data))},function(t){i.callback.error(t),a(t)})}):new a.Promise(function(t,n){e.cities=[],t()})},getCountyRegions:function(t){var e=this;return t?new a.Promise(function(n,a){var o="/api/v2/web/locations/city-counties?city_id="+t;e.$http.get(o).then(function(t){t.data.counties?(e.counties=t.data.counties,n()):0===t.data.result?(e.counties=[],n()):(i.callback.success(t.data),a(t.data))},function(t){i.callback.error(t),a(t)})}):new a.Promise(function(t,n){e.counties=[],t()})}}}},function(t,e){t.exports=' <div> <div class=col-lg-1 style=width:110px> <select class="form-control input-sm" v-model=province number @change=changeProvince> <option value=0>选择省</option> <template v-for="option of provinces"> <option v-bind:value=option.region_id>{{option.name}}</option> </template> </select> </div> <div class=col-lg-1 style=width:110px> <select class="form-control input-sm" v-model=city number @change=changeCity> <option value=0>选择市</option> <template v-for="option of cities"> <option v-bind:value=option.region_id>{{option.name}}</option> </template> </select> </div> <div class=col-lg-1 style=width:110px> <select class="form-control input-sm" v-if="counties.length>0" v-model=county number @change=changeCounty> <option value=0>选择区</option> <template v-for="option of counties"> <option v-bind:value=option.region_id>{{option.name}}</option> </template> </select> </div> </div> '},,function(t,e,n){var i,a;i=n(63),a=n(69),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(64),o=i(a);e.default={name:"EditInvoiceInfoComponentView",components:{invoiceInfoComponent:o.default},props:["editInvoiceChecked","invoiceData","consignees"]}},function(t,e,n){var i,a;n(65),i=n(67),a=n(68),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(66);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".use-consignee-info.btn-link{text-decoration:none;cursor:pointer}.use-consignee-info.btn-link:hover{text-decoration:underline}","",{version:3,sources:["/./src/views/order/comp/invoiceInfoComponent.vue.style"],names:[],mappings:"AA+GA,6BACA,qBAAA,AACA,cAAA,CACA,AAEA,mCACA,yBAAA,CACA",file:"invoiceInfoComponent.vue",sourcesContent:['<!-- editInvoiceInfoComponent.vue -->\n<template>\n\t<div class="row">\n\t\t<div class="col-md-6">\n            <div class="form-group">\n                <label class="control-label" for="invoiceAmount">开票金额<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:30%;" id="invoiceAmount" type="text" v-model="invoiceData.amount | priceFilter">\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceContent">开票内容<span class="text-danger">*</span></label>\n                <select class="form-control" style="width:30%;" id="invoiceContent" v-model="invoiceData.content">\n                    <option>制作费</option>\n                    <option>服务费</option>\n                    <option>会议服务费</option>\n                    <option>设计费</option>\n                    <option>代理费</option>\n                    <option>文化咨询费</option>\n                </select>\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceType">发票类型<span class="text-danger">*</span></label>\n                <select class="form-control" style="width:30%;" id="invoiceType" v-model="invoiceData.zengzhishui | formatInvoiceType" number>\n                    <option value="1">普通发票</option>\n                    <option value="2">增值税发票</option>\n                </select>\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceTitle">开票抬头<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:50%;" id="invoiceTitle" type="text" v-model="invoiceData.title">\n            </div>\n            <div v-if="invoiceData.zengzhishui">\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSIdentifier">纳税人识别号<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSIdentifier" type="text" v-model="invoiceData.zengzhishui.identifier">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSAddress">注册地址<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSAddress" type="text" v-model="invoiceData.zengzhishui.address">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSPhone">电话<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSPhone" type="text" v-model="invoiceData.zengzhishui.phone">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSBank">开户行<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSBank" type="text" v-model="invoiceData.zengzhishui.bank">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSAccount">账号<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSAccount" type="text" v-model="invoiceData.zengzhishui.account">\n                </div>\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceRemark">备注</label>\n                <input class="form-control" style="width:80%;" id="invoiceRemark" type="text" v-model="invoiceData.remark">\n            </div>\n        </div>\n        <div class="col-md-6">\n            <h4>发票寄送至：</h4>\n            <p v-for="consignee of consignees">\n                <a class="use-consignee-info btn-link" @click="useConsigneeInfo(consignee)">使用收货人{{$index + 1}}信息</a>\n            </p>\n            <div class="form-group">\n                <label class="control-label" for="invoiceConsigneeName">收货人<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:30%;" id="invoiceConsigneeName" type="text" v-model="invoiceData.consignee_name">\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceConsigneePhone">联系方式<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:30%;" id="invoiceConsigneePhone" type="text" v-model="invoiceData.consignee_phone">\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceConsigneeAddress">收货地址<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:80%;" id="invoiceConsigneeAddress" type="text" v-model="invoiceData.address">\n            </div>\n        </div>\n\t</div>\n</template>\n\n<script>\nexport default {\n    name: \'InvoiceInfoComponentView\',\n    props: [\'invoiceData\', \'consignees\'],\n    filters: {\n        formatInvoiceType: {\n            read(val) {\n                return val ? 2 : 1;\n            },\n            write(val, oldVal) {\n                if (val == 1) {\n                    return undefined;\n                } else {\n                    return {};\n                }\n            },\n        }\n    },\n    methods: {\n        useConsigneeInfo(consignee) {\n            this.invoiceData.consignee_name = consignee.name;\n            this.invoiceData.consignee_phone = consignee.phone;\n            if (consignee.fullRegionName && consignee.address) {\n                this.invoiceData.address = consignee.fullRegionName + consignee.address;\n            } else {\n                this.invoiceData.address = \'\';\n            }\n        },\n    },\n}\n</script>\n\n<style scope>\n.use-consignee-info.btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.use-consignee-info.btn-link:hover {\n    text-decoration: underline;\n}\n</style>'],sourceRoot:"webpack://"}])},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"InvoiceInfoComponentView",props:["invoiceData","consignees"],filters:{formatInvoiceType:{read:function(t){return t?2:1},write:function(t,e){return 1==t?void 0:{}}}},methods:{useConsigneeInfo:function(t){this.invoiceData.consignee_name=t.name,this.invoiceData.consignee_phone=t.phone,t.fullRegionName&&t.address?this.invoiceData.address=t.fullRegionName+t.address:this.invoiceData.address=""}}}},function(t,e){t.exports=' <div class=row> <div class=col-md-6> <div class=form-group> <label class=control-label for=invoiceAmount>开票金额<span class=text-danger>*</span></label> <input class=form-control style=width:30% id=invoiceAmount type=text v-model="invoiceData.amount | priceFilter"> </div> <div class=form-group> <label class=control-label for=invoiceContent>开票内容<span class=text-danger>*</span></label> <select class=form-control style=width:30% id=invoiceContent v-model=invoiceData.content> <option>制作费</option> <option>服务费</option> <option>会议服务费</option> <option>设计费</option> <option>代理费</option> <option>文化咨询费</option> </select> </div> <div class=form-group> <label class=control-label for=invoiceType>发票类型<span class=text-danger>*</span></label> <select class=form-control style=width:30% id=invoiceType v-model="invoiceData.zengzhishui | formatInvoiceType" number> <option value=1>普通发票</option> <option value=2>增值税发票</option> </select> </div> <div class=form-group> <label class=control-label for=invoiceTitle>开票抬头<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceTitle type=text v-model=invoiceData.title> </div> <div v-if=invoiceData.zengzhishui> <div class=form-group> <label class=control-label for=invoiceZZSIdentifier>纳税人识别号<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSIdentifier type=text v-model=invoiceData.zengzhishui.identifier> </div> <div class=form-group> <label class=control-label for=invoiceZZSAddress>注册地址<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSAddress type=text v-model=invoiceData.zengzhishui.address> </div> <div class=form-group> <label class=control-label for=invoiceZZSPhone>电话<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSPhone type=text v-model=invoiceData.zengzhishui.phone> </div> <div class=form-group> <label class=control-label for=invoiceZZSBank>开户行<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSBank type=text v-model=invoiceData.zengzhishui.bank> </div> <div class=form-group> <label class=control-label for=invoiceZZSAccount>账号<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSAccount type=text v-model=invoiceData.zengzhishui.account> </div> </div> <div class=form-group> <label class=control-label for=invoiceRemark>备注</label> <input class=form-control style=width:80% id=invoiceRemark type=text v-model=invoiceData.remark> </div> </div> <div class=col-md-6> <h4>发票寄送至：</h4> <p v-for="consignee of consignees"> <a class="use-consignee-info btn-link" @click=useConsigneeInfo(consignee)>使用收货人{{$index + 1}}信息</a> </p> <div class=form-group> <label class=control-label for=invoiceConsigneeName>收货人<span class=text-danger>*</span></label> <input class=form-control style=width:30% id=invoiceConsigneeName type=text v-model=invoiceData.consignee_name> </div> <div class=form-group> <label class=control-label for=invoiceConsigneePhone>联系方式<span class=text-danger>*</span></label> <input class=form-control style=width:30% id=invoiceConsigneePhone type=text v-model=invoiceData.consignee_phone> </div> <div class=form-group> <label class=control-label for=invoiceConsigneeAddress>收货地址<span class=text-danger>*</span></label> <input class=form-control style=width:80% id=invoiceConsigneeAddress type=text v-model=invoiceData.address> </div> </div> </div> '},function(t,e){t.exports=' <div class="panel panel-default"> <div class=panel-body> <div class=checkbox> <label> <input type=checkbox v-model=editInvoiceChecked>填写发票信息 </label> </div> <invoice-info-component :invoice-data=invoiceData :consignees=consignees v-show=editInvoiceChecked> </invoice-info-component> </div> </div> '},function(t,e,n){var i,a;n(71),i=n(73),a=n(74),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(72);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-93eabb2e]{height:100%}.modal-dialog[_v-93eabb2e]{top:30%}","",{version:3,sources:["/./src/components/popupDialog.vue.style"],names:[],mappings:"AAwDA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"popupDialog.vue",sourcesContent:['<!-- popupDialog.vue -->\n<template>\n    <div class="modal" v-show="showDialog">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">{{ dialogTitle }}</h4>\n                </div>\n                <div class="modal-body">\n                    <p>{{ dialogContent }}</p>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" @click="clickNegativeButton">{{ negativeButtonText }}</button>\n        \t\t\t<button type="button" class="btn btn-primary" @click="clickPositiveButton">{{ positiveButtonText }}</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n\nexport default {\n    name: \'PopupDialogView\',\n    props: {\n    \tshowDialog: Boolean,\n    \tdialogTitle: String,\n    \tdialogContent: String,\n    \tnegativeButtonText: {\n    \t\ttype: String,\n    \t\tdefault: \'取消\'\n    \t},\n    \tpositiveButtonText: {\n    \t\ttype: String,\n    \t\tdefault: \'确定\'\n    \t},\n    },\n    methods: {\n    \tcloseDialog(event) {\n    \t\tthis.showDialog = false;\n    \t},\n    \tclickPositiveButton(event) {\n    \t\tthis.showDialog = false;\n    \t\tthis.$dispatch(\'click-positive-button\');\n    \t},\n    \tclickNegativeButton(event) {\n    \t\tthis.showDialog = false;\n    \t\tthis.$dispatch(\'click-negative-button\');\n    \t},\n    },\n}\n\n</script>\n\n<style scoped>\n.modal {\n\theight: 100%;\n}\n\n.modal-dialog {\n\ttop: 30%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"PopupDialogView",props:{showDialog:Boolean,dialogTitle:String,dialogContent:String,negativeButtonText:{type:String,default:"取消"},positiveButtonText:{type:String,default:"确定"}},methods:{closeDialog:function(t){this.showDialog=!1},clickPositiveButton:function(t){this.showDialog=!1,this.$dispatch("click-positive-button")},clickNegativeButton:function(t){this.showDialog=!1,this.$dispatch("click-negative-button")}}}},function(t,e){t.exports=' <div class=modal v-show=showDialog _v-93eabb2e=""> <div class=modal-dialog _v-93eabb2e=""> <div class=modal-content _v-93eabb2e=""> <div class=modal-header _v-93eabb2e=""> <button type=button class=close @click=closeDialog _v-93eabb2e="">×</button> <h4 class=modal-title _v-93eabb2e="">{{ dialogTitle }}</h4> </div> <div class=modal-body _v-93eabb2e=""> <p _v-93eabb2e="">{{ dialogContent }}</p> </div> <div class=modal-footer _v-93eabb2e=""> <button type=button class="btn btn-default" @click=clickNegativeButton _v-93eabb2e="">{{ negativeButtonText }}</button> <button type=button class="btn btn-primary" @click=clickPositiveButton _v-93eabb2e="">{{ positiveButtonText }}</button> </div> </div> </div> </div> '},function(t,e,n){var i,a;n(76),i=n(78),a=n(79),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(77);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal{height:100%}.modal-dialog{top:30%}","",{version:3,sources:["/./src/views/order/comp/productDetailDialog.vue.style"],names:[],mappings:"AAkDA,OACA,WAAA,CACA,AAEA,cACA,OAAA,CACA",file:"productDetailDialog.vue",sourcesContent:['<!-- productDetailDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="hideDialog">&times;</button>\n                    <h4 class="modal-title">非标品详情</h4>\n                </div>\n                <div class="modal-body">\n                    <div class="row">\n                        <div class="col-md-3">产品名称：</div>\n                        <div class="col-md-9">{{detail.name}}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-3">数量：</div>\n                        <div class="col-md-9">{{detail.quantity}}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-3">产品尺寸：</div>\n                        <div class="col-md-9">{{detail.size}}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-3">材质：</div>\n                        <div class="col-md-9">{{detail.caizhi}}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-3">其他要求：</div>\n                        <div class="col-md-9">{{detail.others}}</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \'ProductDetailDialogView\',\n    props: [\'show\', \'detail\'],\n    methods: {\n        hideDialog() {\n            this.show = false;\n            this.$dispatch(\'hide-product-detail-dialog\');\n        }\n    },\n}\n</script>\n\n<style>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 30%;\n}\n</style>'],sourceRoot:"webpack://"}])},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"ProductDetailDialogView",props:["show","detail"],methods:{hideDialog:function(){this.show=!1,this.$dispatch("hide-product-detail-dialog")}}}},function(t,e){t.exports=" <div class=modal v-show=show> <div class=modal-dialog> <div class=modal-content> <div class=modal-header> <button type=button class=close @click=hideDialog>&times;</button> <h4 class=modal-title>非标品详情</h4> </div> <div class=modal-body> <div class=row> <div class=col-md-3>产品名称：</div> <div class=col-md-9>{{detail.name}}</div> </div> <div class=row> <div class=col-md-3>数量：</div> <div class=col-md-9>{{detail.quantity}}</div> </div> <div class=row> <div class=col-md-3>产品尺寸：</div> <div class=col-md-9>{{detail.size}}</div> </div> <div class=row> <div class=col-md-3>材质：</div> <div class=col-md-9>{{detail.caizhi}}</div> </div> <div class=row> <div class=col-md-3>其他要求：</div> <div class=col-md-9>{{detail.others}}</div> </div> </div> </div> </div> </div> "},function(t,e,n){var i,a;n(81),i=n(83),a=n(84),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(82);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".popuptips-container[_v-d1dee2ce]{position:fixed;left:50%;top:40%;z-index:2000}.panel[_v-d1dee2ce]{position:relative;left:-50%}.fade-transition[_v-d1dee2ce]{-webkit-transition:all 1s ease;transition:all 1s ease}.fade-leave[_v-d1dee2ce]{opacity:0}","",{version:3,sources:["/./src/components/popupTips.vue.style"],names:[],mappings:"AAuCA,kCACA,eAAA,AACA,SAAA,AACA,QAAA,AACA,YAAA,CACA,AACA,oBACA,kBAAA,AACA,SAAA,CACA,AAEA,8BACA,+BAAA,sBAAA,CACA,AAEA,yBACA,SAAA,CACA",file:"popupTips.vue",sourcesContent:['<!-- popupTips.vue -->\n<template>\n\t<div class="popuptips-container" v-if="show" transition="fade">\n\t    <div class="panel panel-{{ tipsType }}">\n\t\t\t<div class="panel-heading">\n\t\t   \t\t<h3 class="panel-title">{{ tipsTitle }}</h3>\n\t\t\t</div>\n\t\t\t<div class="panel-body">\n\t\t    \t{{ tipsContent }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n    name: \'PopupTipsView\',\n    replace: false,\n    props: {\n    \tshow: Boolean,\n    \ttipsType: String,\n    \ttipsTitle: String,\n    \ttipsContent: String\n    },\n    watch: {\n        show(val, oldVal) {\n            if (val === true) {\n            \tsetTimeout(() => {\n            \t\tthis.show = false;\n            \t}, 1000);\n            }\n        },\n    },\n}\n\n</script>\n\n<style scoped>\n.popuptips-container {\n\tposition: fixed;\n\tleft: 50%;\n\ttop: 40%;\n    z-index: 2000;\n}\n.panel {\n\tposition: relative;\n    left: -50%;\n}\n\n.fade-transition {\n  transition: all 1s ease;\n}\n\n.fade-leave {\n  opacity: 0;\n}\n</style>'],sourceRoot:"webpack://"}])},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"PopupTipsView",replace:!1,props:{show:Boolean,tipsType:String,tipsTitle:String,tipsContent:String},watch:{show:function(t,e){var n=this;t===!0&&setTimeout(function(){n.show=!1},1e3)}}}},function(t,e){t.exports=' <div class=popuptips-container v-if=show transition=fade _v-d1dee2ce=""> <div class="panel panel-{{ tipsType }}" _v-d1dee2ce=""> <div class=panel-heading _v-d1dee2ce=""> <h3 class=panel-title _v-d1dee2ce="">{{ tipsTitle }}</h3> </div> <div class=panel-body _v-d1dee2ce=""> {{ tipsContent }} </div> </div> </div> '},function(t,e){"use strict";function n(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="产品名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="产品名称不能为空",e)}function i(t){var e={};return e.ok=!1,t?t.length>12?(e.errorMsg="产品数量长度不能大于12",e):(e.ok=!0,e):(e.errorMsg="产品数量不能为空",e)}function a(t){var e={};return e.ok=!1,!t||t<0?(e.errorMsg="产品价格不能为空且必须为正数",e):(e.ok=!0,e)}function o(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="客户名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="客户名称不能为空",e)}function s(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="收货人名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="收货人名称不能为空",
e)}function r(t){var e={};e.ok=!1;var n=/^[0-9]{11}$/;return t?n.test(t)?(e.ok=!0,e):(e.errorMsg="收货人手机格式有误",e):(e.errorMsg="收货人手机不能为空",e)}function d(t,e){var n={};return n.ok=!1,0===t?(n.errorMsg="请选择收货人所在地省市区",n):e?e.length>50?(n.errorMsg="收货人详细地址不能大于50",n):(n.ok=!0,n):(n.errorMsg="收货人详细地址不能为空",n)}function l(t){var e={};return e.ok=!1,!t||t<0?(e.errorMsg="开票金额不能为空且必须为正数",e):(e.ok=!0,e)}function c(t,e){var n={};return n.ok=!1,e?e.length>50?(n.errorMsg=t+"长度不能大于50",n):(n.ok=!0,n):(n.errorMsg=t+"不能为空",n)}function p(t,e){var n={};return n.ok=!1,void 0===t||null===t||""===t?(n.errorMsg="使用额度不能为空",n):t<=0||t>e?(n.errorMsg="使用额度必须为正数且不能超过"+e/100+"元",n):(n.ok=!0,n)}function u(t,e){var n={};return n.ok=!1,void 0===t||null===t||""===t?(n.errorMsg="补充金额不能为空",n):t<=e?(n.errorMsg="补充金额必须大于"+e/100+"元",n):(n.ok=!0,n)}function v(t){var e={};return e.ok=!1,void 0===t||null===t||""===t?(e.errorMsg="额外成本不能为空",e):t<0?(e.errorMsg="额外成本必须大于等于0",e):(e.ok=!0,e)}function h(t,e){var n={};return n.ok=!1,e?e.length>2e3?(n.errorMsg=t+"长度不能大于2000",n):(n.ok=!0,n):(n.errorMsg=t+"不能为空",n)}function f(t,e){var n={};return n.ok=!1,t?t<0?(n.errorMsg="成本必须大于0",n):(n.ok=!0,n):e?(n.ok=!0,n):(n.errorMsg="成本不能为空或者0",n)}function m(t){var e={};return e.ok=!1,void 0===t||null===t||""===t?(e.errorMsg="物流成本不能为空",e):t<0?(e.errorMsg="物流成本必须大于等于0",e):(e.ok=!0,e)}function b(t,e){var n={};return n.ok=!1,e?e.length>2e3?(n.errorMsg=t+"长度不能大于2000",n):(n.ok=!0,n):(n.errorMsg=t+"不能为空",n)}function g(t,e){var n={};return n.ok=!1,!t||t<0?(n.errorMsg="退款金额不能为空且必须为正数",n):t>e?(n.errorMsg="退款金额不能大于"+e/100+"元",n):(n.ok=!0,n)}function _(t){var e={};return e.ok=!1,t?t.length>50?(e.errorMsg="对方账号长度不能大于50",e):(e.ok=!0,e):(e.errorMsg="对方账号不能为空",e)}function y(t){var e={};return e.ok=!1,t?t.length>2e3?(e.errorMsg="退款原因长度不能大于2000",e):(e.ok=!0,e):(e.errorMsg="退款原因不能为空",e)}function A(t,e){var n={};return n.ok=!1,!t||t<0?(n.errorMsg="付款金额不能为空且必须为正数",n):t>e?(n.errorMsg="付款金额不能大于该订单剩余的待支付金额("+e/100+"元)",n):(n.ok=!0,n)}function I(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="供应商名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="供应商名称不能为空",e)}function D(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="真实姓名长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="真实姓名不能为空",e)}function w(t){var e={};return e.ok=!1,t?t.length>50?(e.errorMsg="用户名长度不能大于50",e):(e.ok=!0,e):(e.errorMsg="用户名不能为空",e)}function x(t){var e={};e.ok=!1;var n=/^[a-zA-Z0-9]*$/;return t?t.length>20?(e.errorMsg="密码长度不能超过20",e):n.test(t)?(e.ok=!0,e):(e.errorMsg="密码只能包含英文字母和数字",e):(e.errorMsg="密码不能为空",e)}Object.defineProperty(e,"__esModule",{value:!0});var P="******";e.orderValidator={validateProductName:n,validateProductQuantity:i,validateProductPrice:a,validateCustomerName:o,validateConsigneeName:s,validateConsigneePhone:r,validateConsigneeAddress:d,validateInvoiceAmount:l,validateInvoiceItem:c,validateApplyInvoiceAmount:p,validateExtraAmount:u,validateExtraCost:v,validateAfterSaleItem:h,validateProductCost:f,validateLogisticsCost:m,validateLogisticsItem:b,validateRefundAmount:g,validateRefundAccount:_,validateRefundReason:y},e.financeValidator={validatePaymentAmount:A},e.crmValidator={validateSupplierName:I,validateDisplayName:D,validateUserName:w,validatePassword:x,DEFAULT_PASSWORD:P}},,function(t,e,n){var i,a;n(88),i=n(90),a=n(143),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(89);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".payment-records-table[_v-b921fbfe],.product-table[_v-b921fbfe],.refund-records-table[_v-b921fbfe]{table-layout:fixed}.payment-records-table td[_v-b921fbfe],.payment-records-table th[_v-b921fbfe],.product-table td[_v-b921fbfe],.product-table th[_v-b921fbfe],.refund-records-table td[_v-b921fbfe],.refund-records-table th[_v-b921fbfe]{text-align:center;vertical-align:middle}.invoice-info .btn-link[_v-b921fbfe],.product-table td .btn-link[_v-b921fbfe]{text-decoration:none;cursor:pointer}.invoice-info .btn-link[_v-b921fbfe]:hover,.product-table td .btn-link[_v-b921fbfe]:hover{text-decoration:underline}","",{version:3,sources:["/./src/views/order/detail.vue.style"],names:[],mappings:"AA24BA,mGACA,kBAAA,CACA,AAEA,wNACA,kBAAA,AACA,qBAAA,CACA,AAEA,8EACA,qBAAA,AACA,cAAA,CACA,AAEA,0FACA,yBAAA,CACA",file:"detail.vue",sourcesContent:['<!-- detail.vue -->\n<template>\n    <div class="container-fluid">\n        <ul class="breadcrumb">\n            <li>订单系统</li>\n            <li>订单管理</li>\n            <li>订单详情：{{orderId}}</li>\n        </ul>\n        <div class="pull-right">\n            <a class="btn btn-info btn-sm" v-show="canCancel" @click="showCancelOrderDialog">取消</a>\n            <a class="btn btn-info btn-sm" v-show="canFinish" @click="showFinishOrderDialog">完成</a>\n            <a class="btn btn-info btn-sm" v-show="canConfirm" @click="showConfirmOrderDialog">确认</a>\n            <a class="btn btn-info btn-sm" v-show="orderId && permissionList.editOrder" v-link="{ path: \'/order/edit/\'+orderId }">编辑</a>\n            <a class="btn btn-info btn-sm" v-show="orderId && permissionList.createOrder" v-link="{ path: \'/order/create/\'+orderId }" target="_blank">复制该订单</a>\n        </div>\n        <h3>订单详情</h3>\n        <p class="clearfix"></p>\n        <div class="panel panel-default">\n            <div class="panel-body">\n                <div class="row h4">\n                    <div class="col-lg-3"><b>订单编号：</b>{{orderBasic.id}}</div>\n                    <div class="col-lg-3"><b>订单状态：</b>{{orderBasic.status | orderStatusFilter}}</div>\n                    <div class="col-lg-3"><b>订单日期：</b>{{orderDate | dateFormat \'toDate\'}}</div>\n                    <div class="col-lg-3"><b>创建时间：</b>{{orderBasic.create_time | dateFormat}}</div>\n                </div>\n                <div class="row h4">\n                    <div class="col-lg-3"><b>客户经理/客服：</b>{{orderBasic.manager ? orderBasic.manager.display_name : \'\'}}</div>\n                    <div class="col-lg-6"><b>创建人：</b>{{orderBasic.creator.type === \'USER\' ? \'酱印网 \' + (orderBasic.creator.username ? orderBasic.creator.username : \'\') : orderBasic.creator.display_name}}</div>\n                </div>\n                <div class="row h4">\n                    <div class="col-lg-3"><b>订单金额：</b>{{(orderId ? orderBasic.amount + orderBasic.freight : \'\') | realPrice}}{{orderBasic.is_priced === false ? \'+？\' : \'\'}}元</div>\n                    <div class="col-lg-3"><b>盈利：</b>{{(isOrderProfitSure ? (orderBasic.amount + orderBasic.freight - orderBasic.cost - orderBasic.extra_cost - orderBasic.logistics_cost - orderBasic.invoice_logistics_cost - orderBasic.refunded_amount) : \'\') | realPrice}}{{(!orderId || isOrderProfitSure) ? \'\' : \'？\'}}元</div>\n                </div>\n                <div class="row h4">\n                    <div class="col-lg-3"><b>商品成本：</b>{{orderBasic.cost | realPrice}}{{!orderId || isProductCostSure ? \'\' : \'+？\'}}元</div>\n                    <div class="col-lg-3"><b>额外成本：</b>{{orderBasic.extra_cost | realPrice}}元</div>\n                    <div class="col-lg-3"><b>物流成本：</b>{{orderBasic.logistics_cost | realPrice}}+{{orderBasic.invoice_logistics_cost | realPrice}}元</div>\n                    <div class="col-lg-3"><b>退款金额：</b>{{orderBasic.refunded_amount | realPrice}}元</div>\n                </div>  \n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-heading">商品清单</div>\n            <div class="panel-body">\n                <table class="table table-bordered table-hover product-table">\n                    <thead>\n                        <tr>\n                            <th style="width:6%;">ID</th>\n                            <th style="width:10%;">产品名称</th>\n                            <th style="width:18%;">参数</th>\n                            <th style="width:8%;">数量</th>\n                            <th style="width:8%;">价格(元)</th>\n                            <th style="width:8%;">成本(元)</th>\n                            <th style="width:15%;">到货时间要求</th>\n                            <th style="width:8%;">制作负责人</th>\n                            <th style="width:8%;">制作状态</th>\n                            <th style="width:11%;">印刷文件</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="item of orderItems">\n                            <td>{{item.id}}</td>\n                            <template v-if="item.is_custom">\n                                <td>{{item.detail.name}}</td>\n                                <td>\n                                    <a class="btn-link" @click="showProductDetailDialog(item)">\n                                        {{item.detail.size}}{{(item.detail.size && (item.detail.caizhi || item.detail.others)) ? \'_\' : \'\'}}{{item.detail.caizhi}}{{(item.detail.caizhi && item.detail.others) ? \'_\' : \'\'}}{{item.detail.others}}\n                                    </a>\n                                </td>\n                                <td>{{item.detail.quantity}}</td>\n                            </template>\n                            <template v-else>\n                                <td>\n                                    <a class="btn-link" :href="\'http://www.soyyin.com/product?id=\'+item.product_id+\'#\'+item.brief" target="_blank">{{item.title}}</a>\n                                </td>\n                                <td>{{item.brief}}</td>\n                                <td>{{item.quantity}}</td>\n                            </template>\n                            <td>{{item.price === 0 ? \'暂无\' : \'\'}}{{(item.price === 0 ? \'\' : item.price ) | realPrice}}</td>\n                            <td>{{(item.cost ? item.cost : \'\') | realPrice}}</td>\n                            <td>{{item.arrival_time}}</td>\n                            <td>{{item.producer ? item.producer.name : \'\'}}</td>\n                            <td>{{item.produce_status | produceStatusFilter}}</td>\n                            <td><a class="btn-link" v-if="item.file" :href="item.file.file_key | getQiniuUrl" target="_blank">{{item.file.file_name}}</a></td>\n                        </tr>\n                    </tbody>\n                </table>\n\n                <div class="row">\n                    <div class="col-lg-6">\n                        <div class="panel panel-default">\n                            <div class="panel-body">\n                                <a class="pull-right btn btn-info btn-sm" v-show="canChangeExtraAmount" @click="changeExtraAmount">修改</a>\n                                <h4>订单金额补充</h4>\n                                <div class="row" style="margin: 0;">\n                                    <label class="pull-left">补充金额：</label>\n                                    <p class="pull-left">{{orderBasic.freight | realPrice}}元</p>\n                                </div>\n                                <div class="row" style="margin: 0;">\n                                    <label class="pull-left">备注：</label>\n                                    <p class="pull-left" style="width: 85%;">{{orderBasic.freight_remark}}</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-lg-6">\n                        <div class="panel panel-default">\n                            <div class="panel-body">\n                                <a class="pull-right btn btn-info btn-sm" v-show="canChangeExtraCost" @click="changeExtraCost">修改</a>\n                                <h4>额外成本</h4>\n                                <div class="row" style="margin: 0;">\n                                    <label class="pull-left">金额：</label>\n                                    <p class="pull-left">{{orderBasic.extra_cost | realPrice}}元</p>\n                                </div>\n                                <div class="row" style="margin: 0;">\n                                    <label class="pull-left">备注：</label>\n                                    <p class="pull-left" style="width: 85%;">{{orderBasic.extra_cost_remark}}</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div>\n                    <h4 class="pull-right"><b>订单金额：</b>{{(orderId ? orderBasic.amount + orderBasic.freight : \'\') | realPrice}}{{orderBasic.is_priced === false ? \'+？\' : \'\'}}元</h4>\n                </div>\n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-heading">客户信息</div>\n            <div class="panel-body">\n                <h4 class="row" style="margin-bottom: 25px;">\n                    <div class="col-lg-3"><b>客户名称：</b>{{orderBasic.customer.name}}</div>\n                    <div class="col-lg-3"><b>联系电话：</b>{{orderBasic.customer.phone}}</div>\n                    <div class="col-lg-2"><b>QQ：</b>{{orderBasic.customer.qq}}</div>\n                    <div class="col-lg-4"><b>公司：</b>{{orderBasic.customer.company}}</div>\n                </h4>\n                <template v-for="consigneeItem of consignees">\n                    <consignee-info-with-logistics :index="$index" :consignee-item="consigneeItem" :can-add-logistics="false"></consignee-info-with-logistics>\n                </template>\n            </div>\n        </div>\n        <div class="panel panel-default invoice-info">\n            <div class="panel-heading">发票信息</div>\n            <div class="panel-body">\n                <a class="pull-right btn btn-info btn-sm" v-if="canApplyInvoice" @click="clickToApplyInvoice">申请开票</a>\n                <h4 class="row">\n                    <div class="col-lg-3"><b>开票额度：</b>{{(orderId ? orderBasic.amount + orderBasic.freight : \'\') | realPrice}}{{orderBasic.is_priced === false ? \'+？\' : \'\'}}元</div>\n                    <div class="col-lg-3"><b>已申请：</b>{{orderBasic.invoiced_amount | realPrice}}元</div>\n                </h4>\n                <p><a class="btn-link" v-if="invoiceInfo" @click="clickToshowInvoiceInfoDialog">{{invoiceInfo.zengzhishui ? \'增值税发票\' : \'普通发票\'}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{invoiceInfo.title}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{invoiceInfo.content}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{invoiceInfo.amount | realPrice}}元</a></p>\n                <template v-if="invoiceRecords.length > 0">\n                    <h4>开票历史</h4>\n                    <div class="panel panel-default" v-for="recordItem in invoiceRecords">\n                        <div class="panel-body">\n                            <a class="pull-right btn-link" @click="showOrHideInvoiceRecordItem(recordItem)">{{recordItem.showAll ? \'收起\' : \'展开\'}}</a>\n                            <div class="row">\n                                <div class="col-lg-2"><b>状态：</b>{{recordItem.status | invoiceStatusFilter}}</div>\n                                <div class="col-lg-3"><b>申请时间：</b>{{recordItem.create_time | dateFormat}}</div>\n                                <div class="col-lg-6">{{recordItem.data.zengzhishui ? \'增值税发票\' : \'普通发票\'}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.data.title}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.data.content}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.data.amount | realPrice}}元</div>\n                            </div>\n                            <div v-show="recordItem.showAll">\n                                <div class="row">\n                                    <div class="col-lg-2"><b>开票申请ID：</b>{{recordItem.id}}</div>\n                                    <div class="col-lg-3"><b>开票类型：</b>{{recordItem.order_ids.length > 1 ? \'(\' + recordItem.order_ids.length + \'订单)合并开票\' : \'单开\'}}</div>\n                                    <div class="col-lg-2"><b>使用额度：</b>{{recordItem.amount_of_order | realPrice}}元</div>\n                                    <div class="col-lg-3" v-if="recordItem.invoice_time"><b>开票时间：</b>{{recordItem.invoice_time | dateFormat}}</div>\n                                    <div class="col-lg-3" v-if="recordItem.finish_time"><b>完成时间：</b>{{recordItem.finish_time | dateFormat}}</div>\n                                </div>\n                                <div class="row" style="margin: 0;" v-if="recordItem.data.remark">\n                                    <div class="pull-left"><b>备注：</b></div>\n                                    <p class="pull-left" style="width: 90%;">{{recordItem.data.remark}}</p>\n                                </div>\n                                <div class="row" v-if="recordItem.data.zengzhishui">\n                                    <div class="col-lg-1" style="text-align:right;">增值税发票信息</div>\n                                    <div class="col-lg-11">\n                                        <div class="row">\n                                            <div class="col-lg-4"><b>纳税人识别号：</b>{{recordItem.data.zengzhishui.identifier}}</div>\n                                            <div class="col-lg-3"><b>电话：</b>{{recordItem.data.zengzhishui.phone}}</div>\n                                        </div>\n                                        <div class="row">\n                                            <div class="col-lg-12"><b>注册地址：</b>{{recordItem.data.zengzhishui.address}}</div>\n                                        </div>\n                                        <div class="row">\n                                            <div class="col-lg-4"><b>银行账号：</b>{{recordItem.data.zengzhishui.account}}</div>\n                                            <div class="col-lg-7"><b>开户行：</b>{{recordItem.data.zengzhishui.bank}}</div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row">\n                                    <div class="col-lg-1" style="text-align:right;">发票寄送至</div>\n                                    <div class="col-lg-11">\n                                        <div class="row">\n                                            <div class="col-lg-4"><b>收货人：</b>{{recordItem.data.consignee_name}}</div>\n                                            <div class="col-lg-3"><b>联系电话：</b>{{recordItem.data.consignee_phone}}</div>\n                                        </div>\n                                        <div class="row">\n                                            <div class="col-lg-12"><b>邮寄地址：</b>{{recordItem.data.address}}</div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" v-if="recordItem.logistics">\n                                    <div class="col-lg-1" style="text-align:right;">物流信息</div>\n                                    <div class="col-lg-11">\n                                        <div>{{recordItem.logistics.delivery_method}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.express}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.express_order_id}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.cost | realPrice}}元&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.create_time | dateFormat}}录入</div>\n                                        <div v-if="recordItem.logistics.remark">{{recordItem.logistics.remark}}</div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </template>\n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-heading">付款信息</div>\n            <div class="panel-body">\n                <template v-if="orderBasic.status === \'DELIVERY_CONFIRMED\'">\n                    <a class="pull-right btn btn-info btn-sm" @click="jumpToZhifubaoPayLink">支付宝支付链接</a>\n                    <a class="pull-right btn btn-info btn-sm" style="margin-right:20px;" @click="showZhifubaoQRCodeDialog">支付宝二维码</a>\n                    <a class="pull-right btn btn-info btn-sm" style="margin-right:20px;" @click="showWeChatQRCodeDialog">微信二维码</a>\n                </template>\n                <h4 class="row">\n                    <template v-if="orderBasic.is_priced">\n                        <div class="col-lg-3"><b>已支付：</b>{{paymentData.paid_amount | realPrice}}元({{Math.round(paymentData.paid_amount / (orderBasic.amount + orderBasic.freight) * 100)}}%)</div>\n                        <div class="col-lg-3"><b>待支付：</b>{{(orderBasic.amount + orderBasic.freight - paymentData.paid_amount) | realPrice}}元({{100 - Math.round(paymentData.paid_amount / (orderBasic.amount + orderBasic.freight) * 100)}}%)</div>\n                    </template>\n                    <template v-else>\n                        <div class="col-lg-3"><b>已支付：</b>0元(0%)</div>\n                        <div class="col-lg-3"><b>待支付：</b>？元(100%)</div>\n                    </template>\n                </h4>\n                <h4 v-if="paymentData.payment"><b>付款方式：</b>{{paymentData.payment | paymentFilter}}</h4>\n                <p v-if="paymentData.remark">{{paymentData.remark}}</p>\n                <table class="table table-bordered table-hover payment-records-table" v-if="paymentData.records && paymentData.records.length > 0">\n                    <thead>\n                        <tr>\n                            <th style="width:5%;">序号</th>\n                            <th style="width:20%;">付款时间</th>\n                            <th style="width:10%;">付款途径</th>\n                            <th style="width:15%;">付款方式</th>\n                            <th style="width:30%;">支付单号</th>\n                            <th style="width:10%;">付款金额</th>\n                            <th style="width:10%;">付款比例</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="paymentRecordItem of paymentData.records">\n                            <td>{{$index + 1}}</td>\n                            <td>{{paymentRecordItem.create_time | dateFormat}}</td>\n                            <td>{{paymentRecordItem.method === \'PINGXX\' ? \'线上支付\' : \'线下转账\'}}</td>\n                            <td>{{paymentRecordItem.method === \'PINGXX\' ? \'Ping++支付\' : (paymentRecordItem.method === \'BANK_TRANSFER\' ? \'银行转账\' : \'支付宝转账\')}}</td>\n                            <td>{{paymentRecordItem.payment_order_id}}</td>\n                            <td>{{paymentRecordItem.amount | realPrice}}元</td>\n                            <td>{{Math.round(paymentRecordItem.amount / (orderBasic.amount + orderBasic.freight) * 100)}}%</td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-body">\n                <div class="col-md-6">\n                    <h4>其他信息</h4>\n                    <p><b>备注：</b>{{orderBasic.remark}}</p>\n                </div>\n                <div class="col-md-6">\n                    <h4>历史记录</h4>\n                    <ul class="list-unstyled">\n                        <li v-for="history of orderHistories">\n                            <p :class="{\'text-muted\': $index+1 !== orderHistories.length}">\n                                {{$index+1}}.\n                                {{history.create_time | dateFormat}}\n                                <span :class="{\'text-success\': history.status === \'FINISHED\', \'text-danger\': history.status === \'CANCELED\'}">{{history.status | orderStatusFilter}}</span>\n                            </p>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-heading">售后处理</div>\n            <div class="panel-body">\n                <a class="pull-right btn btn-info btn-sm" v-if="canRecordAfterSale" @click="clickToRecordAfterSale">录入售后问题</a>\n                <div class="col-lg-10">\n                    <p><b>售后问题描述：</b>暂无</p>\n                    <p><b>处理方案：</b>暂无</p>\n                </div>\n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-heading">退款处理</div>\n            <div class="panel-body">\n                <a class="pull-right btn btn-info btn-sm" v-if="canApplyRefund" @click="clickToApplyRefund">申请退款</a>\n                <h4 class="row">\n                    <div class="col-lg-4"><b>已申请退款：</b>{{orderBasic.refunded_amount | realPrice}}元</div>\n                </h4>\n                <table class="table table-bordered table-hover refund-records-table" v-if="refundRecords.length > 0">\n                    <thead>\n                        <tr>\n                            <th style="width:5%;">序号</th>\n                            <th style="width:8%;">ID</th>\n                            <th style="width:8%;">退款金额</th>\n                            <th style="width:10%;">状态</th>\n                            <th style="width:19%;">操作时间</th>\n                            <th style="width:12%;">退款类型</th>\n                            <th style="width:22%;">退款信息</th>\n                            <th style="width:16%;">退款原因</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="refundItem in refundRecords">\n                            <td>{{$index + 1}}</td>\n                            <td>{{refundItem.id}}</td>\n                            <td>{{refundItem.amount | realPrice}}元</td>\n                            <td :class="{\'text-success\': refundItem.status === \'FINISHED\'}">{{refundItem.status | refundStatusFilter}}</td>\n                            <td>\n                                创建时间：{{refundItem.create_time | dateFormat}}<br>\n                                <template v-if="refundItem.finish_time">\n                                    完成时间：{{refundItem.finish_time | dateFormat}}<br>\n                                </template>\n                            </td>\n                            <td>{{refundItem.type | refundTypeFilter}}</td>\n                            <td>\n                                退款渠道：{{refundItem.method | refundWayFilter}}<br>\n                                <template v-if="refundItem.type === \'BY_HAND\'">\n                                    对方账号：{{refundItem.account}}<br>\n                                    对方姓名：{{refundItem.name}}<br>\n                                </template>\n                            </td>\n                            <td>{{refundItem.reason}}</td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        <!-- 发票信息弹框 -->\n        <div class="modal" style="height:100%;" v-if="invoiceInfo" v-show="showInvoiceInfoDialog">\n            <div class="modal-dialog" style="top:30%;width:900px;">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <button type="button" class="close" @click="closeInvoiceInfoDialog">&times;</button>\n                        <h4 class="modal-title">发票信息</h4>\n                    </div>\n                    <div class="modal-body">\n                        <div class="row">\n                            <div class="col-lg-2" style="text-align:right;">发票信息</div>\n                            <div class="col-lg-10">\n                                <div class="row">\n                                    <div class="col-lg-3"><b>开票金额：</b>{{invoiceInfo.amount | realPrice}}元</div>\n                                    <div class="col-lg-3"><b>开票类型：</b>{{invoiceInfo.zengzhishui ? \'增值税发票\' : \'普通发票\'}}</div>\n                                    <div class="col-lg-5"><b>开票内容：</b>{{invoiceInfo.content}}</div>\n                                </div>\n                                <div class="row">\n                                    <div class="col-lg-12"><b>发票抬头：</b>{{invoiceInfo.title}}</div>\n                                </div>\n                                <div class="row">\n                                    <div class="col-lg-12"><b>备注：</b>{{invoiceInfo.remark}}</div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="row" v-if="invoiceInfo.zengzhishui">\n                            <div class="col-lg-2" style="text-align:right;">增值税发票信息</div>\n                            <div class="col-lg-10">\n                                <div class="row">\n                                    <div class="col-lg-5"><b>纳税人识别号：</b>{{invoiceInfo.zengzhishui.identifier}}</div>\n                                    <div class="col-lg-4"><b>电话：</b>{{invoiceInfo.zengzhishui.phone}}</div>\n                                </div>\n                                <div class="row">\n                                    <div class="col-lg-12"><b>注册地址：</b>{{invoiceInfo.zengzhishui.address}}</div>\n                                </div>\n                                <div class="row">\n                                    <div class="col-lg-5"><b>银行账号：</b>{{invoiceInfo.zengzhishui.account}}</div>\n                                    <div class="col-lg-7"><b>开户行：</b>{{invoiceInfo.zengzhishui.bank}}</div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-lg-2" style="text-align:right;">发送寄送至</div>\n                            <div class="col-lg-10">\n                                <div class="row">\n                                    <div class="col-lg-3"><b>收货人：</b>{{invoiceInfo.consignee_name}}</div>\n                                    <div class="col-lg-5"><b>联系电话：</b>{{invoiceInfo.consignee_phone}}</div>\n                                </div>\n                                <div class="row">\n                                    <div class="col-lg-12"><b>邮寄地址：</b>{{invoiceInfo.address}}</div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <product-detail-dialog :show.sync="dataForProductDetailDialog.show" :detail="dataForProductDetailDialog.detail"></product-detail-dialog>\n        <edit-extra-amount-dialog v-if="canChangeExtraAmount" :show.sync="dataForEditExtraAmountDialog.show" :data="dataForEditExtraAmountDialog.data"></edit-extra-amount-dialog>\n        <edit-extra-cost-dialog v-if="canChangeExtraCost" :show.sync="dataForEditExtraCostDialog.show" :data="dataForEditExtraCostDialog.data"></edit-extra-cost-dialog>\n        <apply-invoice-dialog v-if="canApplyInvoice" :show.sync="dataForApplyInvoiceDialog.show" :order-ids="dataForApplyInvoiceDialog.orderIds" :invoice-info="dataForApplyInvoiceDialog.invoiceInfo" :max-apply-amount="dataForApplyInvoiceDialog.maxApplyAmount"></apply-invoice-dialog>\n        <pay-qr-code-dialog v-if="orderBasic.status === \'DELIVERY_CONFIRMED\'" :show.sync="dataForPayQrCodeDialog.show" :data="dataForPayQrCodeDialog.data"></pay-qr-code-dialog>\n        <apply-refund-dialog v-if="canApplyRefund" :show.sync="dataForApplyRefundDialog.show" :data="dataForApplyRefundDialog.data"></apply-refund-dialog>\n        <popup-dialog :show-dialog.sync="dataForPopupDialog.show" :dialog-title="dataForPopupDialog.title" :dialog-content="dataForPopupDialog.content"></popup-dialog>\n    </div>\n</template>\n\n<script>\nimport Vue from \'vue\'\nimport pingpp from \'pingpp-js\'\nimport { Promise } from \'es6-promise\'\nimport productDetailDialog from \'./comp/productDetailDialog.vue\'\nimport popupDialog from \'../../components/popupDialog.vue\'\nimport consigneeInfoWithLogistics from \'./comp/consigneeInfoWithLogistics.vue\'\nimport editExtraAmountDialog from \'./comp/editExtraAmountDialog.vue\'\nimport editExtraCostDialog from \'./comp/editExtraCostDialog.vue\'\nimport applyInvoiceDialog from \'./comp/applyInvoiceDialog.vue\'\nimport payQrCodeDialog from \'./comp/payQrCodeDialog.vue\'\nimport applyRefundDialog from \'./comp/applyRefundDialog.vue\'\nimport { callback } from \'../../store\'\nimport { permissionValidator } from \'../../store/rolePermission.js\'\n\nconst CANCEL_ORDER = "CANCEL_ORDER";\nconst FINISH_ORDER = "FINISH_ORDER";\nconst CONFIRM_ORDER = "CONFIRM_ORDER";\n\nexport default {\n    name: \'OrderDetailView\',\n    components: {\n        productDetailDialog,\n        popupDialog,\n        consigneeInfoWithLogistics,\n        editExtraAmountDialog,\n        editExtraCostDialog,\n        applyInvoiceDialog,\n        payQrCodeDialog,\n        applyRefundDialog,\n    },\n    route: {\n        data({to}) {\n            var orderId = to.params.id;\n            if(!orderId) {\n                this.$route.router.go({ path: \'/order/list\' });\n            }\n            this.getOrderDetial(orderId);\n        }\n    },\n    data() {\n        return {\n            orderId: \'\',\n            orderBasic: {\n                customer: {\n                },\n                creator: {\n                },\n            },\n            orderItems: [],\n            consignees: [],\n            paymentData: {},\n            invoiceInfo: null,\n            orderHistories: [],\n            invoiceRecords: [],\n            refundRecords: [],\n            orderDate: null,\n            permissionList: {\n                createOrder: permissionValidator.orderSystem.order.createOrder(),\n                editOrder: permissionValidator.orderSystem.order.editOrder(),\n                finishOrder: permissionValidator.orderSystem.order.finishOrder(),\n                cancelOrder: permissionValidator.orderSystem.order.cancelOrder(),\n                applyInvoice: permissionValidator.orderSystem.order.applyInvoice(),\n                afterSaleDeal: permissionValidator.orderSystem.order.afterSaleDeal(),\n                confirmOrder: permissionValidator.orderSystem.order.confirmOrder(),\n                applyRefund: permissionValidator.orderSystem.order.applyRefund(),\n                changeExtraAmount: permissionValidator.orderSystem.order.changeExtraAmount(),\n                changeExtraCost: permissionValidator.orderSystem.order.changeExtraCost(),\n            },\n            showInvoiceInfoDialog: false,\n            dataForProductDetailDialog: {\n                show: false,\n                detail: {\n                    name: \'\',\n                    quantity: \'\',\n                    size: \'\',\n                    caizhi: \'\',\n                    others:\'\',\n                }\n            },\n            dataForEditExtraAmountDialog: {\n                show: false,\n                data: {\n                    orderId: \'\',\n                    minExtraAmount: \'\',\n                    extraAmount: \'\',\n                    extraAmountRemark: \'\',\n                },\n            },\n            dataForEditExtraCostDialog: {\n                show: false,\n                data: {\n                    orderId: \'\',\n                    extra_cost: \'\',\n                    extra_cost_remark: \'\',\n                },\n            },\n            dataForApplyInvoiceDialog: {\n                show: false,\n                orderIds: [],\n                invoiceInfo: {\n                    amount: \'\',\n                    content: \'\',\n                    title: \'\',\n                    zengzhishui: undefined,\n                    remark: \'\',\n                    consignee_name: \'\',\n                    consignee_phone: \'\',\n                    address: \'\',\n                },\n                maxApplyAmount: \'\',\n            },\n            dataForPayQrCodeDialog: {\n                show: false,\n                data: {\n                    orderId: \'\',\n                    amountToPay: \'\',\n                    type: \'\',\n                    qrCodeUrl: \'\',\n                },\n            },\n            dataForApplyRefundDialog: {\n                show: false,\n                data: {\n                    orderId: \'\',\n                    refundAmount: \'\',\n                    refundMethod: \'\',\n                    refundAccount: \'\',\n                    refundName: \'\',\n                    refundReason: \'\',\n                    maxRefundValue: \'\',\n                },\n            },\n            dataForPopupDialog: {\n                show: false,\n                title: \'删除确认\',\n                content: \'\',\n            },\n        }\n    },\n    computed: {\n        canCancel() {\n            if (this.orderId && this.permissionList.cancelOrder) {\n                if (this.orderBasic.status == \'SUBMITTED\' || this.orderBasic.status == \'ONLINE_PAID\') {\n                    return true;\n                }\n            }\n            return false;\n        },\n        canFinish() {\n            if (this.orderId && this.permissionList.finishOrder) {\n                var flag = true;\n                for (let i = 0; i < this.orderItems.length; i++) {\n                    if (this.orderItems[i].produce_status !== \'COMPLETE\') {\n                        flag = false;\n                        break;\n                    }\n                }\n                if (flag && (this.orderBasic.status == \'DELIVERY_PAID\' || this.orderBasic.status == \'ONLINE_CONFIRMED\')) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        canConfirm() {\n            if (this.orderId && this.permissionList.confirmOrder) {\n                if ((this.orderBasic.status === \'SUBMITTED\' && this.paymentData.payment === \'CASH_ON_DELIVERY\' && this.orderBasic.is_priced) || (this.orderBasic.status === \'ONLINE_PAID\')) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        isOrderProfitSure() {\n            if (this.orderId) {\n                if (!this.orderBasic.is_priced) {\n                    return false;\n                }\n                for (let i = 0; i < this.orderItems.length; i++) {\n                    if (this.orderItems[i].cost === 0) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return false;\n        },\n        isProductCostSure() {\n            if (this.orderId) {\n                for (let i = 0; i < this.orderItems.length; i++) {\n                    if (this.orderItems[i].cost === 0) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return false;\n        },\n        canChangeExtraAmount() {\n            if (this.orderId && this.permissionList.changeExtraAmount) {\n                if (this.orderBasic.status == \'SUBMITTED\' || this.orderBasic.status == \'DELIVERY_CONFIRMED\') {\n                    return true;\n                }\n            }\n            return false;\n        },\n        canChangeExtraCost() {\n            if (this.orderId && this.permissionList.changeExtraCost) {\n                if (this.orderBasic.status != \'FINISHED\' && this.orderBasic.status != \'CANCELED\') {\n                    return true;\n                }\n            }\n            return false;\n        },\n        canApplyInvoice() {\n            if (this.orderId && this.permissionList.applyInvoice) {\n                if (this.orderBasic.status == \'DELIVERY_CONFIRMED\' || this.orderBasic.status == \'DELIVERY_PAID\' || this.orderBasic.status == \'ONLINE_CONFIRMED\' || this.orderBasic.status == \'FINISHED\') {\n                    if (this.orderBasic.amount + this.orderBasic.freight - this.orderBasic.invoiced_amount > 0) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        },\n        canRecordAfterSale() {\n            if (this.orderId && this.permissionList.afterSaleDeal) {\n                if (this.orderBasic.status == \'DELIVERY_CONFIRMED\' || this.orderBasic.status == \'DELIVERY_PAID\' || this.orderBasic.status == \'ONLINE_CONFIRMED\' || this.orderBasic.status == \'FINISHED\') {\n                    return true;\n                }\n            }\n            return false;\n        },\n        canApplyRefund() {\n            if (this.orderId && this.permissionList.applyRefund) {\n                if (this.paymentData.paid_amount > this.orderBasic.refunded_amount) {\n                    return true;\n                }\n            }\n            return false;\n        },\n    },\n    events: {\n        \'click-positive-button\'() {\n            if (this.dataForPopupDialog.dialogId === CANCEL_ORDER) {\n                this.cancelOrder();\n            } else if (this.dataForPopupDialog.dialogId === FINISH_ORDER) {\n                this.finishOrder();\n            } else if (this.dataForPopupDialog.dialogId === CONFIRM_ORDER) {\n                this.confirmOrder();\n            }\n        },\n        \'edit-extra-amount\'() {\n            location.reload();\n        },\n        \'edit-extra-cost\'() {\n            location.reload();\n        },\n        \'apply-invoice\'() {\n            location.reload();\n        },\n        \'apply-refund\'() {\n            location.reload();\n        },\n    },\n    filters: {\n        paymentFilter(payment) {\n            var paymentMap = {\n                ONLINE: \'在线支付\',\n                CASH_ON_DELIVERY: \'货到付款\',\n            }\n            return paymentMap[payment];\n        },\n    },\n    methods: {\n        getOrderDetial(id) {\n            var url = \'/api/v2/admin/orders/detail-v2?id=\' + id\n            this.$http.get(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    var order = this.preprocessData(response.data);\n                    this.orderId = id;\n                    this.orderBasic = order.basic;\n                    this.orderItems =order.items;\n                    this.consignees = order.consignees;\n                    this.paymentData = order.payment;\n                    this.invoiceInfo = order.invoice;\n                    this.orderHistories = order.histories;\n                    this.invoiceRecords = order.invoice_records;\n                    this.refundRecords = order.refunds;\n                    this.orderDate = order.time;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        showProductDetailDialog(item) {\n            this.dataForProductDetailDialog.show = true;\n            this.dataForProductDetailDialog.detail = {\n                name: item.detail.name,\n                quantity: item.detail.quantity,\n                size: item.detail.size,\n                caizhi: item.detail.caizhi,\n                others: item.detail.others,\n            }\n        },\n        showCancelOrderDialog() {\n            this.dataForPopupDialog.show = true;\n            this.dataForPopupDialog.title = "取消确认";\n            this.dataForPopupDialog.content = "确定取消此订单？";\n            this.dataForPopupDialog.dialogId = CANCEL_ORDER;\n        },\n        showFinishOrderDialog() {\n            this.dataForPopupDialog.show = true;\n            this.dataForPopupDialog.title = "完成确认";\n            this.dataForPopupDialog.content = "确定完成此订单？";\n            this.dataForPopupDialog.dialogId = FINISH_ORDER;\n        },\n        showConfirmOrderDialog() {\n            this.dataForPopupDialog.show = true;\n            this.dataForPopupDialog.title = "确认确认";\n            this.dataForPopupDialog.content = "确定确认此订单？";\n            this.dataForPopupDialog.dialogId = CONFIRM_ORDER;\n        },\n        cancelOrder() {\n            var url = \'/api/v2/admin/orders/cancel?order_id=\' + this.orderId;\n            this.$http.delete(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    location.reload();\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        finishOrder() {\n            var url = \'/api/v2/admin/orders/complete?order_id=\' + this.orderId;\n            this.$http.put(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    location.reload();\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        confirmOrder() {\n            var url = \'/api/v2/admin/orders/confirm?order_id=\' + this.orderId;\n            this.$http.put(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    location.reload();\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        changeExtraAmount() {\n            this.dataForEditExtraAmountDialog.show = true;\n            this.dataForEditExtraAmountDialog.data.orderId = this.orderId;\n            this.dataForEditExtraAmountDialog.data.minExtraAmount = this.orderBasic.is_priced ? this.paymentData.paid_amount - this.orderBasic.amount : 0;\n            this.dataForEditExtraAmountDialog.data.extraAmount = this.orderBasic.freight;\n            this.dataForEditExtraAmountDialog.data.extraAmountRemark = this.orderBasic.freight_remark;\n        },\n        changeExtraCost() {\n            this.dataForEditExtraCostDialog.show = true;\n            this.dataForEditExtraCostDialog.data.orderId = this.orderId;\n            this.dataForEditExtraCostDialog.data.extra_cost = this.orderBasic.extra_cost;\n            this.dataForEditExtraCostDialog.data.extra_cost_remark = this.orderBasic.extra_cost_remark;\n        },\n        clickToApplyInvoice() {\n            this.dataForApplyInvoiceDialog.show = true;\n            this.dataForApplyInvoiceDialog.orderIds = [this.orderId];\n            this.dataForApplyInvoiceDialog.maxApplyAmount = this.orderBasic.amount + this.orderBasic.freight - this.orderBasic.invoiced_amount;\n            if (this.invoiceInfo) {\n                this.dataForApplyInvoiceDialog.invoiceInfo = {\n                    amount: this.invoiceInfo.amount,\n                    content: this.invoiceInfo.content,\n                    title: this.invoiceInfo.title,\n                    remark: this.invoiceInfo.remark,\n                    consignee_name: this.invoiceInfo.consignee_name,\n                    consignee_phone: this.invoiceInfo.consignee_phone,\n                    address: this.invoiceInfo.address,\n                    zengzhishui: (this.invoiceInfo.zengzhishui ? {\n                        identifier: this.invoiceInfo.zengzhishui.identifier,\n                        address: this.invoiceInfo.zengzhishui.address,\n                        phone: this.invoiceInfo.zengzhishui.phone,\n                        account: this.invoiceInfo.zengzhishui.account,\n                        bank: this.invoiceInfo.zengzhishui.bank,\n                    } : undefined),\n                };\n            } else {\n                this.dataForApplyInvoiceDialog.invoiceInfo = {\n                    amount: \'\',\n                    content: \'\',\n                    title: \'\',\n                    zengzhishui: undefined,\n                    remark: \'\',\n                    consignee_name: \'\',\n                    consignee_phone: \'\',\n                    address: \'\',\n                };\n            }\n        },\n        clickToshowInvoiceInfoDialog() {\n            this.showInvoiceInfoDialog = true;\n        },\n        showOrHideInvoiceRecordItem(recordItem) {\n            if (recordItem.showAll === undefined) {\n                Vue.set(recordItem, \'showAll\', true);\n            } else {\n                recordItem.showAll = !recordItem.showAll;\n            }\n        },\n        closeInvoiceInfoDialog() {\n            this.showInvoiceInfoDialog = false;\n        },\n        getPingxxPayCharge(type) {\n            return new Promise((resolve, reject) => {\n                var url = \'/api/v2/admin/orders/create-pingxx-charge\';\n                var data = {\n                    order_id: parseInt(this.orderId),\n                    payment: type,\n                };\n                this.$http.post(url, data)\n                .then((response) => {\n                    if (!response.data.result || response.data.result === 0) {\n                        resolve(response.data.charge);\n                    } else {\n                        callback.success(response.data);\n                        reject(response.data);\n                    }\n                }, (response) => {\n                    callback.error(response);\n                    reject(response);\n                });\n            });\n        },\n        jumpToZhifubaoPayLink() {\n            this.getPingxxPayCharge(\'ALIPAY_PC\').then((charge) => {\n                pingpp.createPayment(charge, function(result, err){\n                    if (result == "success") {\n                        // 只有微信公众账号 wx_pub 支付成功的结果会在这里返回，其他的支付结果都会跳转到 extra 中对应的 URL。\n                    } else if (result == "fail") {\n                        // charge 不正确或者微信公众账号支付失败时会在此处返回\n                        alert(\'Charge不正确!\');\n                        location.reload();\n                    } else if (result == "cancel") {\n                        // 微信公众账号支付取消支付\n                    }\n                });\n            });\n        },\n        showZhifubaoQRCodeDialog() {\n            this.getPingxxPayCharge(\'ALIPAY_QR\').then((charge) => {\n                this.dataForPayQrCodeDialog.show = true;\n                this.dataForPayQrCodeDialog.data.orderId = this.orderId;\n                this.dataForPayQrCodeDialog.data.type = \'ALIPAY_QR\';\n                this.dataForPayQrCodeDialog.data.qrCodeUrl = JSON.parse(charge).credential.alipay_qr;\n                this.dataForPayQrCodeDialog.data.amountToPay = this.orderBasic.amount + this.orderBasic.freight - this.paymentData.paid_amount;\n            });\n        },\n        showWeChatQRCodeDialog() {\n            this.getPingxxPayCharge(\'WECHAT_QR\').then((charge) => {\n                this.dataForPayQrCodeDialog.show = true;\n                this.dataForPayQrCodeDialog.data.orderId = this.orderId;\n                this.dataForPayQrCodeDialog.data.type = \'WECHAT_QR\';\n                this.dataForPayQrCodeDialog.data.qrCodeUrl = JSON.parse(charge).credential.wx_pub_qr;\n                this.dataForPayQrCodeDialog.data.amountToPay = this.orderBasic.amount + this.orderBasic.freight - this.paymentData.paid_amount;\n            });\n        },\n        clickToRecordAfterSale() {\n            //TODO\n        },\n        clickToApplyRefund() {\n            this.dataForApplyRefundDialog.show = true;\n            this.dataForApplyRefundDialog.data.orderId = this.orderId;\n            this.dataForApplyRefundDialog.data.refundAmount = \'\';\n            this.dataForApplyRefundDialog.data.refundMethod = \'\';\n            this.dataForApplyRefundDialog.data.refundAccount = \'\';\n            this.dataForApplyRefundDialog.data.refundName = \'\';\n            this.dataForApplyRefundDialog.data.refundReason = \'\';\n            this.dataForApplyRefundDialog.data.maxRefundValue = this.paymentData.paid_amount - this.orderBasic.refunded_amount;\n        },\n        preprocessData(order) {\n            var refunds = [];\n            for (let i = 0; i < order.refunds.length; i++) {\n                if (order.refunds[i].type !== \'TRANSACTION_FAILED\') {\n                    refunds.push(order.refunds[i]);\n                }\n            }\n            order.refunds = refunds;\n            return order;\n        }\n    }\n}\n</script>\n\n<style scoped>\n.product-table, .payment-records-table, .refund-records-table {\n    table-layout: fixed;\n}\n\n.product-table th, .product-table td, .payment-records-table th, .payment-records-table td, .refund-records-table th, .refund-records-table td {\n    text-align: center;\n    vertical-align: middle;\n}\n\n.product-table td .btn-link, .invoice-info .btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.product-table td .btn-link:hover, .invoice-info .btn-link:hover {\n    text-decoration: underline;\n}\n</style>'],
sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(8),o=i(a),s=n(91),r=i(s),d=n(5),l=n(75),c=i(l),p=n(70),u=i(p),v=n(115),h=i(v),f=n(118),m=i(f),b=n(123),g=i(b),_=n(128),y=i(_),A=n(133),I=i(A),D=n(138),w=i(D),x=n(46),P=n(43),C="CANCEL_ORDER",E="FINISH_ORDER",k="CONFIRM_ORDER";e.default={name:"OrderDetailView",components:{productDetailDialog:c.default,popupDialog:u.default,consigneeInfoWithLogistics:h.default,editExtraAmountDialog:m.default,editExtraCostDialog:g.default,applyInvoiceDialog:y.default,payQrCodeDialog:I.default,applyRefundDialog:w.default},route:{data:function(t){var e=t.to,n=e.params.id;n||this.$route.router.go({path:"/order/list"}),this.getOrderDetial(n)}},data:function(){return{orderId:"",orderBasic:{customer:{},creator:{}},orderItems:[],consignees:[],paymentData:{},invoiceInfo:null,orderHistories:[],invoiceRecords:[],refundRecords:[],orderDate:null,permissionList:{createOrder:P.permissionValidator.orderSystem.order.createOrder(),editOrder:P.permissionValidator.orderSystem.order.editOrder(),finishOrder:P.permissionValidator.orderSystem.order.finishOrder(),cancelOrder:P.permissionValidator.orderSystem.order.cancelOrder(),applyInvoice:P.permissionValidator.orderSystem.order.applyInvoice(),afterSaleDeal:P.permissionValidator.orderSystem.order.afterSaleDeal(),confirmOrder:P.permissionValidator.orderSystem.order.confirmOrder(),applyRefund:P.permissionValidator.orderSystem.order.applyRefund(),changeExtraAmount:P.permissionValidator.orderSystem.order.changeExtraAmount(),changeExtraCost:P.permissionValidator.orderSystem.order.changeExtraCost()},showInvoiceInfoDialog:!1,dataForProductDetailDialog:{show:!1,detail:{name:"",quantity:"",size:"",caizhi:"",others:""}},dataForEditExtraAmountDialog:{show:!1,data:{orderId:"",minExtraAmount:"",extraAmount:"",extraAmountRemark:""}},dataForEditExtraCostDialog:{show:!1,data:{orderId:"",extra_cost:"",extra_cost_remark:""}},dataForApplyInvoiceDialog:{show:!1,orderIds:[],invoiceInfo:{amount:"",content:"",title:"",zengzhishui:void 0,remark:"",consignee_name:"",consignee_phone:"",address:""},maxApplyAmount:""},dataForPayQrCodeDialog:{show:!1,data:{orderId:"",amountToPay:"",type:"",qrCodeUrl:""}},dataForApplyRefundDialog:{show:!1,data:{orderId:"",refundAmount:"",refundMethod:"",refundAccount:"",refundName:"",refundReason:"",maxRefundValue:""}},dataForPopupDialog:{show:!1,title:"删除确认",content:""}}},computed:{canCancel:function(){return!(!this.orderId||!this.permissionList.cancelOrder||"SUBMITTED"!=this.orderBasic.status&&"ONLINE_PAID"!=this.orderBasic.status)},canFinish:function(){if(this.orderId&&this.permissionList.finishOrder){for(var t=!0,e=0;e<this.orderItems.length;e++)if("COMPLETE"!==this.orderItems[e].produce_status){t=!1;break}if(t&&("DELIVERY_PAID"==this.orderBasic.status||"ONLINE_CONFIRMED"==this.orderBasic.status))return!0}return!1},canConfirm:function(){return!!(this.orderId&&this.permissionList.confirmOrder&&("SUBMITTED"===this.orderBasic.status&&"CASH_ON_DELIVERY"===this.paymentData.payment&&this.orderBasic.is_priced||"ONLINE_PAID"===this.orderBasic.status))},isOrderProfitSure:function(){if(this.orderId){if(!this.orderBasic.is_priced)return!1;for(var t=0;t<this.orderItems.length;t++)if(0===this.orderItems[t].cost)return!1;return!0}return!1},isProductCostSure:function(){if(this.orderId){for(var t=0;t<this.orderItems.length;t++)if(0===this.orderItems[t].cost)return!1;return!0}return!1},canChangeExtraAmount:function(){return!(!this.orderId||!this.permissionList.changeExtraAmount||"SUBMITTED"!=this.orderBasic.status&&"DELIVERY_CONFIRMED"!=this.orderBasic.status)},canChangeExtraCost:function(){return!(!this.orderId||!this.permissionList.changeExtraCost||"FINISHED"==this.orderBasic.status||"CANCELED"==this.orderBasic.status)},canApplyInvoice:function(){return!!(this.orderId&&this.permissionList.applyInvoice&&("DELIVERY_CONFIRMED"==this.orderBasic.status||"DELIVERY_PAID"==this.orderBasic.status||"ONLINE_CONFIRMED"==this.orderBasic.status||"FINISHED"==this.orderBasic.status)&&this.orderBasic.amount+this.orderBasic.freight-this.orderBasic.invoiced_amount>0)},canRecordAfterSale:function(){return!(!this.orderId||!this.permissionList.afterSaleDeal||"DELIVERY_CONFIRMED"!=this.orderBasic.status&&"DELIVERY_PAID"!=this.orderBasic.status&&"ONLINE_CONFIRMED"!=this.orderBasic.status&&"FINISHED"!=this.orderBasic.status)},canApplyRefund:function(){return!!(this.orderId&&this.permissionList.applyRefund&&this.paymentData.paid_amount>this.orderBasic.refunded_amount)}},events:{"click-positive-button":function(){this.dataForPopupDialog.dialogId===C?this.cancelOrder():this.dataForPopupDialog.dialogId===E?this.finishOrder():this.dataForPopupDialog.dialogId===k&&this.confirmOrder()},"edit-extra-amount":function(){location.reload()},"edit-extra-cost":function(){location.reload()},"apply-invoice":function(){location.reload()},"apply-refund":function(){location.reload()}},filters:{paymentFilter:function(t){var e={ONLINE:"在线支付",CASH_ON_DELIVERY:"货到付款"};return e[t]}},methods:{getOrderDetial:function(t){var e=this,n="/api/v2/admin/orders/detail-v2?id="+t;this.$http.get(n).then(function(n){if(n.data.result&&0!==n.data.result)x.callback.success(n.data);else{var i=e.preprocessData(n.data);e.orderId=t,e.orderBasic=i.basic,e.orderItems=i.items,e.consignees=i.consignees,e.paymentData=i.payment,e.invoiceInfo=i.invoice,e.orderHistories=i.histories,e.invoiceRecords=i.invoice_records,e.refundRecords=i.refunds,e.orderDate=i.time}},function(t){x.callback.error(t)})},showProductDetailDialog:function(t){this.dataForProductDetailDialog.show=!0,this.dataForProductDetailDialog.detail={name:t.detail.name,quantity:t.detail.quantity,size:t.detail.size,caizhi:t.detail.caizhi,others:t.detail.others}},showCancelOrderDialog:function(){this.dataForPopupDialog.show=!0,this.dataForPopupDialog.title="取消确认",this.dataForPopupDialog.content="确定取消此订单？",this.dataForPopupDialog.dialogId=C},showFinishOrderDialog:function(){this.dataForPopupDialog.show=!0,this.dataForPopupDialog.title="完成确认",this.dataForPopupDialog.content="确定完成此订单？",this.dataForPopupDialog.dialogId=E},showConfirmOrderDialog:function(){this.dataForPopupDialog.show=!0,this.dataForPopupDialog.title="确认确认",this.dataForPopupDialog.content="确定确认此订单？",this.dataForPopupDialog.dialogId=k},cancelOrder:function(){var t="/api/v2/admin/orders/cancel?order_id="+this.orderId;this.$http.delete(t).then(function(t){t.data.result&&0!==t.data.result?x.callback.success(t.data):location.reload()},function(t){x.callback.error(t)})},finishOrder:function(){var t="/api/v2/admin/orders/complete?order_id="+this.orderId;this.$http.put(t).then(function(t){t.data.result&&0!==t.data.result?x.callback.success(t.data):location.reload()},function(t){x.callback.error(t)})},confirmOrder:function(){var t="/api/v2/admin/orders/confirm?order_id="+this.orderId;this.$http.put(t).then(function(t){t.data.result&&0!==t.data.result?x.callback.success(t.data):location.reload()},function(t){x.callback.error(t)})},changeExtraAmount:function(){this.dataForEditExtraAmountDialog.show=!0,this.dataForEditExtraAmountDialog.data.orderId=this.orderId,this.dataForEditExtraAmountDialog.data.minExtraAmount=this.orderBasic.is_priced?this.paymentData.paid_amount-this.orderBasic.amount:0,this.dataForEditExtraAmountDialog.data.extraAmount=this.orderBasic.freight,this.dataForEditExtraAmountDialog.data.extraAmountRemark=this.orderBasic.freight_remark},changeExtraCost:function(){this.dataForEditExtraCostDialog.show=!0,this.dataForEditExtraCostDialog.data.orderId=this.orderId,this.dataForEditExtraCostDialog.data.extra_cost=this.orderBasic.extra_cost,this.dataForEditExtraCostDialog.data.extra_cost_remark=this.orderBasic.extra_cost_remark},clickToApplyInvoice:function(){this.dataForApplyInvoiceDialog.show=!0,this.dataForApplyInvoiceDialog.orderIds=[this.orderId],this.dataForApplyInvoiceDialog.maxApplyAmount=this.orderBasic.amount+this.orderBasic.freight-this.orderBasic.invoiced_amount,this.invoiceInfo?this.dataForApplyInvoiceDialog.invoiceInfo={amount:this.invoiceInfo.amount,content:this.invoiceInfo.content,title:this.invoiceInfo.title,remark:this.invoiceInfo.remark,consignee_name:this.invoiceInfo.consignee_name,consignee_phone:this.invoiceInfo.consignee_phone,address:this.invoiceInfo.address,zengzhishui:this.invoiceInfo.zengzhishui?{identifier:this.invoiceInfo.zengzhishui.identifier,address:this.invoiceInfo.zengzhishui.address,phone:this.invoiceInfo.zengzhishui.phone,account:this.invoiceInfo.zengzhishui.account,bank:this.invoiceInfo.zengzhishui.bank}:void 0}:this.dataForApplyInvoiceDialog.invoiceInfo={amount:"",content:"",title:"",zengzhishui:void 0,remark:"",consignee_name:"",consignee_phone:"",address:""}},clickToshowInvoiceInfoDialog:function(){this.showInvoiceInfoDialog=!0},showOrHideInvoiceRecordItem:function(t){void 0===t.showAll?o.default.set(t,"showAll",!0):t.showAll=!t.showAll},closeInvoiceInfoDialog:function(){this.showInvoiceInfoDialog=!1},getPingxxPayCharge:function(t){var e=this;return new d.Promise(function(n,i){var a="/api/v2/admin/orders/create-pingxx-charge",o={order_id:parseInt(e.orderId),payment:t};e.$http.post(a,o).then(function(t){t.data.result&&0!==t.data.result?(x.callback.success(t.data),i(t.data)):n(t.data.charge)},function(t){x.callback.error(t),i(t)})})},jumpToZhifubaoPayLink:function(){this.getPingxxPayCharge("ALIPAY_PC").then(function(t){r.default.createPayment(t,function(t,e){"success"==t||"fail"==t&&(alert("Charge不正确!"),location.reload())})})},showZhifubaoQRCodeDialog:function(){var t=this;this.getPingxxPayCharge("ALIPAY_QR").then(function(e){t.dataForPayQrCodeDialog.show=!0,t.dataForPayQrCodeDialog.data.orderId=t.orderId,t.dataForPayQrCodeDialog.data.type="ALIPAY_QR",t.dataForPayQrCodeDialog.data.qrCodeUrl=JSON.parse(e).credential.alipay_qr,t.dataForPayQrCodeDialog.data.amountToPay=t.orderBasic.amount+t.orderBasic.freight-t.paymentData.paid_amount})},showWeChatQRCodeDialog:function(){var t=this;this.getPingxxPayCharge("WECHAT_QR").then(function(e){t.dataForPayQrCodeDialog.show=!0,t.dataForPayQrCodeDialog.data.orderId=t.orderId,t.dataForPayQrCodeDialog.data.type="WECHAT_QR",t.dataForPayQrCodeDialog.data.qrCodeUrl=JSON.parse(e).credential.wx_pub_qr,t.dataForPayQrCodeDialog.data.amountToPay=t.orderBasic.amount+t.orderBasic.freight-t.paymentData.paid_amount})},clickToRecordAfterSale:function(){},clickToApplyRefund:function(){this.dataForApplyRefundDialog.show=!0,this.dataForApplyRefundDialog.data.orderId=this.orderId,this.dataForApplyRefundDialog.data.refundAmount="",this.dataForApplyRefundDialog.data.refundMethod="",this.dataForApplyRefundDialog.data.refundAccount="",this.dataForApplyRefundDialog.data.refundName="",this.dataForApplyRefundDialog.data.refundReason="",this.dataForApplyRefundDialog.data.maxRefundValue=this.paymentData.paid_amount-this.orderBasic.refunded_amount},preprocessData:function(t){for(var e=[],n=0;n<t.refunds.length;n++)"TRANSACTION_FAILED"!==t.refunds[n].type&&e.push(t.refunds[n]);return t.refunds=e,t}}}},function(t,e,n){var i=n(92).v,a=n(93),o=n(95),s=n(96),r=n(108),d=n(112),l={}.hasOwnProperty,c=function(){n(114).init()};c.prototype={version:i,createPayment:function(t,e,n,i){"function"==typeof e&&(o.userCallback=e);var c;if("string"==typeof t)try{c=JSON.parse(t)}catch(t){return void o.innerCallback("fail",o.error("json_decode_fail",t))}else c=t;if("undefined"==typeof c)return void o.innerCallback("fail",o.error("json_decode_fail"));if(!l.call(c,"id"))return void o.innerCallback("fail",o.error("invalid_charge","no_charge_id"));if(!l.call(c,"channel"))return void o.innerCallback("fail",o.error("invalid_charge","no_channel"));l.call(c,"app")&&("string"==typeof c.app?r.app_id=c.app:"object"==typeof c.app&&"string"==typeof c.app.id&&(r.app_id=c.app.id)),d.report({type:"pure_sdk_click",channel:c.channel,ch_id:c.id});var p=c.channel;if(!l.call(c,"credential"))return void o.innerCallback("fail",o.error("invalid_charge","no_credential"));if(!c.credential)return void o.innerCallback("fail",o.error("invalid_credential","credential_is_undefined"));if(!l.call(c.credential,p))return void o.innerCallback("fail",o.error("invalid_credential","credential_is_incorrect"));if(!l.call(c,"livemode"))return void o.innerCallback("fail",o.error("invalid_charge","no_livemode_field"));var u=s.getChannelModule(p);return"undefined"==typeof u?(console.error('channel module "'+p+'" is undefined'),void o.innerCallback("fail",o.error("invalid_channel",'channel module "'+p+'" is undefined'))):c.livemode===!1?void(l.call(u,"runTestMode")?u.runTestMode(c):a.runTestMode(c)):("undefined"!=typeof n&&(r.signature=n),"boolean"==typeof i&&(r.debug=i),void u.handleCharge(c))},setAPURL:function(t){r.APURL=t}},t.exports=new c},function(t,e){t.exports={v:"2.1.5"}},function(t,e,n){var i=n(94),a={}.hasOwnProperty;t.exports={PINGPP_MOCK_URL:"http://sissi.pingxx.com/mock.php",runTestMode:function(t){var e={ch_id:t.id,scheme:"http",channel:t.channel};a.call(t,"order_no")?e.order_no=t.order_no:a.call(t,"orderNo")&&(e.order_no=t.orderNo),a.call(t,"time_expire")?e.time_expire=t.time_expire:a.call(t,"timeExpire")&&(e.time_expire=t.timeExpire),a.call(t,"extra")&&(e.extra=encodeURIComponent(JSON.stringify(t.extra))),i.redirectTo(this.PINGPP_MOCK_URL+"?"+i.stringifyData(e))}}},function(t,e){var n={}.hasOwnProperty,i=t.exports={stringifyData:function(t,e,i){"undefined"==typeof i&&(i=!1);var a=[];for(var o in t)n.call(t,o)&&"function"!=typeof t[o]&&("bfb_wap"==e&&"url"==o||"yeepay_wap"==e&&"mode"==o||"channel_url"!=o&&a.push(o+"="+(i?encodeURIComponent(t[o]):t[o])));return a.join("&")},request:function(t,e,a,o,s,r){if("undefined"==typeof XMLHttpRequest)return void console.log("Function XMLHttpRequest is undefined.");var d=new XMLHttpRequest;if("undefined"!=typeof d.timeout&&(d.timeout=6e3),e=e.toUpperCase(),"GET"===e&&"object"==typeof a&&a&&(t+="?"+i.stringifyData(a,"",!0)),d.open(e,t,!0),"undefined"!=typeof r)for(var l in r)n.call(r,l)&&d.setRequestHeader(l,r[l]);"POST"===e?(d.setRequestHeader("Content-type","application/json; charset=utf-8"),d.send(JSON.stringify(a))):d.send(),"undefined"==typeof o&&(o=function(){}),"undefined"==typeof s&&(s=function(){}),d.onreadystatechange=function(){4==d.readyState&&o(d.responseText,d.status,d)},d.onerror=function(t){s(d,0,t)}},formSubmit:function(t,e,i){if("undefined"==typeof window)return void console.log("Not a browser, form submit url: "+t);var a=document.createElement("form");a.setAttribute("method",e),a.setAttribute("action",t);for(var o in i)if(n.call(i,o)){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name",o),s.setAttribute("value",i[o]),a.appendChild(s)}document.body.appendChild(a),a.submit()},randomString:function(t){"undefined"==typeof t&&(t=32);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e.length,i="",a=0;a<t;a++)i+=e.charAt(Math.floor(Math.random()*n));return i},redirectTo:function(t){return"undefined"==typeof window?void console.log("Not a browser, redirect url: "+t):void(window.location.href=t)},inWeixin:function(){if("undefined"==typeof navigator)return!1;var t=navigator.userAgent.toLowerCase();return t.indexOf("micromessenger")!==-1},documentReady:function(t){return"undefined"==typeof document?void t():void("loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t))}}},function(t,e){t.exports={userCallback:void 0,innerCallback:function(t,e){"function"==typeof this.userCallback&&("undefined"==typeof e&&(e=this.error()),this.userCallback(t,e),this.userCallback=void 0)},error:function(t,e){return t="undefined"==typeof t?"":t,e="undefined"==typeof e?"":e,{msg:t,extra:e}}}},function(t,e,n){var i={}.hasOwnProperty,a={};t.exports=a,a.channels={alipay_pc_direct:n(97),alipay_wap:n(98),bfb_wap:n(99),cp_b2b:n(100),fqlpay_qr:n(101),fqlpay_wap:n(103),jdpay_wap:n(104),upacp_pc:n(105),upacp_wap:n(106),wx_pub:n(107),wx_wap:n(109),yeepay_wap:n(110)},a.extras={ap:n(111)},a.getChannelModule=function(t){if(i.call(a.channels,t))return a.channels[t]},a.getExtraModule=function(t){if(i.call(a.extras,t))return a.extras[t]}},function(t,e,n){var i=n(94),a={}.hasOwnProperty;t.exports={ALIPAY_PC_DIRECT_URL:"https://mapi.alipay.com/gateway.do",handleCharge:function(t){var e=t.channel,n=t.credential[e],o=this.ALIPAY_PC_DIRECT_URL;a.call(n,"channel_url")&&(o=n.channel_url),a.call(n,"_input_charset")||(n._input_charset="utf-8");var s=i.stringifyData(n,e,!0);i.redirectTo(o+"?"+s)}}},function(t,e,n){var i=n(94),a=n(96),o={}.hasOwnProperty;t.exports={ALIPAY_WAP_URL_OLD:"https://wappaygw.alipay.com/service/rest.htm",ALIPAY_WAP_URL:"https://mapi.alipay.com/gateway.do",handleCharge:function(t){var e=t.channel,n=t.credential[e],s=this.ALIPAY_WAP_URL;o.call(n,"req_data")?s=this.ALIPAY_WAP_URL_OLD:o.call(n,"channel_url")&&(s=n.channel_url),o.call(n,"_input_charset")||(n._input_charset="utf-8");var r=i.stringifyData(n,e,!0),d=s+"?"+r,l=a.getExtraModule("ap");i.inWeixin()&&"undefined"!=typeof l?l.pay(d):i.redirectTo(d)}}},function(t,e,n){var i=n(94),a=n(95),o={}.hasOwnProperty;t.exports={handleCharge:function(t){var e=t.channel,n=t.credential[e];return o.call(n,"url")?void i.redirectTo(n.url+"?"+i.stringifyData(n,e)):void a.innerCallback("fail",a.error("invalid_credential","missing_field:url"))}}},function(t,e,n){var i=n(94);t.exports={CP_B2B_URL:"https://payment.chinapay.com/CTITS/service/rest/page/nref/000000000017/0/0/0/0/0",handleCharge:function(t){var e=t.credential[t.channel];i.formSubmit(this.CP_B2B_URL,"post",e)}}},function(t,e,n){var i=n(102);t.exports={handleCharge:function(t){i.handleCharge(t)}}},function(t,e,n){var i=n(94),a=n(95),o={}.hasOwnProperty;t.exports={handleCharge:function(t){var e,n=t.credential[t.channel];if("string"==typeof n)e=n;else{if(!o.call(n,"url"))return void a.innerCallback("fail",a.error("invalid_credential","credential format is incorrect"));e=n.url}i.redirectTo(e)}}},function(t,e,n){var i=n(102);t.exports={handleCharge:function(t){i.handleCharge(t)}}},function(t,e,n){var i=n(94),a={}.hasOwnProperty;t.exports={JDPAY_WAP_URL_OLD:"https://m.jdpay.com/wepay/web/pay",JDPAY_H5_URL:"https://h5pay.jd.com/jdpay/saveOrder",JDPAY_PC_URL:"https://wepay.jd.com/jdpay/saveOrder",handleCharge:function(t){var e=t.credential[t.channel],n=this.JDPAY_H5_URL;a.call(e,"channelUrl")?(n=e.channelUrl,delete e.channelUrl):a.call(e,"merchantRemark")&&(n=this.JDPAY_WAP_URL_OLD),i.formSubmit(n,"post",e)}}},function(t,e,n){var i=n(94);t.exports={UPACP_PC_URL:"https://gateway.95516.com/gateway/api/frontTransReq.do",handleCharge:function(t){var e=t.credential[t.channel];i.formSubmit(this.UPACP_PC_URL,"post",e)}}},function(t,e,n){var i=n(94);t.exports={UPACP_WAP_URL:"https://gateway.95516.com/gateway/api/frontTransReq.do",handleCharge:function(t){var e=t.credential[t.channel];i.formSubmit(this.UPACP_WAP_URL,"post",e)}}},function(t,e,n){var i=n(95),a=n(94),o=n(108),s=n(96),r={}.hasOwnProperty;t.exports={PINGPP_NOTIFY_URL_BASE:"https://api.pingxx.com/notify/charges/",handleCharge:function(t){for(var e=t.credential[t.channel],n=["appId","timeStamp","nonceStr","package","signType","paySign"],a=0;a<n.length;a++)if(!r.call(e,n[a]))return void i.innerCallback("fail",i.error("invalid_credential","missing_field_"+n[a]));o.jsApiParameters=e,this.callpay()},callpay:function(){var t=this,e=s.getExtraModule("wx_jssdk");if("undefined"!=typeof e&&e.jssdkEnabled())e.callpay();else if("undefined"==typeof WeixinJSBridge){var n=function(){t.jsApiCall()};document.addEventListener?document.addEventListener("WeixinJSBridgeReady",n,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",n),document.attachEvent("onWeixinJSBridgeReady",n))}else this.jsApiCall()},jsApiCall:function(){r.call(o,"jsApiParameters")&&WeixinJSBridge.invoke("getBrandWCPayRequest",o.jsApiParameters,function(t){delete o.jsApiParameters,"get_brand_wcpay_request:ok"==t.err_msg?i.innerCallback("success"):"get_brand_wcpay_request:cancel"==t.err_msg?i.innerCallback("cancel"):i.innerCallback("fail",i.error("wx_result_fail",t.err_msg))})},runTestMode:function(t){var e=confirm("模拟付款？");e&&a.request(this.PINGPP_NOTIFY_URL_BASE+t.id+"?livemode=false","GET",null,function(t,e){if(e>=200&&e<400&&"success"==t)i.innerCallback("success");else{var n="http_code:"+e+";response:"+t;i.innerCallback("fail",i.error("testmode_notify_fail",n))}},function(){i.innerCallback("fail",i.error("network_err"))})}}},function(t,e){t.exports={}},function(t,e,n){var i=n(94),a=n(95),o={}.hasOwnProperty;t.exports={handleCharge:function(t){var e=t.credential[t.channel];"string"==typeof e?i.redirectTo(e):"object"==typeof e&&o.call(e,"url")?i.redirectTo(e.url):a.innerCallback("fail",a.error("invalid_credential","credential 格式不正确"))}}},function(t,e,n){var i=n(94),a=n(95),o={}.hasOwnProperty;t.exports={YEEPAY_WAP_URL:"https://ok.yeepay.com/paymobile/api/pay/request",YEEPAY_WAP_TEST_URL:"http://mobiletest.yeepay.com/paymobile/api/pay/request",handleCharge:function(t){for(var e=t.channel,n=t.credential[e],s=["merchantaccount","encryptkey","data"],r=0;r<s.length;r++)if(!o.call(n,s[r]))return void a.innerCallback("fail",a.error("invalid_credential","missing_field_"+s[r]));var d;d=o.call(n,"mode")&&"test"==n.mode?this.YEEPAY_WAP_TEST_URL:this.YEEPAY_WAP_URL,i.redirectTo(d+"?"+i.stringifyData(n,e,!0))}}},function(t,e,n){var i=n(108),a={}.hasOwnProperty;!function(){var e={},n={};n.PADCHAR="=",n.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n.makeDOMException=function(){try{return new DOMException(DOMException.INVALID_CHARACTER_ERR)}catch(e){var t=new Error("DOM Exception 5");return t.code=t.number=5,t.name=t.description="INVALID_CHARACTER_ERR",t.toString=function(){return"Error: "+t.name+": "+t.message},t}},n.getbyte64=function(t,e){var i=n.ALPHA.indexOf(t.charAt(e));if(i===-1)throw n.makeDOMException();return i},n.decode=function(t){t=""+t;var e,i,a,o=n.getbyte64,s=t.length;if(0===s)return t;if(s%4!==0)throw n.makeDOMException();e=0,t.charAt(s-1)===n.PADCHAR&&(e=1,t.charAt(s-2)===n.PADCHAR&&(e=2),s-=4);var r=[];for(i=0;i<s;i+=4)a=o(t,i)<<18|o(t,i+1)<<12|o(t,i+2)<<6|o(t,i+3),r.push(String.fromCharCode(a>>16,a>>8&255,255&a));switch(e){case 1:a=o(t,i)<<18|o(t,i+1)<<12|o(t,i+2)<<6,r.push(String.fromCharCode(a>>16,a>>8&255));break;case 2:a=o(t,i)<<18|o(t,i+1)<<12,r.push(String.fromCharCode(a>>16))}return r.join("")},n.getbyte=function(t,e){var i=t.charCodeAt(e);if(i>255)throw n.makeDOMException();return i},n.encode=function(t){if(1!==arguments.length)throw new SyntaxError("Not enough arguments");var e,i,a=n.PADCHAR,o=n.ALPHA,s=n.getbyte,r=[];t=""+t;var d=t.length-t.length%3;if(0===t.length)return t;for(e=0;e<d;e+=3)i=s(t,e)<<16|s(t,e+1)<<8|s(t,e+2),r.push(o.charAt(i>>18)),r.push(o.charAt(i>>12&63)),r.push(o.charAt(i>>6&63)),r.push(o.charAt(63&i));switch(t.length-d){case 1:i=s(t,e)<<16,r.push(o.charAt(i>>18)+o.charAt(i>>12&63)+a+a);break;case 2:i=s(t,e)<<16|s(t,e+1)<<8,r.push(o.charAt(i>>18)+o.charAt(i>>12&63)+o.charAt(i>>6&63)+a)}return r.join("")},e.url="pay.htm",e.pay=function(t){var o=encodeURIComponent(n.encode(t));a.call(i,"APURL")&&(e.url=i.APURL),location.href=e.url+"?goto="+o},e.decode=function(t){return n.decode(decodeURIComponent(t))},t.exports=e}()},function(t,e,n){var i=n(94),a=n(108),o=n(113),s={seperator:"###",limit:1,report_url:"https://statistics.pingxx.com/one_stats",timeout:100},r=function(t,e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),i=t.substr(0).match(n);return null!==i?unescape(i[2]):null},d=function(){return navigator.userAgent},l=function(){return window.location.host};s.store=function(t){if("undefined"!=typeof localStorage&&null!==localStorage){var e=this,n={};n.app_id=t.app_id||a.app_id||"app_not_defined",n.ch_id=t.ch_id||"",n.channel=t.channel||"",n.type=t.type||"",n.user_agent=d(),n.host=l(),n.time=(new Date).getTime(),n.puid=a.puid;var i="app_id="+n.app_id+"&channel="+n.channel+"&ch_id="+n.ch_id+"&host="+n.host+"&time="+n.time+"&type="+n.type+"&user_agent="+n.user_agent+"&puid="+n.puid,o=i;null!==localStorage.getItem("PPP_ONE_STATS")&&0!==localStorage.getItem("PPP_ONE_STATS").length&&(o=localStorage.getItem("PPP_ONE_STATS")+e.seperator+i);try{localStorage.setItem("PPP_ONE_STATS",o)}catch(t){}}},s.send=function(){if("undefined"!=typeof localStorage&&null!==localStorage){var t=this,e=localStorage.getItem("PPP_ONE_STATS");if(!(null===e||e.split(t.seperator).length<t.limit))try{for(var n=[],a=e.split(t.seperator),s=o(a.join("&")),d=0;d<a.length;d++)n.push({app_id:r(a[d],"app_id"),channel:r(a[d],"channel"),ch_id:r(a[d],"ch_id"),host:r(a[d],"host"),time:r(a[d],"time"),type:r(a[d],"type"),user_agent:r(a[d],"user_agent"),puid:r(a[d],"puid")});i.request(t.report_url,"POST",n,function(t,e){200==e&&localStorage.removeItem("PPP_ONE_STATS")},void 0,{"X-Pingpp-Report-Token":s})}catch(t){}}},s.report=function(t){var e=this;e.store(t),setTimeout(function(){e.send()},e.timeout)},t.exports=s},function(t,e){!function(){function e(t,e){var n=(65535&t)+(65535&e),i=(t>>16)+(e>>16)+(n>>16);return i<<16|65535&n}function n(t,e){return t<<e|t>>>32-e}function i(t,i,a,o,s,r){return e(n(e(e(i,t),e(o,r)),s),a)}function a(t,e,n,a,o,s,r){return i(e&n|~e&a,t,e,o,s,r)}function o(t,e,n,a,o,s,r){return i(e&a|n&~a,t,e,o,s,r)}function s(t,e,n,a,o,s,r){return i(e^n^a,t,e,o,s,r)}function r(t,e,n,a,o,s,r){return i(n^(e|~a),t,e,o,s,r)}function d(t,n){t[n>>5]|=128<<n%32,t[(n+64>>>9<<4)+14]=n;var i,d,l,c,p,u=1732584193,v=-271733879,h=-1732584194,f=271733878;for(i=0;i<t.length;i+=16)d=u,l=v,c=h,p=f,u=a(u,v,h,f,t[i],7,-680876936),f=a(f,u,v,h,t[i+1],12,-389564586),h=a(h,f,u,v,t[i+2],17,606105819),v=a(v,h,f,u,t[i+3],22,-1044525330),u=a(u,v,h,f,t[i+4],7,-176418897),f=a(f,u,v,h,t[i+5],12,1200080426),h=a(h,f,u,v,t[i+6],17,-1473231341),v=a(v,h,f,u,t[i+7],22,-45705983),u=a(u,v,h,f,t[i+8],7,1770035416),f=a(f,u,v,h,t[i+9],12,-1958414417),h=a(h,f,u,v,t[i+10],17,-42063),v=a(v,h,f,u,t[i+11],22,-1990404162),u=a(u,v,h,f,t[i+12],7,1804603682),f=a(f,u,v,h,t[i+13],12,-40341101),h=a(h,f,u,v,t[i+14],17,-1502002290),v=a(v,h,f,u,t[i+15],22,1236535329),u=o(u,v,h,f,t[i+1],5,-165796510),f=o(f,u,v,h,t[i+6],9,-1069501632),h=o(h,f,u,v,t[i+11],14,643717713),v=o(v,h,f,u,t[i],20,-373897302),u=o(u,v,h,f,t[i+5],5,-701558691),f=o(f,u,v,h,t[i+10],9,38016083),h=o(h,f,u,v,t[i+15],14,-660478335),v=o(v,h,f,u,t[i+4],20,-405537848),u=o(u,v,h,f,t[i+9],5,568446438),f=o(f,u,v,h,t[i+14],9,-1019803690),h=o(h,f,u,v,t[i+3],14,-187363961),v=o(v,h,f,u,t[i+8],20,1163531501),u=o(u,v,h,f,t[i+13],5,-1444681467),f=o(f,u,v,h,t[i+2],9,-51403784),h=o(h,f,u,v,t[i+7],14,1735328473),v=o(v,h,f,u,t[i+12],20,-1926607734),u=s(u,v,h,f,t[i+5],4,-378558),f=s(f,u,v,h,t[i+8],11,-2022574463),h=s(h,f,u,v,t[i+11],16,1839030562),v=s(v,h,f,u,t[i+14],23,-35309556),u=s(u,v,h,f,t[i+1],4,-1530992060),f=s(f,u,v,h,t[i+4],11,1272893353),h=s(h,f,u,v,t[i+7],16,-155497632),v=s(v,h,f,u,t[i+10],23,-1094730640),u=s(u,v,h,f,t[i+13],4,681279174),f=s(f,u,v,h,t[i],11,-358537222),h=s(h,f,u,v,t[i+3],16,-722521979),v=s(v,h,f,u,t[i+6],23,76029189),u=s(u,v,h,f,t[i+9],4,-640364487),f=s(f,u,v,h,t[i+12],11,-421815835),h=s(h,f,u,v,t[i+15],16,530742520),v=s(v,h,f,u,t[i+2],23,-995338651),u=r(u,v,h,f,t[i],6,-198630844),f=r(f,u,v,h,t[i+7],10,1126891415),h=r(h,f,u,v,t[i+14],15,-1416354905),v=r(v,h,f,u,t[i+5],21,-57434055),u=r(u,v,h,f,t[i+12],6,1700485571),f=r(f,u,v,h,t[i+3],10,-1894986606),h=r(h,f,u,v,t[i+10],15,-1051523),v=r(v,h,f,u,t[i+1],21,-2054922799),u=r(u,v,h,f,t[i+8],6,1873313359),f=r(f,u,v,h,t[i+15],10,-30611744),h=r(h,f,u,v,t[i+6],15,-1560198380),v=r(v,h,f,u,t[i+13],21,1309151649),u=r(u,v,h,f,t[i+4],6,-145523070),f=r(f,u,v,h,t[i+11],10,-1120210379),h=r(h,f,u,v,t[i+2],15,718787259),v=r(v,h,f,u,t[i+9],21,-343485551),u=e(u,d),v=e(v,l),h=e(h,c),f=e(f,p);return[u,v,h,f]}function l(t){var e,n="";for(e=0;e<32*t.length;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function c(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;for(e=0;e<8*t.length;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function p(t){return l(d(c(t),8*t.length))}function u(t,e){var n,i,a=c(t),o=[],s=[];for(o[15]=s[15]=void 0,a.length>16&&(a=d(a,8*t.length)),n=0;n<16;n+=1)o[n]=909522486^a[n],s[n]=1549556828^a[n];return i=d(o.concat(c(e)),512+8*e.length),l(d(s.concat(i),640))}function v(t){var e,n,i="0123456789abcdef",a="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),a+=i.charAt(e>>>4&15)+i.charAt(15&e);return a}function h(t){return unescape(encodeURIComponent(t))}function f(t){return p(h(t))}function m(t){return v(f(t))}function b(t,e){return u(h(t),h(e))}function g(t,e){return v(b(t,e))}function _(t,e,n){return e?n?b(e,t):g(e,t):n?f(t):m(t)}t.exports=_}()},function(t,e,n){var i=n(108),a=n(94),o=n(112);t.exports={SRC_URL:"https://cookie.pingxx.com",init:function(){var t=this;a.documentReady(function(){t.initPuid()})},initPuid:function(){if("undefined"!=typeof window&&"undefined"!=typeof localStorage){var t=localStorage.getItem("pingpp_uid");if(null===t){t=a.randomString();try{localStorage.setItem("pingpp_uid",t)}catch(t){}}if(i.puid=t,!document.getElementById("p_analyse_iframe")){var e=document.createElement("iframe");e.id="p_analyse_iframe",e.src=this.SRC_URL+"/?puid="+t,e.style.display="none",document.body.appendChild(e)}setTimeout(function(){o.send()},0)}}}},function(t,e,n){var i,a;i=n(116),a=n(117),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"ConsigneeInfoWithLogisticsView",props:["consigneeItem","canAddLogistics","index"],data:function(){return{}},methods:{clickToAddLogistics:function(){this.$dispatch("click-to-add-logistics",this.consigneeItem)}}}},function(t,e){t.exports=' <div class="panel panel-default"> <div class=panel-body> <div class=row> <div class=col-lg-6> <h4>收货人{{index + 1}}</h4> <div class=row style="margin: 0"> <label class=pull-left>收货人姓名：</label> <p class=pull-left style="width: 80%">{{consigneeItem.name}}</p> </div> <div class=row style="margin: 0"> <label class=pull-left>手机号码：</label> <p class=pull-left style="width: 80%">{{consigneeItem.phone}}</p> </div> <div class=row style="margin: 0"> <label class=pull-left>收货地址：</label> <p class=pull-left style="width: 80%">{{consigneeItem.full_address}}</p> </div> <div class=row style="margin: 0" v-if=consigneeItem.post_code> <label class=pull-left>邮编：</label> <p class=pull-left style="width: 80%">{{consigneeItem.post_code}}</p> </div> <div class=row style="margin: 0" v-if=consigneeItem.remark> <label class=pull-left>收货备注：</label> <p class=pull-left style="width: 80%">{{consigneeItem.remark}}</p> </div> </div> <div class=col-lg-6> <a class="pull-right btn btn-info btn-sm" v-if=canAddLogistics @click=clickToAddLogistics>录入</a> <h4>物流信息</h4> <p v-if="consigneeItem.logistics.length === 0">未发货，暂无物流信息</p> <template v-else> <div class=row style="margin: 0" v-for="item of consigneeItem.logistics"> <p class=pull-left>{{$index + 1}}、</p> <p class=pull-left style="width: 90%">{{item.delivery_method}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{item.express}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{item.express_order_id}}<br>{{item.cost | realPrice}}元&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{item.create_time | dateFormat}}录入<br>{{item.remark}}</p> </div> </template> </div> </div> </div> </div> '},function(t,e,n){var i,a;n(119),i=n(121),a=n(122),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(120);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-8acd7194]{height:100%}.modal-dialog[_v-8acd7194]{top:30%}","",{version:3,sources:["/./src/views/order/comp/editExtraAmountDialog.vue.style"],names:[],mappings:"AA2GA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"editExtraAmountDialog.vue",sourcesContent:['<!-- editExtraAmountDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n    \t<div class="modal-dialog" style="width:400px;">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">订单补充金额</h4>\n                </div>\n                <div class="modal-body">\n                    <h5>补充金额必须大于{{data.minExtraAmount | realPrice}}元</h5>\n                \t<form class="form-horizontal">\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-4 control-label" for="extraAmount">补充金额<span class="text-danger">*</span>：</label>\n\t\t                    <div class="col-lg-8">\n\t\t                        <input class="form-control input-sm" id="extraAmount" type="text" v-model="data.extraAmount | priceFilter">\n\t\t                    </div>\n\t\t                </div>\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-4 control-label" for="extraAmountRemark">备注：</label>\n\t\t                    <div class="col-lg-8">\n\t\t                        <input class="form-control input-sm" id="extraAmountRemark" type="text" v-model="data.extraAmountRemark">\n\t\t                    </div>\n\t\t                </div>\n\t\t            </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'EditExtraAmountDialogView\',\n    components: {\n        popupTips,\n    },\n    props: [\'show\', \'data\'],\n    data() {\n        return {\n        \tbuttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    methods: {\n    \tvalidateExtraAmount() {\n            var result = orderValidator.validateExtraAmount(this.data.extraAmount, this.data.minExtraAmount);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                this.editExtraAmount();\n            }\n        },\n    \teditExtraAmount() {\n            var result = this.validateExtraAmount();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var data = {\n                freight: this.data.extraAmount,\n                freight_remark: this.data.extraAmountRemark,\n            };\n            var url = \'/api/v2/admin/orders/update-freight?order_id=\' + this.data.orderId;\n            this.$http.put(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.show = false;\n                    this.$dispatch(\'edit-extra-amount\');\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \tcloseDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 30%;\n}\n\n</style>'],
sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(80),o=i(a),s=n(46),r=n(85);e.default={name:"EditExtraAmountDialogView",components:{popupTips:o.default},props:["show","data"],data:function(){return{buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},methods:{validateExtraAmount:function(){var t=r.orderValidator.validateExtraAmount(this.data.extraAmount,this.data.minExtraAmount);if(!t.ok)return t.errorMsg},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.editExtraAmount())},editExtraAmount:function(){var t=this,e=this.validateExtraAmount();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=e,void(this.buttonEnabled=!0);var n={freight:this.data.extraAmount,freight_remark:this.data.extraAmountRemark},i="/api/v2/admin/orders/update-freight?order_id="+this.data.orderId;this.$http.put(i,n).then(function(e){e.data.result&&0!==e.data.result?s.callback.success(e.data):(t.show=!1,t.$dispatch("edit-extra-amount")),t.buttonEnabled=!0},function(e){s.callback.error(e),t.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},function(t,e){t.exports=' <div class=modal v-show=show _v-8acd7194=""> <div class=modal-dialog style=width:400px _v-8acd7194=""> <div class=modal-content _v-8acd7194=""> <div class=modal-header _v-8acd7194=""> <button type=button class=close @click=closeDialog _v-8acd7194="">×</button> <h4 class=modal-title _v-8acd7194="">订单补充金额</h4> </div> <div class=modal-body _v-8acd7194=""> <h5 _v-8acd7194="">补充金额必须大于{{data.minExtraAmount | realPrice}}元</h5> <form class=form-horizontal _v-8acd7194=""> <div class=form-group _v-8acd7194=""> <label class="col-lg-4 control-label" for=extraAmount _v-8acd7194="">补充金额<span class=text-danger _v-8acd7194="">*</span>：</label> <div class=col-lg-8 _v-8acd7194=""> <input class="form-control input-sm" id=extraAmount type=text v-model="data.extraAmount | priceFilter" _v-8acd7194=""> </div> </div> <div class=form-group _v-8acd7194=""> <label class="col-lg-4 control-label" for=extraAmountRemark _v-8acd7194="">备注：</label> <div class=col-lg-8 _v-8acd7194=""> <input class="form-control input-sm" id=extraAmountRemark type=text v-model=data.extraAmountRemark _v-8acd7194=""> </div> </div> </form> </div> <div class=modal-footer _v-8acd7194=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-8acd7194="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-8acd7194=""></popup-tips> </div> '},function(t,e,n){var i,a;n(124),i=n(126),a=n(127),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(125);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-2f1637eb]{height:100%}.modal-dialog[_v-2f1637eb]{top:30%}","",{version:3,sources:["/./src/views/order/comp/editExtraCostDialog.vue.style"],names:[],mappings:"AA0GA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"editExtraCostDialog.vue",sourcesContent:['<!-- editExtraCostDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n    \t<div class="modal-dialog" style="width:400px;">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">额外成本</h4>\n                </div>\n                <div class="modal-body">\n                    <form class="form-horizontal">\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-4 control-label" for="extraCost">额外成本<span class="text-danger">*</span>：</label>\n\t\t                    <div class="col-lg-8">\n\t\t                        <input class="form-control input-sm" id="extraCost" type="text" v-model="data.extra_cost | priceFilter">\n\t\t                    </div>\n\t\t                </div>\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-4 control-label" for="extraCostRemark">备注：</label>\n\t\t                    <div class="col-lg-8">\n\t\t                        <input class="form-control input-sm" id="extraCostRemark" type="text" v-model="data.extra_cost_remark">\n\t\t                    </div>\n\t\t                </div>\n\t\t            </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'EditExtraCostDialogView\',\n    components: {\n        popupTips,\n    },\n    props: [\'show\', \'data\'],\n    data() {\n        return {\n        \tbuttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    methods: {\n    \tvalidateExtraCost() {\n            var result = orderValidator.validateExtraCost(this.data.extra_cost);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                this.editExtraCost();\n            }\n        },\n    \teditExtraCost() {\n            var result = this.validateExtraCost();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var data = {\n                extra_cost: this.data.extra_cost,\n                extra_cost_remark: this.data.extra_cost_remark,\n            };\n            var url = \'/api/v2/admin/orders/update-extra-cost?order_id=\' + this.data.orderId;\n            this.$http.put(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.show = false;\n                    this.$dispatch(\'edit-extra-cost\');\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \tcloseDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 30%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(80),o=i(a),s=n(46),r=n(85);e.default={name:"EditExtraCostDialogView",components:{popupTips:o.default},props:["show","data"],data:function(){return{buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},methods:{validateExtraCost:function(){var t=r.orderValidator.validateExtraCost(this.data.extra_cost);if(!t.ok)return t.errorMsg},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.editExtraCost())},editExtraCost:function(){var t=this,e=this.validateExtraCost();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=e,void(this.buttonEnabled=!0);var n={extra_cost:this.data.extra_cost,extra_cost_remark:this.data.extra_cost_remark},i="/api/v2/admin/orders/update-extra-cost?order_id="+this.data.orderId;this.$http.put(i,n).then(function(e){e.data.result&&0!==e.data.result?s.callback.success(e.data):(t.show=!1,t.$dispatch("edit-extra-cost")),t.buttonEnabled=!0},function(e){s.callback.error(e),t.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},function(t,e){t.exports=' <div class=modal v-show=show _v-2f1637eb=""> <div class=modal-dialog style=width:400px _v-2f1637eb=""> <div class=modal-content _v-2f1637eb=""> <div class=modal-header _v-2f1637eb=""> <button type=button class=close @click=closeDialog _v-2f1637eb="">×</button> <h4 class=modal-title _v-2f1637eb="">额外成本</h4> </div> <div class=modal-body _v-2f1637eb=""> <form class=form-horizontal _v-2f1637eb=""> <div class=form-group _v-2f1637eb=""> <label class="col-lg-4 control-label" for=extraCost _v-2f1637eb="">额外成本<span class=text-danger _v-2f1637eb="">*</span>：</label> <div class=col-lg-8 _v-2f1637eb=""> <input class="form-control input-sm" id=extraCost type=text v-model="data.extra_cost | priceFilter" _v-2f1637eb=""> </div> </div> <div class=form-group _v-2f1637eb=""> <label class="col-lg-4 control-label" for=extraCostRemark _v-2f1637eb="">备注：</label> <div class=col-lg-8 _v-2f1637eb=""> <input class="form-control input-sm" id=extraCostRemark type=text v-model=data.extra_cost_remark _v-2f1637eb=""> </div> </div> </form> </div> <div class=modal-footer _v-2f1637eb=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-2f1637eb="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-2f1637eb=""></popup-tips> </div> '},function(t,e,n){var i,a;n(129),i=n(131),a=n(132),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(130);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-03122b87]{height:100%}","",{version:3,sources:["/./src/views/order/comp/applyInvoiceDialog.vue.style"],names:[],mappings:"AAuKA,oBACA,WAAA,CACA",file:"applyInvoiceDialog.vue",sourcesContent:['<!-- applyInvoiceDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n        <div class="modal-dialog" style="width:400px; top:30%;" v-show="!showInvoiceInfoDialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">开票申请</h4>\n                </div>\n                <div class="modal-body">\n                    <h5>订单剩余未开票金额：{{maxApplyAmount | realPrice}}元</h5>\n                    <form class="form-horizontal">\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="applyInvoiceAmount">使用额度<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-8">\n                                <input class="form-control input-sm" id="applyInvoiceAmount" type="text" v-model="applyInvoiceAmount | priceFilter">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" @click="clickToNextStep">下一步</button>\n                </div>\n            </div>\n        </div>\n        <div class="modal-dialog" style="width:1000px; top:10%;" v-show="showInvoiceInfoDialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">开票信息</h4>\n                </div>\n                <div class="modal-body" style="height:480px;overflow-y:auto;">\n                    <invoice-info-component :invoice-data="invoiceInfo" :consignees="[]">\n                    </invoice-info-component>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport invoiceInfoComponent from \'./invoiceInfoComponent.vue\'\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'ApplyInvoiceDialogView\',\n    components: {\n        invoiceInfoComponent,\n        popupTips,\n    },\n    data() {\n        return {\n            showInvoiceInfoDialog: false,\n            applyInvoiceAmount: \'\',\n            buttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    props: [\'show\', \'orderIds\', \'invoiceInfo\', \'maxApplyAmount\'],\n    methods: {\n        validateApplyInvoiceAmount() {\n            var result = orderValidator.validateApplyInvoiceAmount(this.applyInvoiceAmount, this.maxApplyAmount);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        validateInvoiceInfo() {\n            var result = orderValidator.validateInvoiceAmount(this.invoiceInfo.amount);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            var infoName = ["开票内容", "开票抬头", "发票收货人", "发票收货人联系方式", "发票收货人收货地址"];\n            var infoData = [this.invoiceInfo.content, this.invoiceInfo.title, this.invoiceInfo.consignee_name, this.invoiceInfo.consignee_phone, this.invoiceInfo.address];\n            for (let i = 0; i < infoName.length; i++) {\n                result = orderValidator.validateInvoiceItem(infoName[i], infoData[i]);\n                if (!result.ok) {\n                    return result.errorMsg;\n                }\n            }\n            if (this.invoiceInfo.zengzhishui) {\n                infoName = ["发票信息中纳税人识别号", "发票信息中注册地址", "发票信息中电话", "发票信息中开户行", "发票信息中账号"];\n                infoData = [this.invoiceInfo.zengzhishui.identifier, this.invoiceInfo.zengzhishui.address, this.invoiceInfo.zengzhishui.phone, this.invoiceInfo.zengzhishui.account, this.invoiceInfo.zengzhishui.bank];\n                for (let i = 0; i < infoName.length; i++) {\n                    result = orderValidator.validateInvoiceItem(infoName[i], infoData[i]);\n                    if (!result.ok) {\n                        return result.errorMsg;\n                    }\n                }\n            }\n            return;\n        },\n        clickToNextStep() {\n            var result = this.validateApplyInvoiceAmount();\n            if (result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                return;\n            }\n            this.showInvoiceInfoDialog = true;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                this.applyInvoice();\n            }\n        },\n        applyInvoice() {\n            var result = this.validateInvoiceInfo();\n            if (result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var params = \'\';\n            for (let i = 0; i < this.orderIds.length; i++) {\n                if (i !== 0) {\n                    params += "&order_id=" + this.orderIds[i];\n                } else {\n                    params += "order_id=" + this.orderIds[i];\n                }\n            }\n            var data = {\n                amount: this.applyInvoiceAmount,\n                data: this.invoiceInfo,\n            };\n            var url = \'/api/v2/admin/invoices/create?\' + params;\n            this.$http.post(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.applyInvoiceAmount = \'\';\n                    this.show = false;\n                    this.showInvoiceInfoDialog = false;\n                    this.$dispatch(\'apply-invoice\');\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n        closeDialog() {\n            this.applyInvoiceAmount = \'\';\n            this.show = false;\n            this.showInvoiceInfoDialog = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n</style>'],sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(64),o=i(a),s=n(80),r=i(s),d=n(46),l=n(85);e.default={name:"ApplyInvoiceDialogView",components:{invoiceInfoComponent:o.default,popupTips:r.default},data:function(){return{showInvoiceInfoDialog:!1,applyInvoiceAmount:"",buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},props:["show","orderIds","invoiceInfo","maxApplyAmount"],methods:{validateApplyInvoiceAmount:function(){var t=l.orderValidator.validateApplyInvoiceAmount(this.applyInvoiceAmount,this.maxApplyAmount);if(!t.ok)return t.errorMsg},validateInvoiceInfo:function(){var t=l.orderValidator.validateInvoiceAmount(this.invoiceInfo.amount);if(!t.ok)return t.errorMsg;for(var e=["开票内容","开票抬头","发票收货人","发票收货人联系方式","发票收货人收货地址"],n=[this.invoiceInfo.content,this.invoiceInfo.title,this.invoiceInfo.consignee_name,this.invoiceInfo.consignee_phone,this.invoiceInfo.address],i=0;i<e.length;i++)if(t=l.orderValidator.validateInvoiceItem(e[i],n[i]),!t.ok)return t.errorMsg;if(this.invoiceInfo.zengzhishui){e=["发票信息中纳税人识别号","发票信息中注册地址","发票信息中电话","发票信息中开户行","发票信息中账号"],n=[this.invoiceInfo.zengzhishui.identifier,this.invoiceInfo.zengzhishui.address,this.invoiceInfo.zengzhishui.phone,this.invoiceInfo.zengzhishui.account,this.invoiceInfo.zengzhishui.bank];for(var a=0;a<e.length;a++)if(t=l.orderValidator.validateInvoiceItem(e[a],n[a]),!t.ok)return t.errorMsg}},clickToNextStep:function(){var t=this.validateApplyInvoiceAmount();return t?(this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",void(this.dataForPopupTips.content=t)):void(this.showInvoiceInfoDialog=!0)},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.applyInvoice())},applyInvoice:function(){var t=this,e=this.validateInvoiceInfo();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=e,void(this.buttonEnabled=!0);for(var n="",i=0;i<this.orderIds.length;i++)n+=0!==i?"&order_id="+this.orderIds[i]:"order_id="+this.orderIds[i];var a={amount:this.applyInvoiceAmount,data:this.invoiceInfo},o="/api/v2/admin/invoices/create?"+n;this.$http.post(o,a).then(function(e){e.data.result&&0!==e.data.result?d.callback.success(e.data):(t.applyInvoiceAmount="",t.show=!1,t.showInvoiceInfoDialog=!1,t.$dispatch("apply-invoice")),t.buttonEnabled=!0},function(e){d.callback.error(e),t.buttonEnabled=!0})},closeDialog:function(){this.applyInvoiceAmount="",this.show=!1,this.showInvoiceInfoDialog=!1}}}},function(t,e){t.exports=' <div class=modal v-show=show _v-03122b87=""> <div class=modal-dialog style="width:400px; top:30%" v-show=!showInvoiceInfoDialog _v-03122b87=""> <div class=modal-content _v-03122b87=""> <div class=modal-header _v-03122b87=""> <button type=button class=close @click=closeDialog _v-03122b87="">×</button> <h4 class=modal-title _v-03122b87="">开票申请</h4> </div> <div class=modal-body _v-03122b87=""> <h5 _v-03122b87="">订单剩余未开票金额：{{maxApplyAmount | realPrice}}元</h5> <form class=form-horizontal _v-03122b87=""> <div class=form-group _v-03122b87=""> <label class="col-lg-4 control-label" for=applyInvoiceAmount _v-03122b87="">使用额度<span class=text-danger _v-03122b87="">*</span>：</label> <div class=col-lg-8 _v-03122b87=""> <input class="form-control input-sm" id=applyInvoiceAmount type=text v-model="applyInvoiceAmount | priceFilter" _v-03122b87=""> </div> </div> </form> </div> <div class=modal-footer _v-03122b87=""> <button type=button class="btn btn-primary" @click=clickToNextStep _v-03122b87="">下一步</button> </div> </div> </div> <div class=modal-dialog style="width:1000px; top:10%" v-show=showInvoiceInfoDialog _v-03122b87=""> <div class=modal-content _v-03122b87=""> <div class=modal-header _v-03122b87=""> <button type=button class=close @click=closeDialog _v-03122b87="">×</button> <h4 class=modal-title _v-03122b87="">开票信息</h4> </div> <div class=modal-body style=height:480px;overflow-y:auto _v-03122b87=""> <invoice-info-component :invoice-data=invoiceInfo :consignees=[] _v-03122b87=""> </invoice-info-component> </div> <div class=modal-footer _v-03122b87=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-03122b87="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-03122b87=""></popup-tips> </div> '},function(t,e,n){var i,a;n(134),i=n(136),a=n(137),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(135);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-cd1264e4]{height:100%}.modal-dialog[_v-cd1264e4]{top:15%}","",{version:3,sources:["/./src/views/order/comp/payQrCodeDialog.vue.style"],names:[],mappings:"AAqEA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"payQrCodeDialog.vue",sourcesContent:['<!-- payQrCodeDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n        <div class="modal-dialog" style="width:320px;">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">{{title}}</h4>\n                </div>\n                <div class="modal-body">\n                \t<h4>应付金额：<span style="font-size:20px;color:#f54404">{{data.amountToPay | realPrice}}</span>元</h4>\n                \t<br>\n                \t<div id="qrcode_pay">\n                \t</div>\n                \t<br>\n                \t<p class="text-danger">{{description}}</p>\n                \t<p>支付完成后请手动刷新订单</p>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n\nexport default {\n    name: \'payQrCodeDialogView\',\n    data() {\n        return {\n        }\n    },\n    computed: {\n        title() {\n            if (this.data.type === \'WECHAT_QR\') {\n                return \'微信扫码支付\';\n            } else {\n            \treturn \'支付宝扫码支付\';\n            }\n        },\n        description() {\n        \tif (this.data.type === \'WECHAT_QR\') {\n                return \'使用微信扫一扫，扫描二维码支付\';\n            } else {\n            \treturn \'使用支付宝扫一扫，扫描二维码支付\';\n            }\n        },\n    },\n    props: [\'show\', \'data\'],\n    watch: {\n    \tshow(val, oldVal) {\n            if (val) {\n            \t$("#qrcode_pay").html(\'\').qrcode({\n                    width: 280,\n                    height: 280,\n                    text: this.data.qrCodeUrl,\n                });\n            }\n        },\n    },\n    methods: {\n    \tcloseDialog() {\n            this.show = false;\n        },\n    },\n}\n\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 15%;\n}\n</style>'],sourceRoot:"webpack://"}])},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"payQrCodeDialogView",data:function(){return{}},computed:{title:function(){return"WECHAT_QR"===this.data.type?"微信扫码支付":"支付宝扫码支付"},description:function(){return"WECHAT_QR"===this.data.type?"使用微信扫一扫，扫描二维码支付":"使用支付宝扫一扫，扫描二维码支付"}},props:["show","data"],watch:{show:function(t,e){t&&$("#qrcode_pay").html("").qrcode({width:280,height:280,text:this.data.qrCodeUrl})}},methods:{closeDialog:function(){this.show=!1}}}},function(t,e){t.exports=' <div class=modal v-show=show _v-cd1264e4=""> <div class=modal-dialog style=width:320px _v-cd1264e4=""> <div class=modal-content _v-cd1264e4=""> <div class=modal-header _v-cd1264e4=""> <button type=button class=close @click=closeDialog _v-cd1264e4="">×</button> <h4 class=modal-title _v-cd1264e4="">{{title}}</h4> </div> <div class=modal-body _v-cd1264e4=""> <h4 _v-cd1264e4="">应付金额：<span style=font-size:20px;color:#f54404 _v-cd1264e4="">{{data.amountToPay | realPrice}}</span>元</h4> <br _v-cd1264e4=""> <div id=qrcode_pay _v-cd1264e4=""> </div> <br _v-cd1264e4=""> <p class=text-danger _v-cd1264e4="">{{description}}</p> <p _v-cd1264e4="">支付完成后请手动刷新订单</p> </div> </div> </div> </div> '},function(t,e,n){var i,a;n(139),i=n(141),a=n(142),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(140);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-87b7fcc4]{height:100%}.modal-dialog[_v-87b7fcc4]{top:20%}","",{version:3,sources:["/./src/views/order/comp/applyRefundDialog.vue.style"],names:[],mappings:"AA8IA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"applyRefundDialog.vue",sourcesContent:['<!-- applyRefundDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n    \t<div class="modal-dialog">\n            <div class="modal-content">\n            \t<div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">申请退款</h4>\n                </div>\n                <div class="modal-body">\n                    <h5>可退金额最多为{{data.maxRefundValue | realPrice}}元</h5>\n                    <form class="form-horizontal">\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="refundAmount">退款金额<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="refundAmount" type="text" v-model="data.refundAmount | priceFilter">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="refundMethod">退款渠道<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <select class="form-control input-sm" id="refundMethod" v-model="data.refundMethod">\n                                    <option value="BANK_TRANSFER">银行转账</option>\n                                    <option value="ALIPAY_TRANSFER">支付宝转账</option>\n                                </select>\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="refundAccount">对方账号<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="refundAccount" type="text" v-model="data.refundAccount">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="refundName">对方名称：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="refundName" type="text" v-model="data.refundName">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="refundReason">退款原因<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="refundReason" type="text" v-model="data.refundReason">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'ApplyRefundDialogView\',\n    components: {\n        popupTips,\n    },\n    props: [\'show\', \'data\'],\n    data() {\n        return {\n        \tbuttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    methods: {\n    \tvalidateRefundInfo() {\n            var result = orderValidator.validateRefundAmount(this.data.refundAmount, this.data.maxRefundValue);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            if (!this.data.refundMethod) {\n                return \'请选择退款渠道\';\n            }\n            result = orderValidator.validateRefundAccount(this.data.refundAccount);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            result = orderValidator.validateRefundReason(this.data.refundReason);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                this.addRefund();\n            }\n        },\n        addRefund() {\n        \tvar result = this.validateRefundInfo();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var url = \'/api/v2/admin/refunds/create?order_id=\' + this.data.orderId;\n            var data = {\n                amount: this.data.refundAmount,\n                method: this.data.refundMethod,\n                account: this.data.refundAccount,\n                name: this.data.refundName,\n                reason: this.data.refundReason,\n            };\n            this.$http.post(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.show = false;\n                    this.$dispatch(\'apply-refund\');\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \tcloseDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 20%;\n}\n\n</style>'],
sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(80),o=i(a),s=n(46),r=n(85);e.default={name:"ApplyRefundDialogView",components:{popupTips:o.default},props:["show","data"],data:function(){return{buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},methods:{validateRefundInfo:function(){var t=r.orderValidator.validateRefundAmount(this.data.refundAmount,this.data.maxRefundValue);return t.ok?this.data.refundMethod?(t=r.orderValidator.validateRefundAccount(this.data.refundAccount),t.ok?(t=r.orderValidator.validateRefundReason(this.data.refundReason),t.ok?void 0:t.errorMsg):t.errorMsg):"请选择退款渠道":t.errorMsg},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.addRefund())},addRefund:function(){var t=this,e=this.validateRefundInfo();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=e,void(this.buttonEnabled=!0);var n="/api/v2/admin/refunds/create?order_id="+this.data.orderId,i={amount:this.data.refundAmount,method:this.data.refundMethod,account:this.data.refundAccount,name:this.data.refundName,reason:this.data.refundReason};this.$http.post(n,i).then(function(e){e.data.result&&0!==e.data.result?s.callback.success(e.data):(t.show=!1,t.$dispatch("apply-refund")),t.buttonEnabled=!0},function(e){s.callback.error(e),t.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},function(t,e){t.exports=' <div class=modal v-show=show _v-87b7fcc4=""> <div class=modal-dialog _v-87b7fcc4=""> <div class=modal-content _v-87b7fcc4=""> <div class=modal-header _v-87b7fcc4=""> <button type=button class=close @click=closeDialog _v-87b7fcc4="">×</button> <h4 class=modal-title _v-87b7fcc4="">申请退款</h4> </div> <div class=modal-body _v-87b7fcc4=""> <h5 _v-87b7fcc4="">可退金额最多为{{data.maxRefundValue | realPrice}}元</h5> <form class=form-horizontal _v-87b7fcc4=""> <div class=form-group _v-87b7fcc4=""> <label class="col-lg-4 control-label" for=refundAmount _v-87b7fcc4="">退款金额<span class=text-danger _v-87b7fcc4="">*</span>：</label> <div class=col-lg-6 _v-87b7fcc4=""> <input class="form-control input-sm" id=refundAmount type=text v-model="data.refundAmount | priceFilter" _v-87b7fcc4=""> </div> </div> <div class=form-group _v-87b7fcc4=""> <label class="col-lg-4 control-label" for=refundMethod _v-87b7fcc4="">退款渠道<span class=text-danger _v-87b7fcc4="">*</span>：</label> <div class=col-lg-6 _v-87b7fcc4=""> <select class="form-control input-sm" id=refundMethod v-model=data.refundMethod _v-87b7fcc4=""> <option value=BANK_TRANSFER _v-87b7fcc4="">银行转账</option> <option value=ALIPAY_TRANSFER _v-87b7fcc4="">支付宝转账</option> </select> </div> </div> <div class=form-group _v-87b7fcc4=""> <label class="col-lg-4 control-label" for=refundAccount _v-87b7fcc4="">对方账号<span class=text-danger _v-87b7fcc4="">*</span>：</label> <div class=col-lg-6 _v-87b7fcc4=""> <input class="form-control input-sm" id=refundAccount type=text v-model=data.refundAccount _v-87b7fcc4=""> </div> </div> <div class=form-group _v-87b7fcc4=""> <label class="col-lg-4 control-label" for=refundName _v-87b7fcc4="">对方名称：</label> <div class=col-lg-6 _v-87b7fcc4=""> <input class="form-control input-sm" id=refundName type=text v-model=data.refundName _v-87b7fcc4=""> </div> </div> <div class=form-group _v-87b7fcc4=""> <label class="col-lg-4 control-label" for=refundReason _v-87b7fcc4="">退款原因<span class=text-danger _v-87b7fcc4="">*</span>：</label> <div class=col-lg-6 _v-87b7fcc4=""> <input class="form-control input-sm" id=refundReason type=text v-model=data.refundReason _v-87b7fcc4=""> </div> </div> </form> </div> <div class=modal-footer _v-87b7fcc4=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-87b7fcc4="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-87b7fcc4=""></popup-tips> </div> '},function(t,e){t.exports=' <div class=container-fluid _v-b921fbfe=""> <ul class=breadcrumb _v-b921fbfe=""> <li _v-b921fbfe="">订单系统</li> <li _v-b921fbfe="">订单管理</li> <li _v-b921fbfe="">订单详情：{{orderId}}</li> </ul> <div class=pull-right _v-b921fbfe=""> <a class="btn btn-info btn-sm" v-show=canCancel @click=showCancelOrderDialog _v-b921fbfe="">取消</a> <a class="btn btn-info btn-sm" v-show=canFinish @click=showFinishOrderDialog _v-b921fbfe="">完成</a> <a class="btn btn-info btn-sm" v-show=canConfirm @click=showConfirmOrderDialog _v-b921fbfe="">确认</a> <a class="btn btn-info btn-sm" v-show="orderId &amp;&amp; permissionList.editOrder" v-link="{ path: \'/order/edit/\'+orderId }" _v-b921fbfe="">编辑</a> <a class="btn btn-info btn-sm" v-show="orderId &amp;&amp; permissionList.createOrder" v-link="{ path: \'/order/create/\'+orderId }" target=_blank _v-b921fbfe="">复制该订单</a> </div> <h3 _v-b921fbfe="">订单详情</h3> <p class=clearfix _v-b921fbfe=""></p> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-body _v-b921fbfe=""> <div class="row h4" _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">订单编号：</b>{{orderBasic.id}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">订单状态：</b>{{orderBasic.status | orderStatusFilter}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">订单日期：</b>{{orderDate | dateFormat \'toDate\'}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">创建时间：</b>{{orderBasic.create_time | dateFormat}}</div> </div> <div class="row h4" _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">客户经理/客服：</b>{{orderBasic.manager ? orderBasic.manager.display_name : \'\'}}</div> <div class=col-lg-6 _v-b921fbfe=""><b _v-b921fbfe="">创建人：</b>{{orderBasic.creator.type === \'USER\' ? \'酱印网 \' + (orderBasic.creator.username ? orderBasic.creator.username : \'\') : orderBasic.creator.display_name}}</div> </div> <div class="row h4" _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">订单金额：</b>{{(orderId ? orderBasic.amount + orderBasic.freight : \'\') | realPrice}}{{orderBasic.is_priced === false ? \'+？\' : \'\'}}元</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">盈利：</b>{{(isOrderProfitSure ? (orderBasic.amount + orderBasic.freight - orderBasic.cost - orderBasic.extra_cost - orderBasic.logistics_cost - orderBasic.invoice_logistics_cost - orderBasic.refunded_amount) : \'\') | realPrice}}{{(!orderId || isOrderProfitSure) ? \'\' : \'？\'}}元</div> </div> <div class="row h4" _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">商品成本：</b>{{orderBasic.cost | realPrice}}{{!orderId || isProductCostSure ? \'\' : \'+？\'}}元</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">额外成本：</b>{{orderBasic.extra_cost | realPrice}}元</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">物流成本：</b>{{orderBasic.logistics_cost | realPrice}}+{{orderBasic.invoice_logistics_cost | realPrice}}元</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">退款金额：</b>{{orderBasic.refunded_amount | realPrice}}元</div> </div> </div> </div> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-heading _v-b921fbfe="">商品清单</div> <div class=panel-body _v-b921fbfe=""> <table class="table table-bordered table-hover product-table" _v-b921fbfe=""> <thead _v-b921fbfe=""> <tr _v-b921fbfe=""> <th style=width:6% _v-b921fbfe="">ID</th> <th style=width:10% _v-b921fbfe="">产品名称</th> <th style=width:18% _v-b921fbfe="">参数</th> <th style=width:8% _v-b921fbfe="">数量</th> <th style=width:8% _v-b921fbfe="">价格(元)</th> <th style=width:8% _v-b921fbfe="">成本(元)</th> <th style=width:15% _v-b921fbfe="">到货时间要求</th> <th style=width:8% _v-b921fbfe="">制作负责人</th> <th style=width:8% _v-b921fbfe="">制作状态</th> <th style=width:11% _v-b921fbfe="">印刷文件</th> </tr> </thead> <tbody _v-b921fbfe=""> <tr v-for="item of orderItems" _v-b921fbfe=""> <td _v-b921fbfe="">{{item.id}}</td> <template v-if=item.is_custom _v-b921fbfe=""> <td _v-b921fbfe="">{{item.detail.name}}</td> <td _v-b921fbfe=""> <a class=btn-link @click=showProductDetailDialog(item) _v-b921fbfe=""> {{item.detail.size}}{{(item.detail.size &amp;&amp; (item.detail.caizhi || item.detail.others)) ? \'_\' : \'\'}}{{item.detail.caizhi}}{{(item.detail.caizhi &amp;&amp; item.detail.others) ? \'_\' : \'\'}}{{item.detail.others}} </a> </td> <td _v-b921fbfe="">{{item.detail.quantity}}</td> </template> <template v-else="" _v-b921fbfe=""> <td _v-b921fbfe=""> <a class=btn-link :href="\'http://www.soyyin.com/product?id=\'+item.product_id+\'#\'+item.brief" target=_blank _v-b921fbfe="">{{item.title}}</a> </td> <td _v-b921fbfe="">{{item.brief}}</td> <td _v-b921fbfe="">{{item.quantity}}</td> </template> <td _v-b921fbfe="">{{item.price === 0 ? \'暂无\' : \'\'}}{{(item.price === 0 ? \'\' : item.price ) | realPrice}}</td> <td _v-b921fbfe="">{{(item.cost ? item.cost : \'\') | realPrice}}</td> <td _v-b921fbfe="">{{item.arrival_time}}</td> <td _v-b921fbfe="">{{item.producer ? item.producer.name : \'\'}}</td> <td _v-b921fbfe="">{{item.produce_status | produceStatusFilter}}</td> <td _v-b921fbfe=""><a class=btn-link v-if=item.file :href="item.file.file_key | getQiniuUrl" target=_blank _v-b921fbfe="">{{item.file.file_name}}</a></td> </tr> </tbody> </table> <div class=row _v-b921fbfe=""> <div class=col-lg-6 _v-b921fbfe=""> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-body _v-b921fbfe=""> <a class="pull-right btn btn-info btn-sm" v-show=canChangeExtraAmount @click=changeExtraAmount _v-b921fbfe="">修改</a> <h4 _v-b921fbfe="">订单金额补充</h4> <div class=row style="margin: 0" _v-b921fbfe=""> <label class=pull-left _v-b921fbfe="">补充金额：</label> <p class=pull-left _v-b921fbfe="">{{orderBasic.freight | realPrice}}元</p> </div> <div class=row style="margin: 0" _v-b921fbfe=""> <label class=pull-left _v-b921fbfe="">备注：</label> <p class=pull-left style="width: 85%" _v-b921fbfe="">{{orderBasic.freight_remark}}</p> </div> </div> </div> </div> <div class=col-lg-6 _v-b921fbfe=""> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-body _v-b921fbfe=""> <a class="pull-right btn btn-info btn-sm" v-show=canChangeExtraCost @click=changeExtraCost _v-b921fbfe="">修改</a> <h4 _v-b921fbfe="">额外成本</h4> <div class=row style="margin: 0" _v-b921fbfe=""> <label class=pull-left _v-b921fbfe="">金额：</label> <p class=pull-left _v-b921fbfe="">{{orderBasic.extra_cost | realPrice}}元</p> </div> <div class=row style="margin: 0" _v-b921fbfe=""> <label class=pull-left _v-b921fbfe="">备注：</label> <p class=pull-left style="width: 85%" _v-b921fbfe="">{{orderBasic.extra_cost_remark}}</p> </div> </div> </div> </div> </div> <div _v-b921fbfe=""> <h4 class=pull-right _v-b921fbfe=""><b _v-b921fbfe="">订单金额：</b>{{(orderId ? orderBasic.amount + orderBasic.freight : \'\') | realPrice}}{{orderBasic.is_priced === false ? \'+？\' : \'\'}}元</h4> </div> </div> </div> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-heading _v-b921fbfe="">客户信息</div> <div class=panel-body _v-b921fbfe=""> <h4 class=row style="margin-bottom: 25px" _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">客户名称：</b>{{orderBasic.customer.name}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">联系电话：</b>{{orderBasic.customer.phone}}</div> <div class=col-lg-2 _v-b921fbfe=""><b _v-b921fbfe="">QQ：</b>{{orderBasic.customer.qq}}</div> <div class=col-lg-4 _v-b921fbfe=""><b _v-b921fbfe="">公司：</b>{{orderBasic.customer.company}}</div> </h4> <template v-for="consigneeItem of consignees" _v-b921fbfe=""> <consignee-info-with-logistics :index=$index :consignee-item=consigneeItem :can-add-logistics=false _v-b921fbfe=""></consignee-info-with-logistics> </template> </div> </div> <div class="panel panel-default invoice-info" _v-b921fbfe=""> <div class=panel-heading _v-b921fbfe="">发票信息</div> <div class=panel-body _v-b921fbfe=""> <a class="pull-right btn btn-info btn-sm" v-if=canApplyInvoice @click=clickToApplyInvoice _v-b921fbfe="">申请开票</a> <h4 class=row _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">开票额度：</b>{{(orderId ? orderBasic.amount + orderBasic.freight : \'\') | realPrice}}{{orderBasic.is_priced === false ? \'+？\' : \'\'}}元</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">已申请：</b>{{orderBasic.invoiced_amount | realPrice}}元</div> </h4> <p _v-b921fbfe=""><a class=btn-link v-if=invoiceInfo @click=clickToshowInvoiceInfoDialog _v-b921fbfe="">{{invoiceInfo.zengzhishui ? \'增值税发票\' : \'普通发票\'}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{invoiceInfo.title}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{invoiceInfo.content}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{invoiceInfo.amount | realPrice}}元</a></p> <template v-if="invoiceRecords.length > 0" _v-b921fbfe=""> <h4 _v-b921fbfe="">开票历史</h4> <div class="panel panel-default" v-for="recordItem in invoiceRecords" _v-b921fbfe=""> <div class=panel-body _v-b921fbfe=""> <a class="pull-right btn-link" @click=showOrHideInvoiceRecordItem(recordItem) _v-b921fbfe="">{{recordItem.showAll ? \'收起\' : \'展开\'}}</a> <div class=row _v-b921fbfe=""> <div class=col-lg-2 _v-b921fbfe=""><b _v-b921fbfe="">状态：</b>{{recordItem.status | invoiceStatusFilter}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">申请时间：</b>{{recordItem.create_time | dateFormat}}</div> <div class=col-lg-6 _v-b921fbfe="">{{recordItem.data.zengzhishui ? \'增值税发票\' : \'普通发票\'}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.data.title}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.data.content}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.data.amount | realPrice}}元</div> </div> <div v-show=recordItem.showAll _v-b921fbfe=""> <div class=row _v-b921fbfe=""> <div class=col-lg-2 _v-b921fbfe=""><b _v-b921fbfe="">开票申请ID：</b>{{recordItem.id}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">开票类型：</b>{{recordItem.order_ids.length &gt; 1 ? \'(\' + recordItem.order_ids.length + \'订单)合并开票\' : \'单开\'}}</div> <div class=col-lg-2 _v-b921fbfe=""><b _v-b921fbfe="">使用额度：</b>{{recordItem.amount_of_order | realPrice}}元</div> <div class=col-lg-3 v-if=recordItem.invoice_time _v-b921fbfe=""><b _v-b921fbfe="">开票时间：</b>{{recordItem.invoice_time | dateFormat}}</div> <div class=col-lg-3 v-if=recordItem.finish_time _v-b921fbfe=""><b _v-b921fbfe="">完成时间：</b>{{recordItem.finish_time | dateFormat}}</div> </div> <div class=row style="margin: 0" v-if=recordItem.data.remark _v-b921fbfe=""> <div class=pull-left _v-b921fbfe=""><b _v-b921fbfe="">备注：</b></div> <p class=pull-left style="width: 90%" _v-b921fbfe="">{{recordItem.data.remark}}</p> </div> <div class=row v-if=recordItem.data.zengzhishui _v-b921fbfe=""> <div class=col-lg-1 style=text-align:right _v-b921fbfe="">增值税发票信息</div> <div class=col-lg-11 _v-b921fbfe=""> <div class=row _v-b921fbfe=""> <div class=col-lg-4 _v-b921fbfe=""><b _v-b921fbfe="">纳税人识别号：</b>{{recordItem.data.zengzhishui.identifier}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">电话：</b>{{recordItem.data.zengzhishui.phone}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-12 _v-b921fbfe=""><b _v-b921fbfe="">注册地址：</b>{{recordItem.data.zengzhishui.address}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-4 _v-b921fbfe=""><b _v-b921fbfe="">银行账号：</b>{{recordItem.data.zengzhishui.account}}</div> <div class=col-lg-7 _v-b921fbfe=""><b _v-b921fbfe="">开户行：</b>{{recordItem.data.zengzhishui.bank}}</div> </div> </div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-1 style=text-align:right _v-b921fbfe="">发票寄送至</div> <div class=col-lg-11 _v-b921fbfe=""> <div class=row _v-b921fbfe=""> <div class=col-lg-4 _v-b921fbfe=""><b _v-b921fbfe="">收货人：</b>{{recordItem.data.consignee_name}}</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">联系电话：</b>{{recordItem.data.consignee_phone}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-12 _v-b921fbfe=""><b _v-b921fbfe="">邮寄地址：</b>{{recordItem.data.address}}</div> </div> </div> </div> <div class=row v-if=recordItem.logistics _v-b921fbfe=""> <div class=col-lg-1 style=text-align:right _v-b921fbfe="">物流信息</div> <div class=col-lg-11 _v-b921fbfe=""> <div _v-b921fbfe="">{{recordItem.logistics.delivery_method}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.express}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.express_order_id}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.cost | realPrice}}元&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{recordItem.logistics.create_time | dateFormat}}录入</div> <div v-if=recordItem.logistics.remark _v-b921fbfe="">{{recordItem.logistics.remark}}</div> </div> </div> </div> </div> </div> </template> </div> </div> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-heading _v-b921fbfe="">付款信息</div> <div class=panel-body _v-b921fbfe=""> <template v-if="orderBasic.status === \'DELIVERY_CONFIRMED\'" _v-b921fbfe=""> <a class="pull-right btn btn-info btn-sm" @click=jumpToZhifubaoPayLink _v-b921fbfe="">支付宝支付链接</a> <a class="pull-right btn btn-info btn-sm" style=margin-right:20px @click=showZhifubaoQRCodeDialog _v-b921fbfe="">支付宝二维码</a> <a class="pull-right btn btn-info btn-sm" style=margin-right:20px @click=showWeChatQRCodeDialog _v-b921fbfe="">微信二维码</a> </template> <h4 class=row _v-b921fbfe=""> <template v-if=orderBasic.is_priced _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">已支付：</b>{{paymentData.paid_amount | realPrice}}元({{Math.round(paymentData.paid_amount / (orderBasic.amount + orderBasic.freight) * 100)}}%)</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">待支付：</b>{{(orderBasic.amount + orderBasic.freight - paymentData.paid_amount) | realPrice}}元({{100 - Math.round(paymentData.paid_amount / (orderBasic.amount + orderBasic.freight) * 100)}}%)</div> </template> <template v-else="" _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">已支付：</b>0元(0%)</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">待支付：</b>？元(100%)</div> </template> </h4> <h4 v-if=paymentData.payment _v-b921fbfe=""><b _v-b921fbfe="">付款方式：</b>{{paymentData.payment | paymentFilter}}</h4> <p v-if=paymentData.remark _v-b921fbfe="">{{paymentData.remark}}</p> <table class="table table-bordered table-hover payment-records-table" v-if="paymentData.records &amp;&amp; paymentData.records.length > 0" _v-b921fbfe=""> <thead _v-b921fbfe=""> <tr _v-b921fbfe=""> <th style=width:5% _v-b921fbfe="">序号</th> <th style=width:20% _v-b921fbfe="">付款时间</th> <th style=width:10% _v-b921fbfe="">付款途径</th> <th style=width:15% _v-b921fbfe="">付款方式</th> <th style=width:30% _v-b921fbfe="">支付单号</th> <th style=width:10% _v-b921fbfe="">付款金额</th> <th style=width:10% _v-b921fbfe="">付款比例</th> </tr> </thead> <tbody _v-b921fbfe=""> <tr v-for="paymentRecordItem of paymentData.records" _v-b921fbfe=""> <td _v-b921fbfe="">{{$index + 1}}</td> <td _v-b921fbfe="">{{paymentRecordItem.create_time | dateFormat}}</td> <td _v-b921fbfe="">{{paymentRecordItem.method === \'PINGXX\' ? \'线上支付\' : \'线下转账\'}}</td> <td _v-b921fbfe="">{{paymentRecordItem.method === \'PINGXX\' ? \'Ping++支付\' : (paymentRecordItem.method === \'BANK_TRANSFER\' ? \'银行转账\' : \'支付宝转账\')}}</td> <td _v-b921fbfe="">{{paymentRecordItem.payment_order_id}}</td> <td _v-b921fbfe="">{{paymentRecordItem.amount | realPrice}}元</td> <td _v-b921fbfe="">{{Math.round(paymentRecordItem.amount / (orderBasic.amount + orderBasic.freight) * 100)}}%</td> </tr> </tbody> </table> </div> </div> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-body _v-b921fbfe=""> <div class=col-md-6 _v-b921fbfe=""> <h4 _v-b921fbfe="">其他信息</h4> <p _v-b921fbfe=""><b _v-b921fbfe="">备注：</b>{{orderBasic.remark}}</p> </div> <div class=col-md-6 _v-b921fbfe=""> <h4 _v-b921fbfe="">历史记录</h4> <ul class=list-unstyled _v-b921fbfe=""> <li v-for="history of orderHistories" _v-b921fbfe=""> <p :class="{\'text-muted\': $index+1 !== orderHistories.length}" _v-b921fbfe=""> {{$index+1}}. {{history.create_time | dateFormat}} <span :class="{\'text-success\': history.status === \'FINISHED\', \'text-danger\': history.status === \'CANCELED\'}" _v-b921fbfe="">{{history.status | orderStatusFilter}}</span> </p> </li> </ul> </div> </div> </div> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-heading _v-b921fbfe="">售后处理</div> <div class=panel-body _v-b921fbfe=""> <a class="pull-right btn btn-info btn-sm" v-if=canRecordAfterSale @click=clickToRecordAfterSale _v-b921fbfe="">录入售后问题</a> <div class=col-lg-10 _v-b921fbfe=""> <p _v-b921fbfe=""><b _v-b921fbfe="">售后问题描述：</b>暂无</p> <p _v-b921fbfe=""><b _v-b921fbfe="">处理方案：</b>暂无</p> </div> </div> </div> <div class="panel panel-default" _v-b921fbfe=""> <div class=panel-heading _v-b921fbfe="">退款处理</div> <div class=panel-body _v-b921fbfe=""> <a class="pull-right btn btn-info btn-sm" v-if=canApplyRefund @click=clickToApplyRefund _v-b921fbfe="">申请退款</a> <h4 class=row _v-b921fbfe=""> <div class=col-lg-4 _v-b921fbfe=""><b _v-b921fbfe="">已申请退款：</b>{{orderBasic.refunded_amount | realPrice}}元</div> </h4> <table class="table table-bordered table-hover refund-records-table" v-if="refundRecords.length > 0" _v-b921fbfe=""> <thead _v-b921fbfe=""> <tr _v-b921fbfe=""> <th style=width:5% _v-b921fbfe="">序号</th> <th style=width:8% _v-b921fbfe="">ID</th> <th style=width:8% _v-b921fbfe="">退款金额</th> <th style=width:10% _v-b921fbfe="">状态</th> <th style=width:19% _v-b921fbfe="">操作时间</th> <th style=width:12% _v-b921fbfe="">退款类型</th> <th style=width:22% _v-b921fbfe="">退款信息</th> <th style=width:16% _v-b921fbfe="">退款原因</th> </tr> </thead> <tbody _v-b921fbfe=""> <tr v-for="refundItem in refundRecords" _v-b921fbfe=""> <td _v-b921fbfe="">{{$index + 1}}</td> <td _v-b921fbfe="">{{refundItem.id}}</td> <td _v-b921fbfe="">{{refundItem.amount | realPrice}}元</td> <td :class="{\'text-success\': refundItem.status === \'FINISHED\'}" _v-b921fbfe="">{{refundItem.status | refundStatusFilter}}</td> <td _v-b921fbfe=""> 创建时间：{{refundItem.create_time | dateFormat}}<br _v-b921fbfe=""> <template v-if=refundItem.finish_time _v-b921fbfe=""> 完成时间：{{refundItem.finish_time | dateFormat}}<br _v-b921fbfe=""> </template> </td> <td _v-b921fbfe="">{{refundItem.type | refundTypeFilter}}</td> <td _v-b921fbfe=""> 退款渠道：{{refundItem.method | refundWayFilter}}<br _v-b921fbfe=""> <template v-if="refundItem.type === \'BY_HAND\'" _v-b921fbfe=""> 对方账号：{{refundItem.account}}<br _v-b921fbfe=""> 对方姓名：{{refundItem.name}}<br _v-b921fbfe=""> </template> </td> <td _v-b921fbfe="">{{refundItem.reason}}</td> </tr> </tbody> </table> </div> </div> <div class=modal style=height:100% v-if=invoiceInfo v-show=showInvoiceInfoDialog _v-b921fbfe=""> <div class=modal-dialog style=top:30%;width:900px _v-b921fbfe=""> <div class=modal-content _v-b921fbfe=""> <div class=modal-header _v-b921fbfe=""> <button type=button class=close @click=closeInvoiceInfoDialog _v-b921fbfe="">×</button> <h4 class=modal-title _v-b921fbfe="">发票信息</h4> </div> <div class=modal-body _v-b921fbfe=""> <div class=row _v-b921fbfe=""> <div class=col-lg-2 style=text-align:right _v-b921fbfe="">发票信息</div> <div class=col-lg-10 _v-b921fbfe=""> <div class=row _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">开票金额：</b>{{invoiceInfo.amount | realPrice}}元</div> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">开票类型：</b>{{invoiceInfo.zengzhishui ? \'增值税发票\' : \'普通发票\'}}</div> <div class=col-lg-5 _v-b921fbfe=""><b _v-b921fbfe="">开票内容：</b>{{invoiceInfo.content}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-12 _v-b921fbfe=""><b _v-b921fbfe="">发票抬头：</b>{{invoiceInfo.title}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-12 _v-b921fbfe=""><b _v-b921fbfe="">备注：</b>{{invoiceInfo.remark}}</div> </div> </div> </div> <div class=row v-if=invoiceInfo.zengzhishui _v-b921fbfe=""> <div class=col-lg-2 style=text-align:right _v-b921fbfe="">增值税发票信息</div> <div class=col-lg-10 _v-b921fbfe=""> <div class=row _v-b921fbfe=""> <div class=col-lg-5 _v-b921fbfe=""><b _v-b921fbfe="">纳税人识别号：</b>{{invoiceInfo.zengzhishui.identifier}}</div> <div class=col-lg-4 _v-b921fbfe=""><b _v-b921fbfe="">电话：</b>{{invoiceInfo.zengzhishui.phone}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-12 _v-b921fbfe=""><b _v-b921fbfe="">注册地址：</b>{{invoiceInfo.zengzhishui.address}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-5 _v-b921fbfe=""><b _v-b921fbfe="">银行账号：</b>{{invoiceInfo.zengzhishui.account}}</div> <div class=col-lg-7 _v-b921fbfe=""><b _v-b921fbfe="">开户行：</b>{{invoiceInfo.zengzhishui.bank}}</div> </div> </div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-2 style=text-align:right _v-b921fbfe="">发送寄送至</div> <div class=col-lg-10 _v-b921fbfe=""> <div class=row _v-b921fbfe=""> <div class=col-lg-3 _v-b921fbfe=""><b _v-b921fbfe="">收货人：</b>{{invoiceInfo.consignee_name}}</div> <div class=col-lg-5 _v-b921fbfe=""><b _v-b921fbfe="">联系电话：</b>{{invoiceInfo.consignee_phone}}</div> </div> <div class=row _v-b921fbfe=""> <div class=col-lg-12 _v-b921fbfe=""><b _v-b921fbfe="">邮寄地址：</b>{{invoiceInfo.address}}</div> </div> </div> </div> </div> </div> </div> </div> <product-detail-dialog :show.sync=dataForProductDetailDialog.show :detail=dataForProductDetailDialog.detail _v-b921fbfe=""></product-detail-dialog> <edit-extra-amount-dialog v-if=canChangeExtraAmount :show.sync=dataForEditExtraAmountDialog.show :data=dataForEditExtraAmountDialog.data _v-b921fbfe=""></edit-extra-amount-dialog> <edit-extra-cost-dialog v-if=canChangeExtraCost :show.sync=dataForEditExtraCostDialog.show :data=dataForEditExtraCostDialog.data _v-b921fbfe=""></edit-extra-cost-dialog> <apply-invoice-dialog v-if=canApplyInvoice :show.sync=dataForApplyInvoiceDialog.show :order-ids=dataForApplyInvoiceDialog.orderIds :invoice-info=dataForApplyInvoiceDialog.invoiceInfo :max-apply-amount=dataForApplyInvoiceDialog.maxApplyAmount _v-b921fbfe=""></apply-invoice-dialog> <pay-qr-code-dialog v-if="orderBasic.status === \'DELIVERY_CONFIRMED\'" :show.sync=dataForPayQrCodeDialog.show :data=dataForPayQrCodeDialog.data _v-b921fbfe=""></pay-qr-code-dialog> <apply-refund-dialog v-if=canApplyRefund :show.sync=dataForApplyRefundDialog.show :data=dataForApplyRefundDialog.data _v-b921fbfe=""></apply-refund-dialog> <popup-dialog :show-dialog.sync=dataForPopupDialog.show :dialog-title=dataForPopupDialog.title :dialog-content=dataForPopupDialog.content _v-b921fbfe=""></popup-dialog> </div> '},function(t,e,n){var i,a;n(145),i=n(147),a=n(158),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(146);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".consignee-table[_v-4c244d8c],.product-table[_v-4c244d8c]{table-layout:fixed}.consignee-table td[_v-4c244d8c],.consignee-table th[_v-4c244d8c],.product-table td[_v-4c244d8c],.product-table th[_v-4c244d8c]{text-align:center;vertical-align:middle}.consignee-table td .btn-link[_v-4c244d8c],.product-table td .btn-link[_v-4c244d8c]{text-decoration:none;cursor:pointer}.consignee-table td .btn-link[_v-4c244d8c]:hover,.product-table td .btn-link[_v-4c244d8c]:hover{text-decoration:underline}.show-right[_v-4c244d8c]{margin-left:20px}","",{version:3,sources:["/./src/views/order/edit.vue.style"],names:[],mappings:"AAurBA,0DACA,kBAAA,CACA,AAEA,gIACA,kBAAA,AACA,qBAAA,CACA,AAEA,oFACA,qBAAA,AACA,cAAA,CACA,AAEA,gGACA,yBAAA,CACA,AAEA,yBACA,gBAAA,CACA",file:"edit.vue",sourcesContent:['<!-- edit.vue -->\n<template>\n    <div class="container-fluid">\n        <ul class="breadcrumb">\n            <li>订单系统</li>\n            <li>订单管理</li>\n            <li>编辑订单：<a class="btn-link" v-link="{path:\'/order/detail/\'+orderId}" v-if="orderId">{{orderId}}</a></li>\n        </ul>\n        <form class="form-inline pull-right" style="margin-top: 16px;" v-if="orderId && permissionList.assignManager">\n            <label>客户经理/客服：</label>\n            <select class="form-control input-sm" style="width:100px;" v-model="manager.id" number @change="changeManager">\n                <option v-for="manager of managerList" :value="manager.id">{{manager.display_name}}</option>\n            </select>\n        </form>\n        <h3>编辑订单</h3>\n        <p class="clearfix"></p>\n        <div class="panel panel-default">\n            <div class="panel-heading">商品清单</div>\n            <div class="panel-body">\n                <table class="table table-bordered table-hover product-table">\n                    <thead>\n                        <tr>\n                            <th style="width:6%;">ID</th>\n                            <th style="width:15%;">产品名称</th>\n                            <th style="width:25%;">参数</th>\n                            <th style="width:10%;">数量</th>\n                            <th style="width:10%;">价格(元)</th>\n                            <th style="width:22%;">到货时间要求</th>\n                            <th style="width:12%;">操作</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="item of orderItems">\n                            <td>{{item.id}}</td>\n                            <template v-if="item.is_custom">\n                                <td>{{item.detail.name}}</td>\n                                <td>\n                                    <a class="btn-link" @click="showProductDetailDialog(item)">\n                                        {{item.detail.size}}{{(item.detail.size && (item.detail.caizhi || item.detail.others)) ? \'_\' : \'\'}}{{item.detail.caizhi}}{{(item.detail.caizhi && item.detail.others) ? \'_\' : \'\'}}{{item.detail.others}}\n                                    </a>\n                                </td>\n                                <td>{{item.detail.quantity}}</td>\n                            </template>\n                            <template v-else>\n                                <td>\n                                    <a class="btn-link" :href="\'http://www.soyyin.com/product?id=\'+item.product_id+\'#\'+item.brief" target="_blank">{{item.title}}</a>\n                                </td>\n                                <td>{{item.brief}}</td>\n                                <td>{{item.quantity}}</td>\n                            </template>\n                            <td>{{item.price === 0 ? \'暂无\' : \'\'}}{{(item.price === 0 ? \'\' : item.price ) | realPrice}}</td>\n                            <td>{{item.arrival_time}}</td>\n                            <td>\n                                <a class="btn-link" @click="editProduct(item)">编辑</a>\n                                <a class="btn-link show-right" v-if="((!isPayed) && item.produce_status === \'NOT_PRODUCE\')" @click="showDeleteProductDialog(item)">删除</a>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n                <a class="btn btn-info btn-sm" v-if="orderId && !isPayed" @click="addProduct">添加商品</a>\n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-heading">收货人信息</div>\n            <div class="panel-body">\n                <table class="table table-bordered table-hover consignee-table">\n                    <thead>\n                        <tr>\n                            <th style="width:10%;">姓名</th>\n                            <th style="width:12%;">手机号</th>\n                            <th style="width:28%;">地址</th>\n                            <th style="width:8%;">邮编</th>\n                            <th style="width:30%;">收货备注</th>\n                            <th style="width:12%;">操作</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="item of consignees">\n                            <td>{{item.name}}</td>\n                            <td>{{item.phone}}</td>\n                            <td>\n                                <span v-for="region of item.regions">{{region.name}}</span>\n                                {{item.address}}\n                            </td>\n                            <td>{{item.post_code}}</td>\n                            <td>{{item.remark}}</td>\n                            <td>\n                                <a class="btn-link" @click="editConsignee(item)">编辑</a>\n                                <a class="btn-link show-right" v-if="item.logistics.length === 0" @click="showDeleteConsigneeDialog(item)">删除</a>  \n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n                <a class="btn btn-info btn-sm" v-if="orderId" @click="addConsignee">增加收货地址</a>\n            </div>\n        </div>\n        <div class="row">\n            <div class="col-lg-7">\n                <div class="panel panel-default">\n                    <div class="panel-heading">付款方式</div>\n                    <div class="panel-body">\n                        <form class="form-horizontal">\n                            <div class="radio">\n                                <label>\n                                    <input type="radio" id="payment1" :disabled="orderBasic.status !== \'SUBMITTED\'" v-model="paymentData.payment" value="ONLINE">\n                                    在线支付\n                                </label>\n                            </div>\n                            <div class="radio form-inline">\n                                <label>\n                                    <input type="radio" id="payment2" :disabled="orderBasic.status !== \'SUBMITTED\'" v-model="paymentData.payment" value="CASH_ON_DELIVERY">\n                                    货到付款\n                                </label>\n                                <input class="form-control input-sm" style="width:300px;margin-left:10px;" type="text" placeholder="付款时间及金额说明(选填)" v-model="paymentData.remark">\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n            <div class="col-lg-5">\n                <div class="panel panel-default">\n                    <div class="panel-heading">订单日期</div>\n                    <div class="panel-body">\n                        <div class="form-group">\n                            <label class="control-label" for="orderDate">请选择日期<span class="text-danger">*</span></label>\n                            <input class="form-control input-sm" id="orderDate" style="width:200px;" readOnly="true" v-model="orderDate | datePickerFilter">\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="panel panel-default">\n            <div class="panel-heading">客户信息</div>\n            <div class="panel-body">\n                <form class="form-horizontal">\n                    <div class="col-xs-2">\n                        <label class="control-label" for="customerName">客户名称<span class="text-danger">*</span></label>\n                        <input class="form-control input-sm" id="customerName" type="text" v-model="orderBasic.customer.name">\n                    </div>\n                    <div class="col-xs-2">\n                        <label class="control-label" for="customerPhone">联系电话</label>\n                        <input class="form-control input-sm" id="customerPhone" type="text" v-model="orderBasic.customer.phone">\n                    </div>\n                    <div class="col-xs-2">\n                        <label class="control-label" for="customerQQ">QQ</label>\n                        <input class="form-control input-sm" id="customerQQ" type="text" v-model="orderBasic.customer.qq">\n                    </div>\n                    <div class="col-xs-2">\n                        <label class="control-label" for="customerCompany">公司</label>\n                        <input class="form-control input-sm" id="customerCompany" type="text" v-model="orderBasic.customer.company">\n                    </div>\n                </form>\n            </div>\n        </div>\n        <edit-invoice-info-component :edit-invoice-checked.sync="editInvoiceChecked" :invoice-data="invoiceInfo" :consignees="consigneesForInvoiceInfo"></edit-invoice-info-component>\n        <div class="panel panel-default">\n            <div class="panel-heading">其他信息</div>\n            <div class="panel-body">\n                <div class="form-group col-md-8">\n                    <label class="control-label" for="orderRemark">备注：</label>\n                    <textarea class="form-control" style="height:100px;" id="orderRemark" v-model="orderBasic.remark"></textarea>\n                </div>\n            </div>\n        </div>\n        <div>\n            <a class="btn btn-info btn-lg pull-right" v-if="orderId" @click="editOrder">确认修改</a>\n        </div>\n        <edit-or-add-product-dialog :show.sync="dataForEditOrAddProductDialog.show" :data="dataForEditOrAddProductDialog.data"></edit-or-add-product-dialog>\n        <product-detail-dialog :show.sync="dataForProductDetailDialog.show" :detail="dataForProductDetailDialog.detail"></product-detail-dialog>\n        <edit-or-add-consignee-dialog :show.sync="dataForEditOrAddConsigneeDialog.show" :data="dataForEditOrAddConsigneeDialog.data"></edit-or-add-consignee-dialog>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n        <popup-dialog :show-dialog.sync="dataForPopupDialog.show" :dialog-title="dataForPopupDialog.title" :dialog-content="dataForPopupDialog.content"></popup-dialog>\n    </div>\n</template>\n\n<script>\nimport Vue from \'vue\'\nimport editInvoiceInfoComponent from \'./comp/editInvoiceInfoComponent.vue\'\nimport popupDialog from \'../../components/popupDialog.vue\'\nimport productDetailDialog from \'./comp/productDetailDialog.vue\'\nimport popupTips from \'../../components/popupTips.vue\'\nimport editOrAddProductDialog from \'./comp/editOrAddProductDialog.vue\'\nimport editOrAddConsigneeDialog from \'./comp/editOrAddConsigneeDialog.vue\'\nimport { callback } from \'../../store/index.js\'\nimport { orderValidator } from \'../../store/dataValidator.js\'\nimport { permissionValidator } from \'../../store/rolePermission.js\'\nimport $ from \'jquery\'\n\nconst DELETE_PRODUCT = "DELETE_PRODUCT";\nconst DELETE_CONSIGNEEITEM = "DELETE_CONSIGNEEITEM";\n\nexport default {\n    name: \'OrderEditView\',\n    components: {\n        editInvoiceInfoComponent,\n        productDetailDialog,\n        popupTips,\n        popupDialog,\n        editOrAddProductDialog,\n        editOrAddConsigneeDialog,\n    },\n    route: {\n        data({to}) {\n            var orderId = to.params.id\n            if(!orderId) {\n                this.$route.router.go({ path: \'/order/list\' });\n            }\n            this.getOrderDetial(orderId);\n            if (this.permissionList.assignManager) {\n                this.getManager();\n            }\n        }\n    },\n    ready() {\n        $("#orderDate").datetimepicker({\n            format: "yyyy-mm-dd",\n            language: "zh-CN",\n            todayHighlight: true,\n            autoclose: true,\n            minView: 2,\n            endDate: new Date(),\n        });\n    },\n    computed: {\n        isPayed() {\n            if (!this.orderBasic) {\n                return false;\n            }\n            if (this.orderBasic.status == \'DELIVERY_PAID\' || this.orderBasic.status == \'ONLINE_PAID\' || this.orderBasic.status == \'ONLINE_CONFIRMED\' || this.orderBasic.status == \'FINISHED\') {\n                return true;\n            }\n            return false;\n        },\n        consigneesForInvoiceInfo() {\n            var result = [];\n            for (let i = 0; i < this.consignees.length; i++) {\n                var consignee = {\n                    name: this.consignees[i].name,\n                    phone: this.consignees[i].phone,\n                    address: this.consignees[i].address,\n                };\n                consignee.fullRegionName = \'\';\n                for (let j = 0; j < this.consignees[i].regions.length; j++) {\n                    consignee.fullRegionName += this.consignees[i].regions[j].name;\n                }\n                result.push(consignee);\n            }\n            return result;\n        },\n    },\n    data() {\n        return {\n            orderId: \'\',\n            orderBasic: {\n                customer: {\n                },\n            },\n            manager: {},\n            orderItems: [],\n            consignees: [],\n            paymentData: {},\n            editInvoiceChecked: false,\n            invoiceInfo: {\n                amount: \'\',\n                content: \'\',\n                title: \'\',\n                zengzhishui: undefined,\n                remark: \'\',\n                consignee_name: \'\',\n                consignee_phone: \'\',\n                address: \'\',\n            },\n            orderDate: 0,\n            permissionList: {\n                assignManager: permissionValidator.orderSystem.order.assignManager(),\n            },\n            managerList: [],\n            dataForProductDetailDialog: {\n                show: false,\n                detail: {\n                    name: \'\',\n                    quantity: \'\',\n                    size: \'\',\n                    caizhi: \'\',\n                    others:\'\',\n                }\n            },\n            dataForEditOrAddProductDialog: {\n                show: false,\n                data: {\n                    orderId: \'\',\n                    orderProductId: \'\',\n                    isCustom: true,\n                    custom: {\n                        name: \'\',\n                        quantity: \'\',\n                        size: \'\',\n                        caizhi: \'\',\n                        others: \'\',\n                    },\n                    standard: null,\n                    price: \'\',\n                    arrival_time: \'\',\n                    isAllEditable: true,\n                },\n            },\n            dataForEditOrAddConsigneeDialog: {\n                show: false,\n                data: {\n                    orderId: \'\',\n                    orderConsigneeId: \'\',\n                    name: \'\',\n                    phone: \'\',\n                    regions: [],\n                    region_id: 0,\n                    address: \'\',\n                    post_code: \'\',\n                    remark: \'\',\n                },\n            },\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n            dataForPopupDialog: {\n                show: false,\n                title: \'删除确认\',\n                content: \'\',\n            },\n        }\n    },\n    events: {\n        \'click-positive-button\'() {\n            if (this.dataForPopupDialog.dialogId === DELETE_PRODUCT) {\n                this.deleteProduct(this.dataForPopupDialog.passingData);\n            } else if (this.dataForPopupDialog.dialogId === DELETE_CONSIGNEEITEM) {\n                this.deleteConsignee(this.dataForPopupDialog.passingData);\n            }\n        },\n        \'add-custom-product\'(result) {\n            var orderItem = {\n                id: result.id,\n                is_custom: true,\n                price: result.data.price,\n                detail: result.data.detail,\n                arrival_time: result.data.arrival_time,\n                produce_status: \'NOT_PRODUCE\',\n            };\n            this.orderItems.push(orderItem);\n        },\n        \'edit-custom-product\'(result) {\n            var orderItem = this.findOrderItem(result.id);\n            if (orderItem) {\n                orderItem.detail = result.data.detail;\n                orderItem.price = result.data.price;\n                if (orderItem.arrival_time === undefined) {\n                    Vue.set(orderItem, \'arrival_time\', result.data.arrival_time);\n                } else {\n                    orderItem.arrival_time = result.data.arrival_time;\n                }\n            }\n        },\n        \'edit-product\'(result) {\n            var orderItem = this.findOrderItem(result.id);\n            if (orderItem) {\n                orderItem.quantity = result.data.quantity;\n                orderItem.price = result.data.price;\n                if (orderItem.arrival_time === undefined) {\n                    Vue.set(orderItem, \'arrival_time\', result.data.arrival_time);\n                } else {\n                    orderItem.arrival_time = result.data.arrival_time;\n                }\n            }\n        },\n        \'edit-arrival-time\'(result) {\n            var orderItem = this.findOrderItem(result.id);\n            if (orderItem) {\n                if (orderItem.arrival_time === undefined) {\n                    Vue.set(orderItem, \'arrival_time\', result.data.arrival_time);\n                } else {\n                    orderItem.arrival_time = result.data.arrival_time;\n                }\n            }\n        },\n        \'add-consignee\'(result) {\n            var consigneeItem = {\n                id: result.id,\n                name: result.data.name,\n                phone: result.data.phone,\n                region_id: result.data.region_id,\n                address: result.data.address,\n                post_code: result.data.post_code,\n                remark: result.data.remark,\n                regions: result.data.regions,\n                logistics: [],\n            };\n            this.consignees.push(consigneeItem);\n        },\n        \'edit-consignee\'(result) {\n            var consigneeItem = this.findConsigneeItem(result.id);\n            if (consigneeItem) {\n                consigneeItem.name = result.data.name;\n                consigneeItem.phone = result.data.phone;\n                consigneeItem.region_id = result.data.region_id;\n                consigneeItem.address = result.data.address;\n                if (consigneeItem.post_code === undefined) {\n                    Vue.set(consigneeItem, \'post_code\', result.data.post_code);\n                } else {\n                    consigneeItem.post_code = result.data.post_code;\n                }\n                if (consigneeItem.remark === undefined) {\n                    Vue.set(consigneeItem, \'remark\', result.data.remark);\n                } else {\n                    consigneeItem.remark = result.data.remark;\n                }\n                consigneeItem.regions = result.data.regions;\n            }\n        },\n    },\n    methods: {\n        findOrderItem(id) {\n            for (var i = 0; i < this.orderItems.length; i++) {\n                if (this.orderItems[i].id === id) {\n                    return this.orderItems[i];\n                }\n            }\n        },\n        findConsigneeItem(id) {\n            for (var i = 0; i < this.consignees.length; i++) {\n                if (this.consignees[i].id === id) {\n                    return this.consignees[i];\n                }\n            }\n        },\n        showPupupTips(title, content, type = \'danger\') {\n            this.dataForPopupTips.show = true;\n            this.dataForPopupTips.type = type;\n            this.dataForPopupTips.title = title;\n            this.dataForPopupTips.content = content;\n        },\n        getManager() {\n            var url = \'/api/v2/admin/permissions/manager-list\';\n            this.$http.get(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.managerList = response.data.data;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        changeManager(event) {\n            var url = \'/api/v2/admin/orders/set-manager?order_id=\' + this.orderId + \'&manager_id=\' + this.manager.id;\n            this.$http.put(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.showPupupTips(\'操作成功\', \'修改客户经理/客服成功\', \'success\');\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        getOrderDetial(id) {\n            var url = \'/api/v2/admin/orders/detail-v2?id=\' + id;\n            this.$http.get(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) { \n                    this.orderId = id;   \n                    this.orderBasic = response.data.basic;\n                    if (this.orderBasic.manager) {\n                        this.manager = this.orderBasic.manager;\n                    }\n                    this.orderItems =response.data.items;\n                    this.consignees = response.data.consignees;\n                    this.paymentData = response.data.payment;\n                    if (response.data.invoice) {\n                        this.editInvoiceChecked = true;\n                        this.invoiceInfo = response.data.invoice;\n                    }\n                    this.orderDate = response.data.time;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        validateCustomer() {\n            var result = orderValidator.validateCustomerName(this.orderBasic.customer.name);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        validateInvoiceInfo() {\n            if (this.editInvoiceChecked) {\n                var result = orderValidator.validateInvoiceAmount(this.invoiceInfo.amount);\n                if (!result.ok) {\n                    return result.errorMsg;\n                }\n                var infoName = ["开票内容", "开票抬头", "发票收货人", "发票收货人联系方式", "发票收货人收货地址"];\n                var infoData = [this.invoiceInfo.content, this.invoiceInfo.title, this.invoiceInfo.consignee_name, this.invoiceInfo.consignee_phone, this.invoiceInfo.address];\n                for (let i = 0; i < infoName.length; i++) {\n                    result = orderValidator.validateInvoiceItem(infoName[i], infoData[i]);\n                    if (!result.ok) {\n                        return result.errorMsg;\n                    }\n                }\n                if (this.invoiceInfo.zengzhishui) {\n                    infoName = ["发票信息中纳税人识别号", "发票信息中注册地址", "发票信息中电话", "发票信息中开户行", "发票信息中账号"];\n                    infoData = [this.invoiceInfo.zengzhishui.identifier, this.invoiceInfo.zengzhishui.address, this.invoiceInfo.zengzhishui.phone, this.invoiceInfo.zengzhishui.account, this.invoiceInfo.zengzhishui.bank];\n                    for (let i = 0; i < infoName.length; i++) {\n                        result = orderValidator.validateInvoiceItem(infoName[i], infoData[i]);\n                        if (!result.ok) {\n                            return result.errorMsg;\n                        }\n                    }\n                }\n            }\n            return;\n        },\n        editOrder() {\n            if (!this.orderDate) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = \'订单日期不能为空\';\n                return;\n            }\n            var result = this.validateCustomer();\n            if (result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                return;\n            }\n            result = this.validateInvoiceInfo();\n            if (result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                return;\n            }\n            var url = \'/api/v2/admin/orders/edit-basic?id=\' + this.orderId;\n            var data = {\n                payment: this.paymentData.payment,\n                payment_remark: this.paymentData.remark,\n                customer: this.orderBasic.customer,\n                remark: this.orderBasic.remark,\n                time: this.orderDate,\n            };\n            if (this.editInvoiceChecked) {\n                data.invoice = this.invoiceInfo;\n            }\n            this.$http.put(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.$route.router.go({ path: \'/order/detail/\' + this.orderId});\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        addProduct() {\n            this.dataForEditOrAddProductDialog.show = true;\n            this.dataForEditOrAddProductDialog.data.orderId = this.orderId;\n            this.dataForEditOrAddProductDialog.data.orderProductId = \'\';\n            this.dataForEditOrAddProductDialog.data.isCustom = true;\n            this.dataForEditOrAddProductDialog.data.custom = {\n                name: \'\',\n                quantity: \'\',\n                size: \'\',\n                caizhi: \'\',\n                others:\'\',\n            };\n            this.dataForEditOrAddProductDialog.data.standard = null;\n            this.dataForEditOrAddProductDialog.data.price = \'\';\n            this.dataForEditOrAddProductDialog.data.arrival_time = \'\';\n            this.dataForEditOrAddProductDialog.data.isAllEditable = true;\n        },\n        editProduct(item) {\n            this.dataForEditOrAddProductDialog.show = true;\n            this.dataForEditOrAddProductDialog.data.orderId = this.orderId;\n            this.dataForEditOrAddProductDialog.data.orderProductId = item.id;\n            if (item.is_custom) {\n                this.dataForEditOrAddProductDialog.data.isCustom = true;\n                this.dataForEditOrAddProductDialog.data.custom = {\n                    name: item.detail.name,\n                    quantity: item.detail.quantity,\n                    size: item.detail.size,\n                    caizhi: item.detail.caizhi,\n                    others: item.detail.others,\n                };\n                this.dataForEditOrAddProductDialog.data.standard = null;\n            } else {\n                this.dataForEditOrAddProductDialog.data.isCustom = false;\n                this.dataForEditOrAddProductDialog.data.custom = null;\n                this.dataForEditOrAddProductDialog.data.standard = {\n                    quantity: item.quantity,\n                };\n            }\n            this.dataForEditOrAddProductDialog.data.price = item.price;\n            this.dataForEditOrAddProductDialog.data.arrival_time = item.arrival_time;\n            this.dataForEditOrAddProductDialog.data.isAllEditable = ((!this.isPayed) && item.produce_status === \'NOT_PRODUCE\');\n        },\n        showProductDetailDialog(item) {\n            this.dataForProductDetailDialog.show = true;\n            this.dataForProductDetailDialog.detail = {\n                name: item.detail.name,\n                quantity: item.detail.quantity,\n                size: item.detail.size,\n                caizhi: item.detail.caizhi,\n                others: item.detail.others,\n            }\n        },\n        showDeleteProductDialog(item) {\n            this.dataForPopupDialog.show = true;\n            this.dataForPopupDialog.content = "确定删除此条商品？";\n            this.dataForPopupDialog.dialogId = DELETE_PRODUCT;\n            this.dataForPopupDialog.passingData = item;\n        },\n        deleteProduct(item) {\n            var url = \'/api/v2/admin/orders/remove-item-v2?item_id=\' + item.id;\n            this.$http.delete(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.orderItems.$remove(item);\n                    this.showPupupTips(\'操作成功\', \'删除商品成功\', \'success\');\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        addConsignee() {\n            this.dataForEditOrAddConsigneeDialog.show = true;\n            this.dataForEditOrAddConsigneeDialog.data.orderId = this.orderId;\n            this.dataForEditOrAddConsigneeDialog.data.orderConsigneeId = \'\';\n            this.dataForEditOrAddConsigneeDialog.data.name = \'\';\n            this.dataForEditOrAddConsigneeDialog.data.phone = \'\';\n            this.dataForEditOrAddConsigneeDialog.data.regions = [];\n            this.dataForEditOrAddConsigneeDialog.data.region_id = 0;\n            this.dataForEditOrAddConsigneeDialog.data.address = \'\';\n            this.dataForEditOrAddConsigneeDialog.data.post_code = \'\';\n            this.dataForEditOrAddConsigneeDialog.data.remark = \'\';\n        },\n        editConsignee(item) {\n            var regions = [];\n            for (var i = 0; i < item.regions.length; i++) {\n                regions.push(item.regions[i].id);\n            }\n            this.dataForEditOrAddConsigneeDialog.show = true;\n            this.dataForEditOrAddConsigneeDialog.data.orderId = this.orderId;\n            this.dataForEditOrAddConsigneeDialog.data.orderConsigneeId = item.id;\n            this.dataForEditOrAddConsigneeDialog.data.name = item.name;\n            this.dataForEditOrAddConsigneeDialog.data.phone = item.phone;\n            this.dataForEditOrAddConsigneeDialog.data.regions = regions;\n            this.dataForEditOrAddConsigneeDialog.data.region_id = item.region_id;\n            this.dataForEditOrAddConsigneeDialog.data.address = item.address;\n            this.dataForEditOrAddConsigneeDialog.data.post_code = item.post_code;\n            this.dataForEditOrAddConsigneeDialog.data.remark = item.remark;\n        },\n        showDeleteConsigneeDialog(item) {\n            this.dataForPopupDialog.show = true;\n            this.dataForPopupDialog.content = "确定删除此收货人？";\n            this.dataForPopupDialog.dialogId = DELETE_CONSIGNEEITEM;\n            this.dataForPopupDialog.passingData = item;\n        },\n        deleteConsignee(item) {\n            var url = \'/api/v2/admin/orders/remove-consignee?id=\' + item.id;\n            this.$http.delete(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.consignees.$remove(item);\n                    this.showPupupTips(\'操作成功\', \'删除收货人成功\', \'success\');\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n    }\n}\n</script>\n\n<style scoped>\n.product-table, .consignee-table {\n    table-layout: fixed;\n}\n\n.product-table th, .product-table td, .consignee-table th, .consignee-table td {\n    text-align: center;\n    vertical-align: middle;\n}\n\n.product-table td .btn-link, .consignee-table td .btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.product-table td .btn-link:hover, .consignee-table td .btn-link:hover {\n    text-decoration: underline;\n}\n\n.show-right{\n    margin-left: 20px;\n}\n</style>'],
sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(8),o=i(a),s=n(62),r=i(s),d=n(70),l=i(d),c=n(75),p=i(c),u=n(80),v=i(u),h=n(148),f=i(h),m=n(153),b=i(m),g=n(46),_=n(85),y=n(43),A=n(4),I=i(A),D="DELETE_PRODUCT",w="DELETE_CONSIGNEEITEM";e.default={name:"OrderEditView",components:{editInvoiceInfoComponent:r.default,productDetailDialog:p.default,popupTips:v.default,popupDialog:l.default,editOrAddProductDialog:f.default,editOrAddConsigneeDialog:b.default},route:{data:function(t){var e=t.to,n=e.params.id;n||this.$route.router.go({path:"/order/list"}),this.getOrderDetial(n),this.permissionList.assignManager&&this.getManager()}},ready:function(){(0,I.default)("#orderDate").datetimepicker({format:"yyyy-mm-dd",language:"zh-CN",todayHighlight:!0,autoclose:!0,minView:2,endDate:new Date})},computed:{isPayed:function(){return!!this.orderBasic&&("DELIVERY_PAID"==this.orderBasic.status||"ONLINE_PAID"==this.orderBasic.status||"ONLINE_CONFIRMED"==this.orderBasic.status||"FINISHED"==this.orderBasic.status)},consigneesForInvoiceInfo:function(){for(var t=[],e=0;e<this.consignees.length;e++){var n={name:this.consignees[e].name,phone:this.consignees[e].phone,address:this.consignees[e].address};n.fullRegionName="";for(var i=0;i<this.consignees[e].regions.length;i++)n.fullRegionName+=this.consignees[e].regions[i].name;t.push(n)}return t}},data:function(){return{orderId:"",orderBasic:{customer:{}},manager:{},orderItems:[],consignees:[],paymentData:{},editInvoiceChecked:!1,invoiceInfo:{amount:"",content:"",title:"",zengzhishui:void 0,remark:"",consignee_name:"",consignee_phone:"",address:""},orderDate:0,permissionList:{assignManager:y.permissionValidator.orderSystem.order.assignManager()},managerList:[],dataForProductDetailDialog:{show:!1,detail:{name:"",quantity:"",size:"",caizhi:"",others:""}},dataForEditOrAddProductDialog:{show:!1,data:{orderId:"",orderProductId:"",isCustom:!0,custom:{name:"",quantity:"",size:"",caizhi:"",others:""},standard:null,price:"",arrival_time:"",isAllEditable:!0}},dataForEditOrAddConsigneeDialog:{show:!1,data:{orderId:"",orderConsigneeId:"",name:"",phone:"",regions:[],region_id:0,address:"",post_code:"",remark:""}},dataForPopupTips:{show:!1,type:"danger",title:"",content:""},dataForPopupDialog:{show:!1,title:"删除确认",content:""}}},events:{"click-positive-button":function(){this.dataForPopupDialog.dialogId===D?this.deleteProduct(this.dataForPopupDialog.passingData):this.dataForPopupDialog.dialogId===w&&this.deleteConsignee(this.dataForPopupDialog.passingData)},"add-custom-product":function(t){var e={id:t.id,is_custom:!0,price:t.data.price,detail:t.data.detail,arrival_time:t.data.arrival_time,produce_status:"NOT_PRODUCE"};this.orderItems.push(e)},"edit-custom-product":function(t){var e=this.findOrderItem(t.id);e&&(e.detail=t.data.detail,e.price=t.data.price,void 0===e.arrival_time?o.default.set(e,"arrival_time",t.data.arrival_time):e.arrival_time=t.data.arrival_time)},"edit-product":function(t){var e=this.findOrderItem(t.id);e&&(e.quantity=t.data.quantity,e.price=t.data.price,void 0===e.arrival_time?o.default.set(e,"arrival_time",t.data.arrival_time):e.arrival_time=t.data.arrival_time)},"edit-arrival-time":function(t){var e=this.findOrderItem(t.id);e&&(void 0===e.arrival_time?o.default.set(e,"arrival_time",t.data.arrival_time):e.arrival_time=t.data.arrival_time)},"add-consignee":function(t){var e={id:t.id,name:t.data.name,phone:t.data.phone,region_id:t.data.region_id,address:t.data.address,post_code:t.data.post_code,remark:t.data.remark,regions:t.data.regions,logistics:[]};this.consignees.push(e)},"edit-consignee":function(t){var e=this.findConsigneeItem(t.id);e&&(e.name=t.data.name,e.phone=t.data.phone,e.region_id=t.data.region_id,e.address=t.data.address,void 0===e.post_code?o.default.set(e,"post_code",t.data.post_code):e.post_code=t.data.post_code,void 0===e.remark?o.default.set(e,"remark",t.data.remark):e.remark=t.data.remark,e.regions=t.data.regions)}},methods:{findOrderItem:function(t){for(var e=0;e<this.orderItems.length;e++)if(this.orderItems[e].id===t)return this.orderItems[e]},findConsigneeItem:function(t){for(var e=0;e<this.consignees.length;e++)if(this.consignees[e].id===t)return this.consignees[e]},showPupupTips:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"danger";this.dataForPopupTips.show=!0,this.dataForPopupTips.type=n,this.dataForPopupTips.title=t,this.dataForPopupTips.content=e},getManager:function(){var t=this,e="/api/v2/admin/permissions/manager-list";this.$http.get(e).then(function(e){e.data.result&&0!==e.data.result?g.callback.success(e.data):t.managerList=e.data.data},function(t){g.callback.error(t)})},changeManager:function(t){var e=this,n="/api/v2/admin/orders/set-manager?order_id="+this.orderId+"&manager_id="+this.manager.id;this.$http.put(n).then(function(t){t.data.result&&0!==t.data.result?g.callback.success(t.data):e.showPupupTips("操作成功","修改客户经理/客服成功","success")},function(t){g.callback.error(t)})},getOrderDetial:function(t){var e=this,n="/api/v2/admin/orders/detail-v2?id="+t;this.$http.get(n).then(function(n){n.data.result&&0!==n.data.result?g.callback.success(n.data):(e.orderId=t,e.orderBasic=n.data.basic,e.orderBasic.manager&&(e.manager=e.orderBasic.manager),e.orderItems=n.data.items,e.consignees=n.data.consignees,e.paymentData=n.data.payment,n.data.invoice&&(e.editInvoiceChecked=!0,e.invoiceInfo=n.data.invoice),e.orderDate=n.data.time)},function(t){g.callback.error(t)})},validateCustomer:function(){var t=_.orderValidator.validateCustomerName(this.orderBasic.customer.name);if(!t.ok)return t.errorMsg},validateInvoiceInfo:function(){if(this.editInvoiceChecked){var t=_.orderValidator.validateInvoiceAmount(this.invoiceInfo.amount);if(!t.ok)return t.errorMsg;for(var e=["开票内容","开票抬头","发票收货人","发票收货人联系方式","发票收货人收货地址"],n=[this.invoiceInfo.content,this.invoiceInfo.title,this.invoiceInfo.consignee_name,this.invoiceInfo.consignee_phone,this.invoiceInfo.address],i=0;i<e.length;i++)if(t=_.orderValidator.validateInvoiceItem(e[i],n[i]),!t.ok)return t.errorMsg;if(this.invoiceInfo.zengzhishui){e=["发票信息中纳税人识别号","发票信息中注册地址","发票信息中电话","发票信息中开户行","发票信息中账号"],n=[this.invoiceInfo.zengzhishui.identifier,this.invoiceInfo.zengzhishui.address,this.invoiceInfo.zengzhishui.phone,this.invoiceInfo.zengzhishui.account,this.invoiceInfo.zengzhishui.bank];for(var a=0;a<e.length;a++)if(t=_.orderValidator.validateInvoiceItem(e[a],n[a]),!t.ok)return t.errorMsg}}},editOrder:function(){var t=this;if(!this.orderDate)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",void(this.dataForPopupTips.content="订单日期不能为空");var e=this.validateCustomer();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",void(this.dataForPopupTips.content=e);if(e=this.validateInvoiceInfo())return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",void(this.dataForPopupTips.content=e);var n="/api/v2/admin/orders/edit-basic?id="+this.orderId,i={payment:this.paymentData.payment,payment_remark:this.paymentData.remark,customer:this.orderBasic.customer,remark:this.orderBasic.remark,time:this.orderDate};this.editInvoiceChecked&&(i.invoice=this.invoiceInfo),this.$http.put(n,i).then(function(e){e.data.result&&0!==e.data.result?g.callback.success(e.data):t.$route.router.go({path:"/order/detail/"+t.orderId})},function(t){g.callback.error(t)})},addProduct:function(){this.dataForEditOrAddProductDialog.show=!0,this.dataForEditOrAddProductDialog.data.orderId=this.orderId,this.dataForEditOrAddProductDialog.data.orderProductId="",this.dataForEditOrAddProductDialog.data.isCustom=!0,this.dataForEditOrAddProductDialog.data.custom={name:"",quantity:"",size:"",caizhi:"",others:""},this.dataForEditOrAddProductDialog.data.standard=null,this.dataForEditOrAddProductDialog.data.price="",this.dataForEditOrAddProductDialog.data.arrival_time="",this.dataForEditOrAddProductDialog.data.isAllEditable=!0},editProduct:function(t){this.dataForEditOrAddProductDialog.show=!0,this.dataForEditOrAddProductDialog.data.orderId=this.orderId,this.dataForEditOrAddProductDialog.data.orderProductId=t.id,t.is_custom?(this.dataForEditOrAddProductDialog.data.isCustom=!0,this.dataForEditOrAddProductDialog.data.custom={name:t.detail.name,quantity:t.detail.quantity,size:t.detail.size,caizhi:t.detail.caizhi,others:t.detail.others},this.dataForEditOrAddProductDialog.data.standard=null):(this.dataForEditOrAddProductDialog.data.isCustom=!1,this.dataForEditOrAddProductDialog.data.custom=null,this.dataForEditOrAddProductDialog.data.standard={quantity:t.quantity}),this.dataForEditOrAddProductDialog.data.price=t.price,this.dataForEditOrAddProductDialog.data.arrival_time=t.arrival_time,this.dataForEditOrAddProductDialog.data.isAllEditable=!this.isPayed&&"NOT_PRODUCE"===t.produce_status},showProductDetailDialog:function(t){this.dataForProductDetailDialog.show=!0,this.dataForProductDetailDialog.detail={name:t.detail.name,quantity:t.detail.quantity,size:t.detail.size,caizhi:t.detail.caizhi,others:t.detail.others}},showDeleteProductDialog:function(t){this.dataForPopupDialog.show=!0,this.dataForPopupDialog.content="确定删除此条商品？",this.dataForPopupDialog.dialogId=D,this.dataForPopupDialog.passingData=t},deleteProduct:function(t){var e=this,n="/api/v2/admin/orders/remove-item-v2?item_id="+t.id;this.$http.delete(n).then(function(n){n.data.result&&0!==n.data.result?g.callback.success(n.data):(e.orderItems.$remove(t),e.showPupupTips("操作成功","删除商品成功","success"))},function(t){g.callback.error(t)})},addConsignee:function(){this.dataForEditOrAddConsigneeDialog.show=!0,this.dataForEditOrAddConsigneeDialog.data.orderId=this.orderId,this.dataForEditOrAddConsigneeDialog.data.orderConsigneeId="",this.dataForEditOrAddConsigneeDialog.data.name="",this.dataForEditOrAddConsigneeDialog.data.phone="",this.dataForEditOrAddConsigneeDialog.data.regions=[],this.dataForEditOrAddConsigneeDialog.data.region_id=0,this.dataForEditOrAddConsigneeDialog.data.address="",this.dataForEditOrAddConsigneeDialog.data.post_code="",this.dataForEditOrAddConsigneeDialog.data.remark=""},editConsignee:function(t){for(var e=[],n=0;n<t.regions.length;n++)e.push(t.regions[n].id);this.dataForEditOrAddConsigneeDialog.show=!0,this.dataForEditOrAddConsigneeDialog.data.orderId=this.orderId,this.dataForEditOrAddConsigneeDialog.data.orderConsigneeId=t.id,this.dataForEditOrAddConsigneeDialog.data.name=t.name,this.dataForEditOrAddConsigneeDialog.data.phone=t.phone,this.dataForEditOrAddConsigneeDialog.data.regions=e,this.dataForEditOrAddConsigneeDialog.data.region_id=t.region_id,this.dataForEditOrAddConsigneeDialog.data.address=t.address,this.dataForEditOrAddConsigneeDialog.data.post_code=t.post_code,this.dataForEditOrAddConsigneeDialog.data.remark=t.remark},showDeleteConsigneeDialog:function(t){this.dataForPopupDialog.show=!0,this.dataForPopupDialog.content="确定删除此收货人？",this.dataForPopupDialog.dialogId=w,this.dataForPopupDialog.passingData=t},deleteConsignee:function(t){var e=this,n="/api/v2/admin/orders/remove-consignee?id="+t.id;this.$http.delete(n).then(function(n){n.data.result&&0!==n.data.result?g.callback.success(n.data):(e.consignees.$remove(t),e.showPupupTips("操作成功","删除收货人成功","success"))},function(t){g.callback.error(t)})}}}},function(t,e,n){var i,a;n(149),i=n(151),a=n(152),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(150);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-543191ba]{height:100%}.modal-dialog[_v-543191ba]{top:20%}","",{version:3,sources:["/./src/views/order/comp/editOrAddProductDialog.vue.style"],names:[],mappings:"AAoQA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"editOrAddProductDialog.vue",sourcesContent:['<!-- editOrAddProductDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">{{title}}</h4>\n                </div>\n                <div class="modal-body">\n                    <form class="form-horizontal">\n                        <template v-if="data.isCustom">\n                            <div class="form-group">\n                                <label class="col-lg-3 control-label" for="customName">产品名称<span class="text-danger">*</span>：</label>\n                                <div class="col-lg-4">\n                                    <input class="form-control input-sm" id="customName" type="text" :disabled="!data.isAllEditable" v-model="data.custom.name">\n                                </div>\n                                <span class="col-lg-2 text-danger help-block" v-show="!data.isAllEditable">无法修改</span>\n                            </div>\n                            <div class="form-group">\n                                <label class="col-lg-3 control-label" for="customQuantity">数量<span class="text-danger">*</span>：</label>\n                                <div class="col-lg-4">\n                                    <input class="form-control input-sm" id="customQuantity" placeholder="100本" type="text" :disabled="!data.isAllEditable" v-model="data.custom.quantity">\n                                </div>\n                                <span class="col-lg-2 text-danger help-block" v-show="!data.isAllEditable">无法修改</span>\n                            </div>\n                            <div class="form-group">\n                                <label class="col-lg-3 control-label" for="customSize">产品尺寸：</label>\n                                <div class="col-lg-6">\n                                    <input class="form-control input-sm" id="customSize" placeholder="长100*宽80，单位：毫米(mm)" type="text" :disabled="!data.isAllEditable" v-model="data.custom.size">\n                                </div>\n                                <span class="col-lg-2 text-danger help-block" v-show="!data.isAllEditable">无法修改</span>\n                            </div>\n                            <div class="form-group">\n                                <label class="col-lg-3 control-label" for="customCaizhi">材质：</label>\n                                <div class="col-lg-6">\n                                    <input class="form-control input-sm" id="customCaizhi" placeholder="150g铜版纸" type="text" :disabled="!data.isAllEditable" v-model="data.custom.caizhi">\n                                </div>\n                                <span class="col-lg-2 text-danger help-block" v-show="!data.isAllEditable">无法修改</span>\n                            </div>\n                            <div class="form-group">\n                                <label class="col-lg-3 control-label" for="customOthers">其他要求：</label>\n                                <div class="col-lg-7">\n                                    <textarea class="form-control input-sm" id="customOthers" placeholder="需要烫金等" type="text" :disabled="!data.isAllEditable" v-model="data.custom.others"></textarea>\n                                </div>\n                                <span class="col-lg-2 text-danger help-block" v-show="!data.isAllEditable">无法修改</span>\n                            </div>\n                        </template>\n                        <template v-else>\n                            <div class="form-group">\n                                <label class="col-lg-3 control-label" for="productQuantity">数量<span class="text-danger">*</span>：</label>\n                                <div class="col-lg-4">\n                                    <input class="form-control input-sm" id="productQuantity" type="number" min="1" :disabled="!data.isAllEditable" v-model="data.standard.quantity" number>\n                                </div>\n                                <span class="col-lg-2 text-danger help-block" v-show="!data.isAllEditable">无法修改</span>\n                            </div>\n                        </template>\n                        <div class="form-group">\n                            <label class="col-lg-3 control-label" for="productPrice">价格<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-4">\n                                <input class="form-control input-sm" id="productPrice" placeholder="单位：元" type="text" :disabled="!data.isAllEditable" v-model="data.price | priceFilter">\n                            </div>\n                            <span class="col-lg-2 text-danger help-block" v-show="!data.isAllEditable">无法修改</span>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-3 control-label" for="productArrivalTime">到货时间要求：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="productArrivalTime" type="text" v-model="data.arrival_time">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'EditOrAddProductDialogView\',\n    components: {\n        popupTips,\n    },\n    props: [\'show\', \'data\'],\n    data() {\n        return {\n            buttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    computed: {\n        title() {\n            if (this.data.orderProductId) {\n                if (this.data.isCustom) {\n                    return \'编辑非标品\';\n                } else {\n                    return \'编辑标准品\';\n                }\n            } else {\n                return \'新增非标品\';\n            }\n        },\n    },\n    methods: {\n        validateCustomProduct(custom, price) {\n            var result = orderValidator.validateProductName(custom.name);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            result = orderValidator.validateProductQuantity(custom.quantity);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            result = orderValidator.validateProductPrice(price);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        validateProduct(quantity, price) {\n            if (!quantity) {\n                return \'产品数量不能为空或者0\';\n            }\n            var result = orderValidator.validateProductPrice(price);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                if (this.data.orderProductId) {\n                    if (this.data.isAllEditable) {\n                        if (this.data.isCustom) {\n                            this.editCustomProduct();\n                        } else {\n                            this.editProduct();\n                        }\n                    } else {\n                        this.editArrivalTime();\n                    }\n                } else {\n                    this.addCustomProduct();\n                }\n            }\n        },\n        addCustomProduct() {\n            var result = this.validateCustomProduct(this.data.custom, this.data.price);\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var data = {\n                detail: {\n                    name: this.data.custom.name,\n                    quantity: this.data.custom.quantity,\n                    size: this.data.custom.size,\n                    caizhi: this.data.custom.caizhi,\n                    others: this.data.custom.others,\n                },\n                price: this.data.price,\n                arrival_time: this.data.arrival_time\n            };\n            var url = \'/api/v2/admin/orders/add-custom-item?order_id=\' + this.data.orderId;\n            this.submitToServer(\'add-custom-product\', url, data, null);\n        },\n        editCustomProduct() {\n            var result = this.validateCustomProduct(this.data.custom, this.data.price);\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var data = {\n                detail: {\n                    name: this.data.custom.name,\n                    quantity: this.data.custom.quantity,\n                    size: this.data.custom.size,\n                    caizhi: this.data.custom.caizhi,\n                    others: this.data.custom.others,\n                },\n                price: this.data.price,\n                arrival_time: this.data.arrival_time\n            };\n            var url = \'/api/v2/admin/orders/update-custom-item?id=\' + this.data.orderProductId;\n            this.submitToServer(\'edit-custom-product\', url, data, this.data.orderProductId);\n        },\n        editProduct() {\n            var result = this.validateProduct(this.data.standard.quantity, this.data.price);\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var data = {\n                quantity: this.data.standard.quantity,\n                price: this.data.price,\n                arrival_time: this.data.arrival_time\n            };\n            var url = \'/api/v2/admin/orders/update-item?id=\'+ this.data.orderProductId;\n            this.submitToServer(\'edit-product\', url, data, this.data.orderProductId);\n        },\n        editArrivalTime() {\n            var data = {\n                arrival_time: this.data.arrival_time\n            };\n            var url = \'/api/v2/admin/orders/update-item-arrival-time?id=\'+ this.data.orderProductId;\n            this.submitToServer(\'edit-arrival-time\', url, data, this.data.orderProductId);\n        },\n        submitToServer(type, url, data, id) {\n            this.$http.put(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    if (!id) {\n                        id = response.data.id;\n                    }\n                    var result = {\n                        id: id,\n                        data: data,\n                    };\n                    this.show = false;\n                    this.$dispatch(type, result);\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n        closeDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 20%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(80),o=i(a),s=n(46),r=n(85);e.default={name:"EditOrAddProductDialogView",components:{popupTips:o.default},props:["show","data"],data:function(){return{buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},computed:{title:function(){return this.data.orderProductId?this.data.isCustom?"编辑非标品":"编辑标准品":"新增非标品"}},methods:{validateCustomProduct:function(t,e){var n=r.orderValidator.validateProductName(t.name);return n.ok?(n=r.orderValidator.validateProductQuantity(t.quantity),n.ok?(n=r.orderValidator.validateProductPrice(e),n.ok?void 0:n.errorMsg):n.errorMsg):n.errorMsg},validateProduct:function(t,e){if(!t)return"产品数量不能为空或者0";var n=r.orderValidator.validateProductPrice(e);return n.ok?void 0:n.errorMsg},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.data.orderProductId?this.data.isAllEditable?this.data.isCustom?this.editCustomProduct():this.editProduct():this.editArrivalTime():this.addCustomProduct())},addCustomProduct:function(){var t=this.validateCustomProduct(this.data.custom,this.data.price);if(t)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=t,void(this.buttonEnabled=!0);var e={detail:{name:this.data.custom.name,quantity:this.data.custom.quantity,size:this.data.custom.size,caizhi:this.data.custom.caizhi,others:this.data.custom.others},price:this.data.price,arrival_time:this.data.arrival_time},n="/api/v2/admin/orders/add-custom-item?order_id="+this.data.orderId;this.submitToServer("add-custom-product",n,e,null)},editCustomProduct:function(){var t=this.validateCustomProduct(this.data.custom,this.data.price);if(t)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=t,void(this.buttonEnabled=!0);var e={detail:{name:this.data.custom.name,quantity:this.data.custom.quantity,size:this.data.custom.size,caizhi:this.data.custom.caizhi,others:this.data.custom.others},price:this.data.price,arrival_time:this.data.arrival_time},n="/api/v2/admin/orders/update-custom-item?id="+this.data.orderProductId;this.submitToServer("edit-custom-product",n,e,this.data.orderProductId)},editProduct:function(){var t=this.validateProduct(this.data.standard.quantity,this.data.price);if(t)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=t,void(this.buttonEnabled=!0);var e={quantity:this.data.standard.quantity,price:this.data.price,arrival_time:this.data.arrival_time},n="/api/v2/admin/orders/update-item?id="+this.data.orderProductId;this.submitToServer("edit-product",n,e,this.data.orderProductId)},editArrivalTime:function(){var t={arrival_time:this.data.arrival_time},e="/api/v2/admin/orders/update-item-arrival-time?id="+this.data.orderProductId;this.submitToServer("edit-arrival-time",e,t,this.data.orderProductId)},submitToServer:function(t,e,n,i){var a=this;this.$http.put(e,n).then(function(e){if(e.data.result&&0!==e.data.result)s.callback.success(e.data);else{i||(i=e.data.id);var o={id:i,data:n};a.show=!1,a.$dispatch(t,o)}a.buttonEnabled=!0},function(t){s.callback.error(t),a.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},function(t,e){t.exports=' <div class=modal v-show=show _v-543191ba=""> <div class=modal-dialog _v-543191ba=""> <div class=modal-content _v-543191ba=""> <div class=modal-header _v-543191ba=""> <button type=button class=close @click=closeDialog _v-543191ba="">×</button> <h4 class=modal-title _v-543191ba="">{{title}}</h4> </div> <div class=modal-body _v-543191ba=""> <form class=form-horizontal _v-543191ba=""> <template v-if=data.isCustom _v-543191ba=""> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=customName _v-543191ba="">产品名称<span class=text-danger _v-543191ba="">*</span>：</label> <div class=col-lg-4 _v-543191ba=""> <input class="form-control input-sm" id=customName type=text :disabled=!data.isAllEditable v-model=data.custom.name _v-543191ba=""> </div> <span class="col-lg-2 text-danger help-block" v-show=!data.isAllEditable _v-543191ba="">无法修改</span> </div> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=customQuantity _v-543191ba="">数量<span class=text-danger _v-543191ba="">*</span>：</label> <div class=col-lg-4 _v-543191ba=""> <input class="form-control input-sm" id=customQuantity placeholder=100本 type=text :disabled=!data.isAllEditable v-model=data.custom.quantity _v-543191ba=""> </div> <span class="col-lg-2 text-danger help-block" v-show=!data.isAllEditable _v-543191ba="">无法修改</span> </div> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=customSize _v-543191ba="">产品尺寸：</label> <div class=col-lg-6 _v-543191ba=""> <input class="form-control input-sm" id=customSize placeholder=长100*宽80，单位：毫米(mm) type=text :disabled=!data.isAllEditable v-model=data.custom.size _v-543191ba=""> </div> <span class="col-lg-2 text-danger help-block" v-show=!data.isAllEditable _v-543191ba="">无法修改</span> </div> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=customCaizhi _v-543191ba="">材质：</label> <div class=col-lg-6 _v-543191ba=""> <input class="form-control input-sm" id=customCaizhi placeholder=150g铜版纸 type=text :disabled=!data.isAllEditable v-model=data.custom.caizhi _v-543191ba=""> </div> <span class="col-lg-2 text-danger help-block" v-show=!data.isAllEditable _v-543191ba="">无法修改</span> </div> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=customOthers _v-543191ba="">其他要求：</label> <div class=col-lg-7 _v-543191ba=""> <textarea class="form-control input-sm" id=customOthers placeholder=需要烫金等 type=text :disabled=!data.isAllEditable v-model=data.custom.others _v-543191ba=""></textarea> </div> <span class="col-lg-2 text-danger help-block" v-show=!data.isAllEditable _v-543191ba="">无法修改</span> </div> </template> <template v-else="" _v-543191ba=""> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=productQuantity _v-543191ba="">数量<span class=text-danger _v-543191ba="">*</span>：</label> <div class=col-lg-4 _v-543191ba=""> <input class="form-control input-sm" id=productQuantity type=number min=1 :disabled=!data.isAllEditable v-model=data.standard.quantity number="" _v-543191ba=""> </div> <span class="col-lg-2 text-danger help-block" v-show=!data.isAllEditable _v-543191ba="">无法修改</span> </div> </template> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=productPrice _v-543191ba="">价格<span class=text-danger _v-543191ba="">*</span>：</label> <div class=col-lg-4 _v-543191ba=""> <input class="form-control input-sm" id=productPrice placeholder=单位：元 type=text :disabled=!data.isAllEditable v-model="data.price | priceFilter" _v-543191ba=""> </div> <span class="col-lg-2 text-danger help-block" v-show=!data.isAllEditable _v-543191ba="">无法修改</span> </div> <div class=form-group _v-543191ba=""> <label class="col-lg-3 control-label" for=productArrivalTime _v-543191ba="">到货时间要求：</label> <div class=col-lg-6 _v-543191ba=""> <input class="form-control input-sm" id=productArrivalTime type=text v-model=data.arrival_time _v-543191ba=""> </div> </div> </form> </div> <div class=modal-footer _v-543191ba=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-543191ba="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-543191ba=""></popup-tips> </div> ';
},function(t,e,n){var i,a;n(154),i=n(156),a=n(157),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},function(t,e,n){var i=n(155);"string"==typeof i&&(i=[[t.id,i,""]]);n(40)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(39)(),e.push([t.id,".modal[_v-381b6f5a]{height:100%}.modal-dialog[_v-381b6f5a]{top:20%}","",{version:3,sources:["/./src/views/order/comp/editOrAddConsigneeDialog.vue.style"],names:[],mappings:"AAiMA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"editOrAddConsigneeDialog.vue",sourcesContent:['<!-- editOrAddConsigneeDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n    \t<div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">{{title}}</h4>\n                </div>\n                <div class="modal-body">\n                \t<form class="form-horizontal">\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-3 control-label" for="consigneeName">收货人姓名<span class="text-danger">*</span>：</label>\n\t\t                    <div class="col-lg-3">\n\t\t                        <input class="form-control input-sm" id="consigneeName" type="text" v-model="data.name">\n\t\t                    </div>\n\t\t                </div>\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-3 control-label" for="consigneePhone">手机号码<span class="text-danger">*</span>：</label>\n\t\t                    <div class="col-lg-3">\n\t\t                        <input class="form-control input-sm" id="consigneePhone" type="text" v-model="data.phone">\n\t\t                    </div>\n\t\t                </div>\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-3 control-label" for="consigneeAddress">地址<span class="text-danger">*</span>：</label>\n\t\t                    <select-region :regions="data.regions"></select-region>\n\t\t                </div>\n\t\t                <div class="form-group">\n\t\t                \t<label class="col-lg-3 control-label"></label>\n\t\t                \t<div class="col-lg-8">\n\t\t                        <input class="form-control input-sm" id="consigneeAddress" type="text" placeholder="详细地址" v-model="data.address">\n\t\t                    </div>\n\t\t                </div>\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-3 control-label" for="consigneePost">邮编：</label>\n\t\t                    <div class="col-lg-3">\n\t\t                        <input class="form-control input-sm" id="consigneePost" type="text" v-model="data.post_code">\n\t\t                    </div>\n\t\t                </div>\n\t\t                <div class="form-group">\n\t\t                    <label class="col-lg-3 control-label" for="consigneeRemark">收货备注：</label>\n\t\t                    <div class="col-lg-8">\n\t\t                        <input class="form-control input-sm" id="consigneeRemark" type="text" v-model="data.remark">\n\t\t                    </div>\n\t\t                </div>\n\t\t            </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport selectRegion from \'../../../components/selectRegion.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'EditOrAddConsigneeDialogView\',\n    components: {\n        popupTips,\n        selectRegion,\n    },\n    props: [\'show\', \'data\'],\n    data() {\n        return {\n        \tbuttonEnabled: true,\n            regions: null,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    computed: {\n        title() {\n            if (this.data.orderConsigneeId) {\n                return \'编辑收货地址\';\n            } else {\n                return \'新增收货地址\';\n            }\n        },\n    },\n    events: {\n        \'select-region\'(region) {\n            this.data.region_id = region.region;\n            this.regions = region.all_regions;\n        }\n    },\n    methods: {\n    \tvalidateConsignee() {\n            var result = orderValidator.validateConsigneeName(this.data.name);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            result = orderValidator.validateConsigneePhone(this.data.phone);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            result = orderValidator.validateConsigneeAddress(this.data.region_id, this.data.address);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                if (this.data.orderConsigneeId) {\n                    this.editConsignee();\n                } else {\n                    this.addConsignee();\n                }\n            }\n        },\n        addConsignee() {\n        \tvar result = this.validateConsignee();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var data = {\n                name: this.data.name,\n                phone: this.data.phone,\n                region_id: this.data.region_id,\n                address: this.data.address,\n                post_code: this.data.post_code,\n                remark: this.data.remark,\n            };\n            var url = \'/api/v2/admin/orders/add-consignee?order_id=\' + this.data.orderId;\n            this.submitToServer(\'add-consignee\', url, data, null, this.regions);\n        },\n    \teditConsignee() {\n            var result = this.validateConsignee();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var data = {\n                name: this.data.name,\n                phone: this.data.phone,\n                region_id: this.data.region_id,\n                address: this.data.address,\n                post_code: this.data.post_code,\n                remark: this.data.remark,\n            };\n            var url = \'/api/v2/admin/orders/update-consignee?id=\' + this.data.orderConsigneeId;\n            this.submitToServer(\'edit-consignee\', url, data, this.data.orderConsigneeId, this.regions);\n        },\n        submitToServer(type, url, data, id, regions) {\n            this.$http.put(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    if (!id) {\n                        id = response.data.id;\n                    }\n                    var result = {\n                        id: id,\n                        data: data,\n                    };\n                    result.data.regions = regions;\n                    this.show = false;\n                    this.$dispatch(type, result);\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \tcloseDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 20%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(80),o=i(a),s=n(58),r=i(s),d=n(46),l=n(85);e.default={name:"EditOrAddConsigneeDialogView",components:{popupTips:o.default,selectRegion:r.default},props:["show","data"],data:function(){return{buttonEnabled:!0,regions:null,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},computed:{title:function(){return this.data.orderConsigneeId?"编辑收货地址":"新增收货地址"}},events:{"select-region":function(t){this.data.region_id=t.region,this.regions=t.all_regions}},methods:{validateConsignee:function(){var t=l.orderValidator.validateConsigneeName(this.data.name);return t.ok?(t=l.orderValidator.validateConsigneePhone(this.data.phone),t.ok?(t=l.orderValidator.validateConsigneeAddress(this.data.region_id,this.data.address),t.ok?void 0:t.errorMsg):t.errorMsg):t.errorMsg},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.data.orderConsigneeId?this.editConsignee():this.addConsignee())},addConsignee:function(){var t=this.validateConsignee();if(t)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=t,void(this.buttonEnabled=!0);var e={name:this.data.name,phone:this.data.phone,region_id:this.data.region_id,address:this.data.address,post_code:this.data.post_code,remark:this.data.remark},n="/api/v2/admin/orders/add-consignee?order_id="+this.data.orderId;this.submitToServer("add-consignee",n,e,null,this.regions)},editConsignee:function(){var t=this.validateConsignee();if(t)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=t,void(this.buttonEnabled=!0);var e={name:this.data.name,phone:this.data.phone,region_id:this.data.region_id,address:this.data.address,post_code:this.data.post_code,remark:this.data.remark},n="/api/v2/admin/orders/update-consignee?id="+this.data.orderConsigneeId;this.submitToServer("edit-consignee",n,e,this.data.orderConsigneeId,this.regions)},submitToServer:function(t,e,n,i,a){var o=this;this.$http.put(e,n).then(function(e){if(e.data.result&&0!==e.data.result)d.callback.success(e.data);else{i||(i=e.data.id);var s={id:i,data:n};s.data.regions=a,o.show=!1,o.$dispatch(t,s)}o.buttonEnabled=!0},function(t){d.callback.error(t),o.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},function(t,e){t.exports=' <div class=modal v-show=show _v-381b6f5a=""> <div class=modal-dialog _v-381b6f5a=""> <div class=modal-content _v-381b6f5a=""> <div class=modal-header _v-381b6f5a=""> <button type=button class=close @click=closeDialog _v-381b6f5a="">×</button> <h4 class=modal-title _v-381b6f5a="">{{title}}</h4> </div> <div class=modal-body _v-381b6f5a=""> <form class=form-horizontal _v-381b6f5a=""> <div class=form-group _v-381b6f5a=""> <label class="col-lg-3 control-label" for=consigneeName _v-381b6f5a="">收货人姓名<span class=text-danger _v-381b6f5a="">*</span>：</label> <div class=col-lg-3 _v-381b6f5a=""> <input class="form-control input-sm" id=consigneeName type=text v-model=data.name _v-381b6f5a=""> </div> </div> <div class=form-group _v-381b6f5a=""> <label class="col-lg-3 control-label" for=consigneePhone _v-381b6f5a="">手机号码<span class=text-danger _v-381b6f5a="">*</span>：</label> <div class=col-lg-3 _v-381b6f5a=""> <input class="form-control input-sm" id=consigneePhone type=text v-model=data.phone _v-381b6f5a=""> </div> </div> <div class=form-group _v-381b6f5a=""> <label class="col-lg-3 control-label" for=consigneeAddress _v-381b6f5a="">地址<span class=text-danger _v-381b6f5a="">*</span>：</label> <select-region :regions=data.regions _v-381b6f5a=""></select-region> </div> <div class=form-group _v-381b6f5a=""> <label class="col-lg-3 control-label" _v-381b6f5a=""></label> <div class=col-lg-8 _v-381b6f5a=""> <input class="form-control input-sm" id=consigneeAddress type=text placeholder=详细地址 v-model=data.address _v-381b6f5a=""> </div> </div> <div class=form-group _v-381b6f5a=""> <label class="col-lg-3 control-label" for=consigneePost _v-381b6f5a="">邮编：</label> <div class=col-lg-3 _v-381b6f5a=""> <input class="form-control input-sm" id=consigneePost type=text v-model=data.post_code _v-381b6f5a=""> </div> </div> <div class=form-group _v-381b6f5a=""> <label class="col-lg-3 control-label" for=consigneeRemark _v-381b6f5a="">收货备注：</label> <div class=col-lg-8 _v-381b6f5a=""> <input class="form-control input-sm" id=consigneeRemark type=text v-model=data.remark _v-381b6f5a=""> </div> </div> </form> </div> <div class=modal-footer _v-381b6f5a=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-381b6f5a="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-381b6f5a=""></popup-tips> </div> '},function(t,e){t.exports=' <div class=container-fluid _v-4c244d8c=""> <ul class=breadcrumb _v-4c244d8c=""> <li _v-4c244d8c="">订单系统</li> <li _v-4c244d8c="">订单管理</li> <li _v-4c244d8c="">编辑订单：<a class=btn-link v-link="{path:\'/order/detail/\'+orderId}" v-if=orderId _v-4c244d8c="">{{orderId}}</a></li> </ul> <form class="form-inline pull-right" style="margin-top: 16px" v-if="orderId &amp;&amp; permissionList.assignManager" _v-4c244d8c=""> <label _v-4c244d8c="">客户经理/客服：</label> <select class="form-control input-sm" style=width:100px v-model=manager.id number="" @change=changeManager _v-4c244d8c=""> <option v-for="manager of managerList" :value=manager.id _v-4c244d8c="">{{manager.display_name}}</option> </select> </form> <h3 _v-4c244d8c="">编辑订单</h3> <p class=clearfix _v-4c244d8c=""></p> <div class="panel panel-default" _v-4c244d8c=""> <div class=panel-heading _v-4c244d8c="">商品清单</div> <div class=panel-body _v-4c244d8c=""> <table class="table table-bordered table-hover product-table" _v-4c244d8c=""> <thead _v-4c244d8c=""> <tr _v-4c244d8c=""> <th style=width:6% _v-4c244d8c="">ID</th> <th style=width:15% _v-4c244d8c="">产品名称</th> <th style=width:25% _v-4c244d8c="">参数</th> <th style=width:10% _v-4c244d8c="">数量</th> <th style=width:10% _v-4c244d8c="">价格(元)</th> <th style=width:22% _v-4c244d8c="">到货时间要求</th> <th style=width:12% _v-4c244d8c="">操作</th> </tr> </thead> <tbody _v-4c244d8c=""> <tr v-for="item of orderItems" _v-4c244d8c=""> <td _v-4c244d8c="">{{item.id}}</td> <template v-if=item.is_custom _v-4c244d8c=""> <td _v-4c244d8c="">{{item.detail.name}}</td> <td _v-4c244d8c=""> <a class=btn-link @click=showProductDetailDialog(item) _v-4c244d8c=""> {{item.detail.size}}{{(item.detail.size &amp;&amp; (item.detail.caizhi || item.detail.others)) ? \'_\' : \'\'}}{{item.detail.caizhi}}{{(item.detail.caizhi &amp;&amp; item.detail.others) ? \'_\' : \'\'}}{{item.detail.others}} </a> </td> <td _v-4c244d8c="">{{item.detail.quantity}}</td> </template> <template v-else="" _v-4c244d8c=""> <td _v-4c244d8c=""> <a class=btn-link :href="\'http://www.soyyin.com/product?id=\'+item.product_id+\'#\'+item.brief" target=_blank _v-4c244d8c="">{{item.title}}</a> </td> <td _v-4c244d8c="">{{item.brief}}</td> <td _v-4c244d8c="">{{item.quantity}}</td> </template> <td _v-4c244d8c="">{{item.price === 0 ? \'暂无\' : \'\'}}{{(item.price === 0 ? \'\' : item.price ) | realPrice}}</td> <td _v-4c244d8c="">{{item.arrival_time}}</td> <td _v-4c244d8c=""> <a class=btn-link @click=editProduct(item) _v-4c244d8c="">编辑</a> <a class="btn-link show-right" v-if="((!isPayed) &amp;&amp; item.produce_status === \'NOT_PRODUCE\')" @click=showDeleteProductDialog(item) _v-4c244d8c="">删除</a> </td> </tr> </tbody> </table> <a class="btn btn-info btn-sm" v-if="orderId &amp;&amp; !isPayed" @click=addProduct _v-4c244d8c="">添加商品</a> </div> </div> <div class="panel panel-default" _v-4c244d8c=""> <div class=panel-heading _v-4c244d8c="">收货人信息</div> <div class=panel-body _v-4c244d8c=""> <table class="table table-bordered table-hover consignee-table" _v-4c244d8c=""> <thead _v-4c244d8c=""> <tr _v-4c244d8c=""> <th style=width:10% _v-4c244d8c="">姓名</th> <th style=width:12% _v-4c244d8c="">手机号</th> <th style=width:28% _v-4c244d8c="">地址</th> <th style=width:8% _v-4c244d8c="">邮编</th> <th style=width:30% _v-4c244d8c="">收货备注</th> <th style=width:12% _v-4c244d8c="">操作</th> </tr> </thead> <tbody _v-4c244d8c=""> <tr v-for="item of consignees" _v-4c244d8c=""> <td _v-4c244d8c="">{{item.name}}</td> <td _v-4c244d8c="">{{item.phone}}</td> <td _v-4c244d8c=""> <span v-for="region of item.regions" _v-4c244d8c="">{{region.name}}</span> {{item.address}} </td> <td _v-4c244d8c="">{{item.post_code}}</td> <td _v-4c244d8c="">{{item.remark}}</td> <td _v-4c244d8c=""> <a class=btn-link @click=editConsignee(item) _v-4c244d8c="">编辑</a> <a class="btn-link show-right" v-if="item.logistics.length === 0" @click=showDeleteConsigneeDialog(item) _v-4c244d8c="">删除</a> </td> </tr> </tbody> </table> <a class="btn btn-info btn-sm" v-if=orderId @click=addConsignee _v-4c244d8c="">增加收货地址</a> </div> </div> <div class=row _v-4c244d8c=""> <div class=col-lg-7 _v-4c244d8c=""> <div class="panel panel-default" _v-4c244d8c=""> <div class=panel-heading _v-4c244d8c="">付款方式</div> <div class=panel-body _v-4c244d8c=""> <form class=form-horizontal _v-4c244d8c=""> <div class=radio _v-4c244d8c=""> <label _v-4c244d8c=""> <input type=radio id=payment1 :disabled="orderBasic.status !== \'SUBMITTED\'" v-model=paymentData.payment value=ONLINE _v-4c244d8c=""> 在线支付 </label> </div> <div class="radio form-inline" _v-4c244d8c=""> <label _v-4c244d8c=""> <input type=radio id=payment2 :disabled="orderBasic.status !== \'SUBMITTED\'" v-model=paymentData.payment value=CASH_ON_DELIVERY _v-4c244d8c=""> 货到付款 </label> <input class="form-control input-sm" style=width:300px;margin-left:10px type=text placeholder=付款时间及金额说明(选填) v-model=paymentData.remark _v-4c244d8c=""> </div> </form> </div> </div> </div> <div class=col-lg-5 _v-4c244d8c=""> <div class="panel panel-default" _v-4c244d8c=""> <div class=panel-heading _v-4c244d8c="">订单日期</div> <div class=panel-body _v-4c244d8c=""> <div class=form-group _v-4c244d8c=""> <label class=control-label for=orderDate _v-4c244d8c="">请选择日期<span class=text-danger _v-4c244d8c="">*</span></label> <input class="form-control input-sm" id=orderDate style=width:200px readonly=true v-model="orderDate | datePickerFilter" _v-4c244d8c=""> </div> </div> </div> </div> </div> <div class="panel panel-default" _v-4c244d8c=""> <div class=panel-heading _v-4c244d8c="">客户信息</div> <div class=panel-body _v-4c244d8c=""> <form class=form-horizontal _v-4c244d8c=""> <div class=col-xs-2 _v-4c244d8c=""> <label class=control-label for=customerName _v-4c244d8c="">客户名称<span class=text-danger _v-4c244d8c="">*</span></label> <input class="form-control input-sm" id=customerName type=text v-model=orderBasic.customer.name _v-4c244d8c=""> </div> <div class=col-xs-2 _v-4c244d8c=""> <label class=control-label for=customerPhone _v-4c244d8c="">联系电话</label> <input class="form-control input-sm" id=customerPhone type=text v-model=orderBasic.customer.phone _v-4c244d8c=""> </div> <div class=col-xs-2 _v-4c244d8c=""> <label class=control-label for=customerQQ _v-4c244d8c="">QQ</label> <input class="form-control input-sm" id=customerQQ type=text v-model=orderBasic.customer.qq _v-4c244d8c=""> </div> <div class=col-xs-2 _v-4c244d8c=""> <label class=control-label for=customerCompany _v-4c244d8c="">公司</label> <input class="form-control input-sm" id=customerCompany type=text v-model=orderBasic.customer.company _v-4c244d8c=""> </div> </form> </div> </div> <edit-invoice-info-component :edit-invoice-checked.sync=editInvoiceChecked :invoice-data=invoiceInfo :consignees=consigneesForInvoiceInfo _v-4c244d8c=""></edit-invoice-info-component> <div class="panel panel-default" _v-4c244d8c=""> <div class=panel-heading _v-4c244d8c="">其他信息</div> <div class=panel-body _v-4c244d8c=""> <div class="form-group col-md-8" _v-4c244d8c=""> <label class=control-label for=orderRemark _v-4c244d8c="">备注：</label> <textarea class=form-control style=height:100px id=orderRemark v-model=orderBasic.remark _v-4c244d8c=""></textarea> </div> </div> </div> <div _v-4c244d8c=""> <a class="btn btn-info btn-lg pull-right" v-if=orderId @click=editOrder _v-4c244d8c="">确认修改</a> </div> <edit-or-add-product-dialog :show.sync=dataForEditOrAddProductDialog.show :data=dataForEditOrAddProductDialog.data _v-4c244d8c=""></edit-or-add-product-dialog> <product-detail-dialog :show.sync=dataForProductDetailDialog.show :detail=dataForProductDetailDialog.detail _v-4c244d8c=""></product-detail-dialog> <edit-or-add-consignee-dialog :show.sync=dataForEditOrAddConsigneeDialog.show :data=dataForEditOrAddConsigneeDialog.data _v-4c244d8c=""></edit-or-add-consignee-dialog> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-4c244d8c=""></popup-tips> <popup-dialog :show-dialog.sync=dataForPopupDialog.show :dialog-title=dataForPopupDialog.title :dialog-content=dataForPopupDialog.content _v-4c244d8c=""></popup-dialog> </div> '}]);
//# sourceMappingURL=4.js.map