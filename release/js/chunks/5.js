webpackJsonp([5],{64:function(e,t,n){var i,o;n(65),i=n(67),o=n(68),e.exports=i||{},e.exports.__esModule&&(e.exports=e.exports.default),o&&(("function"==typeof e.exports?e.exports.options:e.exports).template=o)},65:function(e,t,n){var i=n(66);"string"==typeof i&&(i=[[e.id,i,""]]);n(40)(i,{});i.locals&&(e.exports=i.locals)},66:function(e,t,n){t=e.exports=n(39)(),t.push([e.id,".use-consignee-info.btn-link{text-decoration:none;cursor:pointer}.use-consignee-info.btn-link:hover{text-decoration:underline}","",{version:3,sources:["/./src/views/order/comp/invoiceInfoComponent.vue.style"],names:[],mappings:"AA+GA,6BACA,qBAAA,AACA,cAAA,CACA,AAEA,mCACA,yBAAA,CACA",file:"invoiceInfoComponent.vue",sourcesContent:['<!-- editInvoiceInfoComponent.vue -->\n<template>\n\t<div class="row">\n\t\t<div class="col-md-6">\n            <div class="form-group">\n                <label class="control-label" for="invoiceAmount">开票金额<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:30%;" id="invoiceAmount" type="text" v-model="invoiceData.amount | priceFilter">\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceContent">开票内容<span class="text-danger">*</span></label>\n                <select class="form-control" style="width:30%;" id="invoiceContent" v-model="invoiceData.content">\n                    <option>制作费</option>\n                    <option>服务费</option>\n                    <option>会议服务费</option>\n                    <option>设计费</option>\n                    <option>代理费</option>\n                    <option>文化咨询费</option>\n                </select>\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceType">发票类型<span class="text-danger">*</span></label>\n                <select class="form-control" style="width:30%;" id="invoiceType" v-model="invoiceData.zengzhishui | formatInvoiceType" number>\n                    <option value="1">普通发票</option>\n                    <option value="2">增值税发票</option>\n                </select>\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceTitle">开票抬头<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:50%;" id="invoiceTitle" type="text" v-model="invoiceData.title">\n            </div>\n            <div v-if="invoiceData.zengzhishui">\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSIdentifier">纳税人识别号<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSIdentifier" type="text" v-model="invoiceData.zengzhishui.identifier">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSAddress">注册地址<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSAddress" type="text" v-model="invoiceData.zengzhishui.address">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSPhone">电话<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSPhone" type="text" v-model="invoiceData.zengzhishui.phone">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSBank">开户行<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSBank" type="text" v-model="invoiceData.zengzhishui.bank">\n                </div>\n                <div class="form-group">\n                    <label class="control-label" for="invoiceZZSAccount">账号<span class="text-danger">*</span></label>\n                    <input class="form-control" style="width:50%;" id="invoiceZZSAccount" type="text" v-model="invoiceData.zengzhishui.account">\n                </div>\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceRemark">备注</label>\n                <input class="form-control" style="width:80%;" id="invoiceRemark" type="text" v-model="invoiceData.remark">\n            </div>\n        </div>\n        <div class="col-md-6">\n            <h4>发票寄送至：</h4>\n            <p v-for="consignee of consignees">\n                <a class="use-consignee-info btn-link" @click="useConsigneeInfo(consignee)">使用收货人{{$index + 1}}信息</a>\n            </p>\n            <div class="form-group">\n                <label class="control-label" for="invoiceConsigneeName">收货人<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:30%;" id="invoiceConsigneeName" type="text" v-model="invoiceData.consignee_name">\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceConsigneePhone">联系方式<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:30%;" id="invoiceConsigneePhone" type="text" v-model="invoiceData.consignee_phone">\n            </div>\n            <div class="form-group">\n                <label class="control-label" for="invoiceConsigneeAddress">收货地址<span class="text-danger">*</span></label>\n                <input class="form-control" style="width:80%;" id="invoiceConsigneeAddress" type="text" v-model="invoiceData.address">\n            </div>\n        </div>\n\t</div>\n</template>\n\n<script>\nexport default {\n    name: \'InvoiceInfoComponentView\',\n    props: [\'invoiceData\', \'consignees\'],\n    filters: {\n        formatInvoiceType: {\n            read(val) {\n                return val ? 2 : 1;\n            },\n            write(val, oldVal) {\n                if (val == 1) {\n                    return undefined;\n                } else {\n                    return {};\n                }\n            },\n        }\n    },\n    methods: {\n        useConsigneeInfo(consignee) {\n            this.invoiceData.consignee_name = consignee.name;\n            this.invoiceData.consignee_phone = consignee.phone;\n            if (consignee.fullRegionName && consignee.address) {\n                this.invoiceData.address = consignee.fullRegionName + consignee.address;\n            } else {\n                this.invoiceData.address = \'\';\n            }\n        },\n    },\n}\n</script>\n\n<style scope>\n.use-consignee-info.btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.use-consignee-info.btn-link:hover {\n    text-decoration: underline;\n}\n</style>'],sourceRoot:"webpack://"}])},67:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"InvoiceInfoComponentView",props:["invoiceData","consignees"],filters:{formatInvoiceType:{read:function(e){return e?2:1},write:function(e,t){return 1==e?void 0:{}}}},methods:{useConsigneeInfo:function(e){this.invoiceData.consignee_name=e.name,this.invoiceData.consignee_phone=e.phone,e.fullRegionName&&e.address?this.invoiceData.address=e.fullRegionName+e.address:this.invoiceData.address=""}}}},68:function(e,t){e.exports=' <div class=row> <div class=col-md-6> <div class=form-group> <label class=control-label for=invoiceAmount>开票金额<span class=text-danger>*</span></label> <input class=form-control style=width:30% id=invoiceAmount type=text v-model="invoiceData.amount | priceFilter"> </div> <div class=form-group> <label class=control-label for=invoiceContent>开票内容<span class=text-danger>*</span></label> <select class=form-control style=width:30% id=invoiceContent v-model=invoiceData.content> <option>制作费</option> <option>服务费</option> <option>会议服务费</option> <option>设计费</option> <option>代理费</option> <option>文化咨询费</option> </select> </div> <div class=form-group> <label class=control-label for=invoiceType>发票类型<span class=text-danger>*</span></label> <select class=form-control style=width:30% id=invoiceType v-model="invoiceData.zengzhishui | formatInvoiceType" number> <option value=1>普通发票</option> <option value=2>增值税发票</option> </select> </div> <div class=form-group> <label class=control-label for=invoiceTitle>开票抬头<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceTitle type=text v-model=invoiceData.title> </div> <div v-if=invoiceData.zengzhishui> <div class=form-group> <label class=control-label for=invoiceZZSIdentifier>纳税人识别号<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSIdentifier type=text v-model=invoiceData.zengzhishui.identifier> </div> <div class=form-group> <label class=control-label for=invoiceZZSAddress>注册地址<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSAddress type=text v-model=invoiceData.zengzhishui.address> </div> <div class=form-group> <label class=control-label for=invoiceZZSPhone>电话<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSPhone type=text v-model=invoiceData.zengzhishui.phone> </div> <div class=form-group> <label class=control-label for=invoiceZZSBank>开户行<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSBank type=text v-model=invoiceData.zengzhishui.bank> </div> <div class=form-group> <label class=control-label for=invoiceZZSAccount>账号<span class=text-danger>*</span></label> <input class=form-control style=width:50% id=invoiceZZSAccount type=text v-model=invoiceData.zengzhishui.account> </div> </div> <div class=form-group> <label class=control-label for=invoiceRemark>备注</label> <input class=form-control style=width:80% id=invoiceRemark type=text v-model=invoiceData.remark> </div> </div> <div class=col-md-6> <h4>发票寄送至：</h4> <p v-for="consignee of consignees"> <a class="use-consignee-info btn-link" @click=useConsigneeInfo(consignee)>使用收货人{{$index + 1}}信息</a> </p> <div class=form-group> <label class=control-label for=invoiceConsigneeName>收货人<span class=text-danger>*</span></label> <input class=form-control style=width:30% id=invoiceConsigneeName type=text v-model=invoiceData.consignee_name> </div> <div class=form-group> <label class=control-label for=invoiceConsigneePhone>联系方式<span class=text-danger>*</span></label> <input class=form-control style=width:30% id=invoiceConsigneePhone type=text v-model=invoiceData.consignee_phone> </div> <div class=form-group> <label class=control-label for=invoiceConsigneeAddress>收货地址<span class=text-danger>*</span></label> <input class=form-control style=width:80% id=invoiceConsigneeAddress type=text v-model=invoiceData.address> </div> </div> </div> '},80:function(e,t,n){var i,o;n(81),i=n(83),o=n(84),e.exports=i||{},e.exports.__esModule&&(e.exports=e.exports.default),o&&(("function"==typeof e.exports?e.exports.options:e.exports).template=o)},81:function(e,t,n){var i=n(82);"string"==typeof i&&(i=[[e.id,i,""]]);n(40)(i,{});i.locals&&(e.exports=i.locals)},82:function(e,t,n){t=e.exports=n(39)(),t.push([e.id,".popuptips-container[_v-d1dee2ce]{position:fixed;left:50%;top:40%;z-index:2000}.panel[_v-d1dee2ce]{position:relative;left:-50%}.fade-transition[_v-d1dee2ce]{-webkit-transition:all 1s ease;transition:all 1s ease}.fade-leave[_v-d1dee2ce]{opacity:0}","",{version:3,sources:["/./src/components/popupTips.vue.style"],names:[],mappings:"AAuCA,kCACA,eAAA,AACA,SAAA,AACA,QAAA,AACA,YAAA,CACA,AACA,oBACA,kBAAA,AACA,SAAA,CACA,AAEA,8BACA,+BAAA,sBAAA,CACA,AAEA,yBACA,SAAA,CACA",file:"popupTips.vue",sourcesContent:['<!-- popupTips.vue -->\n<template>\n\t<div class="popuptips-container" v-if="show" transition="fade">\n\t    <div class="panel panel-{{ tipsType }}">\n\t\t\t<div class="panel-heading">\n\t\t   \t\t<h3 class="panel-title">{{ tipsTitle }}</h3>\n\t\t\t</div>\n\t\t\t<div class="panel-body">\n\t\t    \t{{ tipsContent }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n    name: \'PopupTipsView\',\n    replace: false,\n    props: {\n    \tshow: Boolean,\n    \ttipsType: String,\n    \ttipsTitle: String,\n    \ttipsContent: String\n    },\n    watch: {\n        show(val, oldVal) {\n            if (val === true) {\n            \tsetTimeout(() => {\n            \t\tthis.show = false;\n            \t}, 1000);\n            }\n        },\n    },\n}\n\n</script>\n\n<style scoped>\n.popuptips-container {\n\tposition: fixed;\n\tleft: 50%;\n\ttop: 40%;\n    z-index: 2000;\n}\n.panel {\n\tposition: relative;\n    left: -50%;\n}\n\n.fade-transition {\n  transition: all 1s ease;\n}\n\n.fade-leave {\n  opacity: 0;\n}\n</style>'],sourceRoot:"webpack://"}])},83:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"PopupTipsView",replace:!1,props:{show:Boolean,tipsType:String,tipsTitle:String,tipsContent:String},watch:{show:function(e,t){var n=this;e===!0&&setTimeout(function(){n.show=!1},1e3)}}}},84:function(e,t){e.exports=' <div class=popuptips-container v-if=show transition=fade _v-d1dee2ce=""> <div class="panel panel-{{ tipsType }}" _v-d1dee2ce=""> <div class=panel-heading _v-d1dee2ce=""> <h3 class=panel-title _v-d1dee2ce="">{{ tipsTitle }}</h3> </div> <div class=panel-body _v-d1dee2ce=""> {{ tipsContent }} </div> </div> </div> '},85:function(e,t){"use strict";function n(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="产品名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="产品名称不能为空",t)}function i(e){var t={};return t.ok=!1,e?e.length>12?(t.errorMsg="产品数量长度不能大于12",t):(t.ok=!0,t):(t.errorMsg="产品数量不能为空",t)}function o(e){var t={};return t.ok=!1,!e||e<0?(t.errorMsg="产品价格不能为空且必须为正数",t):(t.ok=!0,t)}function s(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="客户名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="客户名称不能为空",t)}function a(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="收货人名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="收货人名称不能为空",t)}function r(e){var t={};t.ok=!1;var n=/^[0-9]{11}$/;return e?n.test(e)?(t.ok=!0,t):(t.errorMsg="收货人手机格式有误",t):(t.errorMsg="收货人手机不能为空",t)}function l(e,t){var n={};return n.ok=!1,0===e?(n.errorMsg="请选择收货人所在地省市区",n):t?t.length>50?(n.errorMsg="收货人详细地址不能大于50",n):(n.ok=!0,n):(n.errorMsg="收货人详细地址不能为空",n)}function c(e){var t={};return t.ok=!1,!e||e<0?(t.errorMsg="开票金额不能为空且必须为正数",t):(t.ok=!0,t)}function d(e,t){var n={};return n.ok=!1,t?t.length>50?(n.errorMsg=e+"长度不能大于50",n):(n.ok=!0,n):(n.errorMsg=e+"不能为空",n)}function p(e,t){var n={};return n.ok=!1,void 0===e||null===e||""===e?(n.errorMsg="使用额度不能为空",n):e<=0||e>t?(n.errorMsg="使用额度必须为正数且不能超过"+t/100+"元",n):(n.ok=!0,n)}function v(e,t){var n={};return n.ok=!1,void 0===e||null===e||""===e?(n.errorMsg="补充金额不能为空",n):e<=t?(n.errorMsg="补充金额必须大于"+t/100+"元",n):(n.ok=!0,n)}function m(e){var t={};return t.ok=!1,void 0===e||null===e||""===e?(t.errorMsg="额外成本不能为空",t):e<0?(t.errorMsg="额外成本必须大于等于0",t):(t.ok=!0,t)}function u(e,t){var n={};return n.ok=!1,t?t.length>2e3?(n.errorMsg=e+"长度不能大于2000",n):(n.ok=!0,n):(n.errorMsg=e+"不能为空",n)}function h(e,t){var n={};return n.ok=!1,e?e<0?(n.errorMsg="成本必须大于0",n):(n.ok=!0,n):t?(n.ok=!0,n):(n.errorMsg="成本不能为空或者0",n)}function f(e){var t={};return t.ok=!1,void 0===e||null===e||""===e?(t.errorMsg="物流成本不能为空",t):e<0?(t.errorMsg="物流成本必须大于等于0",t):(t.ok=!0,t)}function g(e,t){var n={};return n.ok=!1,t?t.length>2e3?(n.errorMsg=e+"长度不能大于2000",n):(n.ok=!0,n):(n.errorMsg=e+"不能为空",n)}function y(e,t){var n={};return n.ok=!1,!e||e<0?(n.errorMsg="退款金额不能为空且必须为正数",n):e>t?(n.errorMsg="退款金额不能大于"+t/100+"元",n):(n.ok=!0,n)}function A(e){var t={};return t.ok=!1,e?e.length>50?(t.errorMsg="对方账号长度不能大于50",t):(t.ok=!0,t):(t.errorMsg="对方账号不能为空",t)}function b(e){var t={};return t.ok=!1,e?e.length>2e3?(t.errorMsg="退款原因长度不能大于2000",t):(t.ok=!0,t):(t.errorMsg="退款原因不能为空",t)}function I(e,t){var n={};return n.ok=!1,!e||e<0?(n.errorMsg="付款金额不能为空且必须为正数",n):e>t?(n.errorMsg="付款金额不能大于该订单剩余的待支付金额("+t/100+"元)",n):(n.ok=!0,n)}function _(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="供应商名称长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="供应商名称不能为空",t)}function x(e){var t={};return t.ok=!1,e?e.length>20?(t.errorMsg="真实姓名长度不能大于20",t):(t.ok=!0,t):(t.errorMsg="真实姓名不能为空",t)}function L(e){var t={};return t.ok=!1,e?e.length>50?(t.errorMsg="用户名长度不能大于50",t):(t.ok=!0,t):(t.errorMsg="用户名不能为空",t)}function D(e){var t={};t.ok=!1;var n=/^[a-zA-Z0-9]*$/;return e?e.length>20?(t.errorMsg="密码长度不能超过20",t):n.test(e)?(t.ok=!0,t):(t.errorMsg="密码只能包含英文字母和数字",t):(t.errorMsg="密码不能为空",t)}Object.defineProperty(t,"__esModule",{value:!0});var k="******";t.orderValidator={validateProductName:n,validateProductQuantity:i,validateProductPrice:o,validateCustomerName:s,validateConsigneeName:a,validateConsigneePhone:r,validateConsigneeAddress:l,validateInvoiceAmount:c,validateInvoiceItem:d,validateApplyInvoiceAmount:p,validateExtraAmount:v,validateExtraCost:m,validateAfterSaleItem:u,validateProductCost:h,validateLogisticsCost:f,validateLogisticsItem:g,validateRefundAmount:y,validateRefundAccount:A,validateRefundReason:b},t.financeValidator={validatePaymentAmount:I},t.crmValidator={validateSupplierName:_,validateDisplayName:x,validateUserName:L,validatePassword:D,DEFAULT_PASSWORD:k}},128:function(e,t,n){var i,o;n(129),i=n(131),o=n(132),e.exports=i||{},e.exports.__esModule&&(e.exports=e.exports.default),o&&(("function"==typeof e.exports?e.exports.options:e.exports).template=o)},129:function(e,t,n){var i=n(130);"string"==typeof i&&(i=[[e.id,i,""]]);n(40)(i,{});i.locals&&(e.exports=i.locals)},130:function(e,t,n){t=e.exports=n(39)(),t.push([e.id,".modal[_v-03122b87]{height:100%}","",{version:3,sources:["/./src/views/order/comp/applyInvoiceDialog.vue.style"],names:[],mappings:"AAuKA,oBACA,WAAA,CACA",file:"applyInvoiceDialog.vue",sourcesContent:['<!-- applyInvoiceDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n        <div class="modal-dialog" style="width:400px; top:30%;" v-show="!showInvoiceInfoDialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">开票申请</h4>\n                </div>\n                <div class="modal-body">\n                    <h5>订单剩余未开票金额：{{maxApplyAmount | realPrice}}元</h5>\n                    <form class="form-horizontal">\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="applyInvoiceAmount">使用额度<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-8">\n                                <input class="form-control input-sm" id="applyInvoiceAmount" type="text" v-model="applyInvoiceAmount | priceFilter">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" @click="clickToNextStep">下一步</button>\n                </div>\n            </div>\n        </div>\n        <div class="modal-dialog" style="width:1000px; top:10%;" v-show="showInvoiceInfoDialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">开票信息</h4>\n                </div>\n                <div class="modal-body" style="height:480px;overflow-y:auto;">\n                    <invoice-info-component :invoice-data="invoiceInfo" :consignees="[]">\n                    </invoice-info-component>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport invoiceInfoComponent from \'./invoiceInfoComponent.vue\'\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'ApplyInvoiceDialogView\',\n    components: {\n        invoiceInfoComponent,\n        popupTips,\n    },\n    data() {\n        return {\n            showInvoiceInfoDialog: false,\n            applyInvoiceAmount: \'\',\n            buttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    props: [\'show\', \'orderIds\', \'invoiceInfo\', \'maxApplyAmount\'],\n    methods: {\n        validateApplyInvoiceAmount() {\n            var result = orderValidator.validateApplyInvoiceAmount(this.applyInvoiceAmount, this.maxApplyAmount);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        validateInvoiceInfo() {\n            var result = orderValidator.validateInvoiceAmount(this.invoiceInfo.amount);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            var infoName = ["开票内容", "开票抬头", "发票收货人", "发票收货人联系方式", "发票收货人收货地址"];\n            var infoData = [this.invoiceInfo.content, this.invoiceInfo.title, this.invoiceInfo.consignee_name, this.invoiceInfo.consignee_phone, this.invoiceInfo.address];\n            for (let i = 0; i < infoName.length; i++) {\n                result = orderValidator.validateInvoiceItem(infoName[i], infoData[i]);\n                if (!result.ok) {\n                    return result.errorMsg;\n                }\n            }\n            if (this.invoiceInfo.zengzhishui) {\n                infoName = ["发票信息中纳税人识别号", "发票信息中注册地址", "发票信息中电话", "发票信息中开户行", "发票信息中账号"];\n                infoData = [this.invoiceInfo.zengzhishui.identifier, this.invoiceInfo.zengzhishui.address, this.invoiceInfo.zengzhishui.phone, this.invoiceInfo.zengzhishui.account, this.invoiceInfo.zengzhishui.bank];\n                for (let i = 0; i < infoName.length; i++) {\n                    result = orderValidator.validateInvoiceItem(infoName[i], infoData[i]);\n                    if (!result.ok) {\n                        return result.errorMsg;\n                    }\n                }\n            }\n            return;\n        },\n        clickToNextStep() {\n            var result = this.validateApplyInvoiceAmount();\n            if (result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                return;\n            }\n            this.showInvoiceInfoDialog = true;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                this.applyInvoice();\n            }\n        },\n        applyInvoice() {\n            var result = this.validateInvoiceInfo();\n            if (result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var params = \'\';\n            for (let i = 0; i < this.orderIds.length; i++) {\n                if (i !== 0) {\n                    params += "&order_id=" + this.orderIds[i];\n                } else {\n                    params += "order_id=" + this.orderIds[i];\n                }\n            }\n            var data = {\n                amount: this.applyInvoiceAmount,\n                data: this.invoiceInfo,\n            };\n            var url = \'/api/v2/admin/invoices/create?\' + params;\n            this.$http.post(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.applyInvoiceAmount = \'\';\n                    this.show = false;\n                    this.showInvoiceInfoDialog = false;\n                    this.$dispatch(\'apply-invoice\');\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n        closeDialog() {\n            this.applyInvoiceAmount = \'\';\n            this.show = false;\n            this.showInvoiceInfoDialog = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n</style>'],sourceRoot:"webpack://"}])},131:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(64),s=i(o),a=n(80),r=i(a),l=n(46),c=n(85);t.default={name:"ApplyInvoiceDialogView",components:{invoiceInfoComponent:s.default,popupTips:r.default},data:function(){return{showInvoiceInfoDialog:!1,applyInvoiceAmount:"",buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},props:["show","orderIds","invoiceInfo","maxApplyAmount"],methods:{validateApplyInvoiceAmount:function(){var e=c.orderValidator.validateApplyInvoiceAmount(this.applyInvoiceAmount,this.maxApplyAmount);if(!e.ok)return e.errorMsg},validateInvoiceInfo:function(){var e=c.orderValidator.validateInvoiceAmount(this.invoiceInfo.amount);if(!e.ok)return e.errorMsg;for(var t=["开票内容","开票抬头","发票收货人","发票收货人联系方式","发票收货人收货地址"],n=[this.invoiceInfo.content,this.invoiceInfo.title,this.invoiceInfo.consignee_name,this.invoiceInfo.consignee_phone,this.invoiceInfo.address],i=0;i<t.length;i++)if(e=c.orderValidator.validateInvoiceItem(t[i],n[i]),!e.ok)return e.errorMsg;if(this.invoiceInfo.zengzhishui){t=["发票信息中纳税人识别号","发票信息中注册地址","发票信息中电话","发票信息中开户行","发票信息中账号"],n=[this.invoiceInfo.zengzhishui.identifier,this.invoiceInfo.zengzhishui.address,this.invoiceInfo.zengzhishui.phone,this.invoiceInfo.zengzhishui.account,this.invoiceInfo.zengzhishui.bank];for(var o=0;o<t.length;o++)if(e=c.orderValidator.validateInvoiceItem(t[o],n[o]),!e.ok)return e.errorMsg}},clickToNextStep:function(){var e=this.validateApplyInvoiceAmount();return e?(this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",void(this.dataForPopupTips.content=e)):void(this.showInvoiceInfoDialog=!0)},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.applyInvoice())},applyInvoice:function(){var e=this,t=this.validateInvoiceInfo();if(t)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=t,void(this.buttonEnabled=!0);for(var n="",i=0;i<this.orderIds.length;i++)n+=0!==i?"&order_id="+this.orderIds[i]:"order_id="+this.orderIds[i];var o={amount:this.applyInvoiceAmount,data:this.invoiceInfo},s="/api/v2/admin/invoices/create?"+n;this.$http.post(s,o).then(function(t){t.data.result&&0!==t.data.result?l.callback.success(t.data):(e.applyInvoiceAmount="",e.show=!1,e.showInvoiceInfoDialog=!1,e.$dispatch("apply-invoice")),e.buttonEnabled=!0},function(t){l.callback.error(t),e.buttonEnabled=!0})},closeDialog:function(){this.applyInvoiceAmount="",this.show=!1,this.showInvoiceInfoDialog=!1}}}},132:function(e,t){e.exports=' <div class=modal v-show=show _v-03122b87=""> <div class=modal-dialog style="width:400px; top:30%" v-show=!showInvoiceInfoDialog _v-03122b87=""> <div class=modal-content _v-03122b87=""> <div class=modal-header _v-03122b87=""> <button type=button class=close @click=closeDialog _v-03122b87="">×</button> <h4 class=modal-title _v-03122b87="">开票申请</h4> </div> <div class=modal-body _v-03122b87=""> <h5 _v-03122b87="">订单剩余未开票金额：{{maxApplyAmount | realPrice}}元</h5> <form class=form-horizontal _v-03122b87=""> <div class=form-group _v-03122b87=""> <label class="col-lg-4 control-label" for=applyInvoiceAmount _v-03122b87="">使用额度<span class=text-danger _v-03122b87="">*</span>：</label> <div class=col-lg-8 _v-03122b87=""> <input class="form-control input-sm" id=applyInvoiceAmount type=text v-model="applyInvoiceAmount | priceFilter" _v-03122b87=""> </div> </div> </form> </div> <div class=modal-footer _v-03122b87=""> <button type=button class="btn btn-primary" @click=clickToNextStep _v-03122b87="">下一步</button> </div> </div> </div> <div class=modal-dialog style="width:1000px; top:10%" v-show=showInvoiceInfoDialog _v-03122b87=""> <div class=modal-content _v-03122b87=""> <div class=modal-header _v-03122b87=""> <button type=button class=close @click=closeDialog _v-03122b87="">×</button> <h4 class=modal-title _v-03122b87="">开票信息</h4> </div> <div class=modal-body style=height:480px;overflow-y:auto _v-03122b87=""> <invoice-info-component :invoice-data=invoiceInfo :consignees=[] _v-03122b87=""> </invoice-info-component> </div> <div class=modal-footer _v-03122b87=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-03122b87="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-03122b87=""></popup-tips> </div> '},159:function(e,t,n){var i,o;n(160),i=n(162),o=n(163),e.exports=i||{},e.exports.__esModule&&(e.exports=e.exports.default),o&&(("function"==typeof e.exports?e.exports.options:e.exports).template=o)},160:function(e,t,n){var i=n(161);"string"==typeof i&&(i=[[e.id,i,""]]);n(40)(i,{});i.locals&&(e.exports=i.locals)},161:function(e,t,n){t=e.exports=n(39)(),t.push([e.id,".nav-pills>li>a[_v-13e1c2ad]{cursor:pointer}.order-table[_v-13e1c2ad]{table-layout:fixed}.order-table td[_v-13e1c2ad],.order-table th[_v-13e1c2ad]{text-align:center;vertical-align:middle}.order-table td .btn-link[_v-13e1c2ad]{text-decoration:none;cursor:pointer}.order-table td .btn-link[_v-13e1c2ad]:hover{text-decoration:underline}","",{version:3,sources:["/./src/views/order/invoice.vue.style"],names:[],mappings:"AA8QA,6BACA,cAAA,CACA,AAEA,0BACA,kBAAA,CACA,AAEA,0DACA,kBAAA,AACA,qBAAA,CACA,AAEA,uCACA,qBAAA,AACA,cAAA,CACA,AAEA,6CACA,yBAAA,CACA",file:"invoice.vue",sourcesContent:["<!-- invoice.vue -->\n<template>\n    <div class=\"container-fluid\">\n        <ul class=\"breadcrumb\">\n            <li>订单系统</li>\n            <li>订单管理</li>\n            <li>合并开票</li>\n        </ul>\n        <div class=\"pull-right\">\n            <a class=\"btn btn-info btn-sm\" v-if=\"permissionList.applyInvoice\" :disabled=\"chosenOrders.length === 0\" @click=\"clickToApplyInvoice\">申请开票</a>\n            <a class=\"btn btn-info btn-sm\" v-link=\"{path: '/order/list'}\">取消</a>\n        </div>\n        <ul class=\"nav nav-pills\">\n            <li :class=\"{'active': type === 'UNHANDLED'}\" v-if=\"permissionList.soyyinOrderList\"><a @click=\"getList('UNHANDLED')\">未处理酱印网订单</a></li>\n            <li :class=\"{'active': type === 'ASSIGNED'}\" v-if=\"permissionList.myOrderList\"><a @click=\"getList('ASSIGNED')\">我的订单</a></li>\n            <li :class=\"{'active': type === 'CREATED'}\" v-if=\"permissionList.createByMeOrderList\"><a @click=\"getList('CREATED')\">由我创建</a></li>\n            <li :class=\"{'active': type === 'ALL'}\" v-if=\"permissionList.allOrderList\"><a @click=\"getList('ALL')\">全部订单</a></li>\n        </ul>\n        <p class=\"clearfix\"></p>\n        <form class=\"form-inline\" style=\"margin-bottom:10px;\" v-if=\"permissionList.soyyinOrderList || permissionList.myOrderList || permissionList.createByMeOrderList || permissionList.allOrderList\">\n            <label class=\"control-label\" for=\"fitlerType\">筛选：</label>\n            <select class=\"form-control input-sm\" id=\"fitlerType\" style=\"width:80px;\" v-model=\"filterType\">\n                <option value=\"customer\">客户信息</option>\n                <option value=\"manager\">客户经理</option>\n            </select>\n            <input v-if=\"filterType === 'customer'\" class=\"form-control input-sm\" style=\"width:120px;margin-left:20px;\" type=\"text\" placeholder=\"请输入客户信息\" v-model=\"customerKeyword\">\n            <select v-else class=\"form-control input-sm\" style=\"width:120px;margin-left:20px;\" v-model=\"managerChoosed\" number>\n                <option value=\"0\">全部</option>\n                <option v-for=\"manager of managerList\" :value=\"manager.id\">{{manager.display_name}}</option>\n            </select>\n            <a class=\"btn btn-info btn-sm\" style=\"margin-left:30px;padding:6px 20px;\" @click=\"getList(type, '', getFilterParams())\">查询</a>\n        </form>\n        <h5 v-show=\"filterParams.customer || filterParams.managerId\">{{getQueryDesc()}}</h5>\n        <table class=\"table table-bordered table-hover order-table\">\n            <thead>\n                <tr>\n                \t<th style=\"width:3%;\"><input type=\"checkbox\" v-model=\"chooseAllOrNot\"></th>\n                    <th style=\"width:10%;\">订单日期</th>\n                    <th style=\"width:10%;\">订单号</th>\n                    <th style=\"width:20%;\">客户</th>\n                    <th style=\"width:9%;\">客户经理</th>\n                    <th style=\"width:11%;\">总价/利润</th>\n                    <th style=\"width:10%;\">订单状态</th>\n                    <th style=\"width:9%;\">开票情况</th>\n                    <th style=\"width:10%;\">付款情况</th>\n                    <th style=\"width:8%;\">操作</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr v-for=\"item of orderList\">\n                \t<td><input type=\"checkbox\" value=\"{{item.id}}\" :disabled=\"!((item.status == 'DELIVERY_CONFIRMED' || item.status == 'DELIVERY_PAID' || item.status == 'ONLINE_CONFIRMED' || item.status == 'FINISHED') && (item.amount + item.freight - item.invoiced_amount > 0))\" v-model=\"chosenOrders\" number></td>\n                    <td>{{item.time | dateFormat 'toDate'}}</td>\n                    <td>{{item.id}}</td>\n                    <td>{{item.customer.name + (item.customer.company ? '/' + item.customer.company : '')}}</td>\n                    <td>{{item.manager ? item.manager.display_name : ''}}</td>\n                    <td>{{(item.amount + item.freight) | realPrice}}{{item.is_priced ? '' : '+?'}} / {{(item.status === 'FINISHED' ? (item.amount + item.freight - item.cost - item.extra_cost - item.logistics_cost - item.invoice_logistics_cost - item.refunded_amount) : '') | realPrice}}{{item.status === 'FINISHED' ? '' : '?'}}元</td>\n                    <td v-bind:class=\"{'text-success': item.status === 'FINISHED', 'text-danger': item.status === 'CANCELED'}\">{{item.status | orderStatusFilter}}</td>\n                    <td>{{item.invoiced_amount > 0 ? (item.invoiced_amount >= item.amount + item.freight ? '已开票' : '已部分开票') : ''}}</td>\n                    <td>{{item.paid_amount > 0 ? (item.paid_amount === item.amount + item.freight ? '已付款' : '已付款' + Math.round(item.paid_amount / (item.amount + item.freight) *100) + '%') : ''}}</td>\n                    <td><a class=\"btn-link\" v-link=\"{path:'/order/detail/'+item.id}\" target=\"_blank\">查看详情</a></td>\n                </tr>\n            </tbody>\n        </table>\n        <a class=\"btn btn-primary\" v-if=\"sinceId\" @click=\"getList(type, sinceId, filterParams)\">查看更多</a>\n        <apply-invoice-dialog v-if=\"permissionList.applyInvoice\" :show.sync=\"dataForApplyInvoiceDialog.show\" :order-ids=\"dataForApplyInvoiceDialog.orderIds\" :invoice-info=\"dataForApplyInvoiceDialog.invoiceInfo\" :max-apply-amount=\"dataForApplyInvoiceDialog.maxApplyAmount\"></apply-invoice-dialog>\n    </div>\n</template>\n\n<script>\nimport { callback } from '../../store'\nimport { unique } from '../../filters'\nimport { permissionValidator } from '../../store/rolePermission.js'\nimport applyInvoiceDialog from './comp/applyInvoiceDialog.vue'\n\nexport default {\n    name: 'OrderInvoiceView',\n    components: {\n        applyInvoiceDialog,\n    },\n    data() {\n        return {\n            type: '',\n            sinceId: '',\n            orderList: [],\n            chosenOrders: [],\n            chooseAllOrNot: false,\n            permissionList: {\n                applyInvoice: permissionValidator.orderSystem.order.applyInvoice(),\n                soyyinOrderList: permissionValidator.orderSystem.order.soyyinOrderList(),\n                myOrderList: permissionValidator.orderSystem.order.myOrderList(),\n                createByMeOrderList: permissionValidator.orderSystem.order.createByMeOrderList(),\n                allOrderList: permissionValidator.orderSystem.order.allOrderList(),\n            },\n            filterType: 'customer',\n            customerKeyword: '',\n            managerChoosed: 0,\n            managerList: [],\n            filterParams: {\n                customer: '',\n                managerId: 0,\n            },\n            dataForApplyInvoiceDialog: {\n                show: false,\n                orderIds: [],\n                invoiceInfo: {\n                    amount: '',\n                    content: '',\n                    title: '',\n                    zengzhishui: undefined,\n                    remark: '',\n                    consignee_name: '',\n                    consignee_phone: '',\n                    address: '',\n                },\n                maxApplyAmount: '',\n            },\n        }\n    },\n    ready() {\n        var getManagerFlag = true;\n        if (this.permissionList.soyyinOrderList) {\n            this.getList('UNHANDLED');\n        } else if (this.permissionList.myOrderList) {\n            this.getList('ASSIGNED');\n        } else if (this.permissionList.createByMeOrderList) {\n            this.getList('CREATED');\n        } else if (this.permissionList.allOrderList) {\n            this.getList('ALL');\n        } else {\n            getManagerFlag = false;\n        }\n        if (getManagerFlag) {\n            this.getManager();\n        }\n    },\n    events: {\n        'apply-invoice'() {\n            location.reload();\n        },\n    },\n    watch: {\n        chooseAllOrNot(val, oldVal) {\n        \tthis.chosenOrders = [];\n            if (val) {\n            \tfor (let i = 0; i < this.orderList.length; i++) {\n            \t\tlet item = this.orderList[i];\n    \t\t\t\tif ((item.status == 'DELIVERY_CONFIRMED' || item.status == 'DELIVERY_PAID' || item.status == 'ONLINE_CONFIRMED' || item.status == 'FINISHED') && (item.amount + item.freight - item.invoiced_amount > 0)) {\n    \t\t\t\t\tthis.chosenOrders.push(item.id);\n    \t\t\t\t}\n    \t\t\t}\n            }\n        },\n    },\n    methods: {\n    \tgetOrderFromId(orderId) {\n    \t\tfor (let i = 0; i < this.orderList.length; i++) {\n    \t\t\tif (this.orderList[i].id === orderId) {\n    \t\t\t\treturn this.orderList[i];\n    \t\t\t}\n    \t\t}\n    \t},\n        getList(type, sinceId, filterParams) {\n            var url = '/api/v2/admin/orders/list-v2?type=' + type;\n            if (sinceId) {\n                url += '&since_id=' + sinceId;\n            }\n            if (filterParams) {\n                if (filterParams.customer) {\n                    url += '&customer=' + filterParams.customer;\n                } else if (filterParams.managerId) {\n                    url += '&manager_id=' + filterParams.managerId;\n                }\n            }\n            this.$http.get(url)\n            .then((response) => {\n                if (!response.data.result || response.data.result === 0) {\n                    var arr = [];\n                    if (sinceId) {\n                        arr = this.orderList.concat(response.data.orders);\n                    } else {\n                        arr = response.data.orders;\n                        this.chooseAllOrNot = false;\n                        this.chosenOrders = [];\n                    }\n                    this.orderList = unique(arr);\n                    this.type = type;\n                    this.$set(\"sinceId\", response.data.since_id || '');\n                    if (filterParams) {\n                        this.filterParams = filterParams;\n                    } else {\n                        this.filterParams = {\n                            customer: '',\n                            managerId: 0,\n                        };\n                    }\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        clickToApplyInvoice() {\n            this.dataForApplyInvoiceDialog.show = true;\n            this.dataForApplyInvoiceDialog.orderIds = this.chosenOrders;\n            this.dataForApplyInvoiceDialog.maxApplyAmount = 0;\n            for (let i = 0; i < this.chosenOrders.length; i++) {\n            \tlet orderNow = this.getOrderFromId(this.chosenOrders[i]);\n            \tthis.dataForApplyInvoiceDialog.maxApplyAmount += orderNow.amount + orderNow.freight - orderNow.invoiced_amount;\n            }\n            this.dataForApplyInvoiceDialog.invoiceInfo = {\n                amount: '',\n                content: '',\n                title: '',\n                zengzhishui: undefined,\n                remark: '',\n                consignee_name: '',\n                consignee_phone: '',\n                address: '',\n            };\n        },\n        getManager() {\n            var url = '/api/v2/admin/permissions/manager-list';\n            this.$http.get(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.managerList = response.data.data;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        getManagerName(managerId) {\n            for (let i = 0; i < this.managerList.length; i++) {\n                if (this.managerList[i].id === managerId) {\n                    return this.managerList[i].display_name;\n                }\n            }\n            return '';\n        },\n        getFilterParams() {\n            var filterParams = {\n                customer: '',\n                managerId: 0,\n            };\n            if (this.filterType === 'customer') {\n                filterParams.customer = this.customerKeyword;\n            } else {\n                filterParams.managerId = this.managerChoosed;\n            }\n            return filterParams;\n        },\n        getQueryDesc() {\n            if (!this.filterParams.customer && !this.filterParams.managerId) {\n                return;\n            }\n            if (this.filterParams.customer) {\n                return '客户信息 {' + this.filterParams.customer + '} 的查询结果：';\n            }\n            if (this.filterParams.managerId) {\n                return '客户经理 {' + this.getManagerName(this.filterParams.managerId) + '} 的查询结果：';\n            }\n        },\n    }\n}\n</script>\n\n<style scoped>\n.nav-pills > li > a{\n    cursor: pointer;\n}\n\n.order-table {\n    table-layout: fixed;\n}\n\n.order-table th, .order-table td{\n    text-align: center;\n    vertical-align: middle;\n}\n\n.order-table td .btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.order-table td .btn-link:hover {\n    text-decoration: underline;\n}\n</style>"],
sourceRoot:"webpack://"}])},162:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(46),s=n(29),a=n(43),r=n(128),l=i(r);t.default={name:"OrderInvoiceView",components:{applyInvoiceDialog:l.default},data:function(){return{type:"",sinceId:"",orderList:[],chosenOrders:[],chooseAllOrNot:!1,permissionList:{applyInvoice:a.permissionValidator.orderSystem.order.applyInvoice(),soyyinOrderList:a.permissionValidator.orderSystem.order.soyyinOrderList(),myOrderList:a.permissionValidator.orderSystem.order.myOrderList(),createByMeOrderList:a.permissionValidator.orderSystem.order.createByMeOrderList(),allOrderList:a.permissionValidator.orderSystem.order.allOrderList()},filterType:"customer",customerKeyword:"",managerChoosed:0,managerList:[],filterParams:{customer:"",managerId:0},dataForApplyInvoiceDialog:{show:!1,orderIds:[],invoiceInfo:{amount:"",content:"",title:"",zengzhishui:void 0,remark:"",consignee_name:"",consignee_phone:"",address:""},maxApplyAmount:""}}},ready:function(){var e=!0;this.permissionList.soyyinOrderList?this.getList("UNHANDLED"):this.permissionList.myOrderList?this.getList("ASSIGNED"):this.permissionList.createByMeOrderList?this.getList("CREATED"):this.permissionList.allOrderList?this.getList("ALL"):e=!1,e&&this.getManager()},events:{"apply-invoice":function(){location.reload()}},watch:{chooseAllOrNot:function(e,t){if(this.chosenOrders=[],e)for(var n=0;n<this.orderList.length;n++){var i=this.orderList[n];("DELIVERY_CONFIRMED"==i.status||"DELIVERY_PAID"==i.status||"ONLINE_CONFIRMED"==i.status||"FINISHED"==i.status)&&i.amount+i.freight-i.invoiced_amount>0&&this.chosenOrders.push(i.id)}}},methods:{getOrderFromId:function(e){for(var t=0;t<this.orderList.length;t++)if(this.orderList[t].id===e)return this.orderList[t]},getList:function(e,t,n){var i=this,a="/api/v2/admin/orders/list-v2?type="+e;t&&(a+="&since_id="+t),n&&(n.customer?a+="&customer="+n.customer:n.managerId&&(a+="&manager_id="+n.managerId)),this.$http.get(a).then(function(a){if(a.data.result&&0!==a.data.result)o.callback.success(a.data);else{var r=[];t?r=i.orderList.concat(a.data.orders):(r=a.data.orders,i.chooseAllOrNot=!1,i.chosenOrders=[]),i.orderList=(0,s.unique)(r),i.type=e,i.$set("sinceId",a.data.since_id||""),n?i.filterParams=n:i.filterParams={customer:"",managerId:0}}},function(e){o.callback.error(e)})},clickToApplyInvoice:function(){this.dataForApplyInvoiceDialog.show=!0,this.dataForApplyInvoiceDialog.orderIds=this.chosenOrders,this.dataForApplyInvoiceDialog.maxApplyAmount=0;for(var e=0;e<this.chosenOrders.length;e++){var t=this.getOrderFromId(this.chosenOrders[e]);this.dataForApplyInvoiceDialog.maxApplyAmount+=t.amount+t.freight-t.invoiced_amount}this.dataForApplyInvoiceDialog.invoiceInfo={amount:"",content:"",title:"",zengzhishui:void 0,remark:"",consignee_name:"",consignee_phone:"",address:""}},getManager:function(){var e=this,t="/api/v2/admin/permissions/manager-list";this.$http.get(t).then(function(t){t.data.result&&0!==t.data.result?o.callback.success(t.data):e.managerList=t.data.data},function(e){o.callback.error(e)})},getManagerName:function(e){for(var t=0;t<this.managerList.length;t++)if(this.managerList[t].id===e)return this.managerList[t].display_name;return""},getFilterParams:function(){var e={customer:"",managerId:0};return"customer"===this.filterType?e.customer=this.customerKeyword:e.managerId=this.managerChoosed,e},getQueryDesc:function(){if(this.filterParams.customer||this.filterParams.managerId)return this.filterParams.customer?"客户信息 {"+this.filterParams.customer+"} 的查询结果：":this.filterParams.managerId?"客户经理 {"+this.getManagerName(this.filterParams.managerId)+"} 的查询结果：":void 0}}}},163:function(e,t){e.exports=' <div class=container-fluid _v-13e1c2ad=""> <ul class=breadcrumb _v-13e1c2ad=""> <li _v-13e1c2ad="">订单系统</li> <li _v-13e1c2ad="">订单管理</li> <li _v-13e1c2ad="">合并开票</li> </ul> <div class=pull-right _v-13e1c2ad=""> <a class="btn btn-info btn-sm" v-if=permissionList.applyInvoice :disabled="chosenOrders.length === 0" @click=clickToApplyInvoice _v-13e1c2ad="">申请开票</a> <a class="btn btn-info btn-sm" v-link="{path: \'/order/list\'}" _v-13e1c2ad="">取消</a> </div> <ul class="nav nav-pills" _v-13e1c2ad=""> <li :class="{\'active\': type === \'UNHANDLED\'}" v-if=permissionList.soyyinOrderList _v-13e1c2ad=""><a @click="getList(\'UNHANDLED\')" _v-13e1c2ad="">未处理酱印网订单</a></li> <li :class="{\'active\': type === \'ASSIGNED\'}" v-if=permissionList.myOrderList _v-13e1c2ad=""><a @click="getList(\'ASSIGNED\')" _v-13e1c2ad="">我的订单</a></li> <li :class="{\'active\': type === \'CREATED\'}" v-if=permissionList.createByMeOrderList _v-13e1c2ad=""><a @click="getList(\'CREATED\')" _v-13e1c2ad="">由我创建</a></li> <li :class="{\'active\': type === \'ALL\'}" v-if=permissionList.allOrderList _v-13e1c2ad=""><a @click="getList(\'ALL\')" _v-13e1c2ad="">全部订单</a></li> </ul> <p class=clearfix _v-13e1c2ad=""></p> <form class=form-inline style=margin-bottom:10px v-if="permissionList.soyyinOrderList || permissionList.myOrderList || permissionList.createByMeOrderList || permissionList.allOrderList" _v-13e1c2ad=""> <label class=control-label for=fitlerType _v-13e1c2ad="">筛选：</label> <select class="form-control input-sm" id=fitlerType style=width:80px v-model=filterType _v-13e1c2ad=""> <option value=customer _v-13e1c2ad="">客户信息</option> <option value=manager _v-13e1c2ad="">客户经理</option> </select> <input v-if="filterType === \'customer\'" class="form-control input-sm" style=width:120px;margin-left:20px type=text placeholder=请输入客户信息 v-model=customerKeyword _v-13e1c2ad=""> <select v-else="" class="form-control input-sm" style=width:120px;margin-left:20px v-model=managerChoosed number="" _v-13e1c2ad=""> <option value=0 _v-13e1c2ad="">全部</option> <option v-for="manager of managerList" :value=manager.id _v-13e1c2ad="">{{manager.display_name}}</option> </select> <a class="btn btn-info btn-sm" style="margin-left:30px;padding:6px 20px" @click="getList(type, \'\', getFilterParams())" _v-13e1c2ad="">查询</a> </form> <h5 v-show="filterParams.customer || filterParams.managerId" _v-13e1c2ad="">{{getQueryDesc()}}</h5> <table class="table table-bordered table-hover order-table" _v-13e1c2ad=""> <thead _v-13e1c2ad=""> <tr _v-13e1c2ad=""> <th style=width:3% _v-13e1c2ad=""><input type=checkbox v-model=chooseAllOrNot _v-13e1c2ad=""></th> <th style=width:10% _v-13e1c2ad="">订单日期</th> <th style=width:10% _v-13e1c2ad="">订单号</th> <th style=width:20% _v-13e1c2ad="">客户</th> <th style=width:9% _v-13e1c2ad="">客户经理</th> <th style=width:11% _v-13e1c2ad="">总价/利润</th> <th style=width:10% _v-13e1c2ad="">订单状态</th> <th style=width:9% _v-13e1c2ad="">开票情况</th> <th style=width:10% _v-13e1c2ad="">付款情况</th> <th style=width:8% _v-13e1c2ad="">操作</th> </tr> </thead> <tbody _v-13e1c2ad=""> <tr v-for="item of orderList" _v-13e1c2ad=""> <td _v-13e1c2ad=""><input type=checkbox value={{item.id}} :disabled="!((item.status == \'DELIVERY_CONFIRMED\' || item.status == \'DELIVERY_PAID\' || item.status == \'ONLINE_CONFIRMED\' || item.status == \'FINISHED\') &amp;&amp; (item.amount + item.freight - item.invoiced_amount > 0))" v-model=chosenOrders number="" _v-13e1c2ad=""></td> <td _v-13e1c2ad="">{{item.time | dateFormat \'toDate\'}}</td> <td _v-13e1c2ad="">{{item.id}}</td> <td _v-13e1c2ad="">{{item.customer.name + (item.customer.company ? \'/\' + item.customer.company : \'\')}}</td> <td _v-13e1c2ad="">{{item.manager ? item.manager.display_name : \'\'}}</td> <td _v-13e1c2ad="">{{(item.amount + item.freight) | realPrice}}{{item.is_priced ? \'\' : \'+?\'}} / {{(item.status === \'FINISHED\' ? (item.amount + item.freight - item.cost - item.extra_cost - item.logistics_cost - item.invoice_logistics_cost - item.refunded_amount) : \'\') | realPrice}}{{item.status === \'FINISHED\' ? \'\' : \'?\'}}元</td> <td v-bind:class="{\'text-success\': item.status === \'FINISHED\', \'text-danger\': item.status === \'CANCELED\'}" _v-13e1c2ad="">{{item.status | orderStatusFilter}}</td> <td _v-13e1c2ad="">{{item.invoiced_amount &gt; 0 ? (item.invoiced_amount &gt;= item.amount + item.freight ? \'已开票\' : \'已部分开票\') : \'\'}}</td> <td _v-13e1c2ad="">{{item.paid_amount &gt; 0 ? (item.paid_amount === item.amount + item.freight ? \'已付款\' : \'已付款\' + Math.round(item.paid_amount / (item.amount + item.freight) *100) + \'%\') : \'\'}}</td> <td _v-13e1c2ad=""><a class=btn-link v-link="{path:\'/order/detail/\'+item.id}" target=_blank _v-13e1c2ad="">查看详情</a></td> </tr> </tbody> </table> <a class="btn btn-primary" v-if=sinceId @click="getList(type, sinceId, filterParams)" _v-13e1c2ad="">查看更多</a> <apply-invoice-dialog v-if=permissionList.applyInvoice :show.sync=dataForApplyInvoiceDialog.show :order-ids=dataForApplyInvoiceDialog.orderIds :invoice-info=dataForApplyInvoiceDialog.invoiceInfo :max-apply-amount=dataForApplyInvoiceDialog.maxApplyAmount _v-13e1c2ad=""></apply-invoice-dialog> </div> '}});
//# sourceMappingURL=5.js.map