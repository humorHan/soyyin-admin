webpackJsonp([7],{80:function(t,e,s){var i,a;s(81),i=s(83),a=s(84),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},81:function(t,e,s){var i=s(82);"string"==typeof i&&(i=[[t.id,i,""]]);s(40)(i,{});i.locals&&(t.exports=i.locals)},82:function(t,e,s){e=t.exports=s(39)(),e.push([t.id,".popuptips-container[_v-d1dee2ce]{position:fixed;left:50%;top:40%;z-index:2000}.panel[_v-d1dee2ce]{position:relative;left:-50%}.fade-transition[_v-d1dee2ce]{-webkit-transition:all 1s ease;transition:all 1s ease}.fade-leave[_v-d1dee2ce]{opacity:0}","",{version:3,sources:["/./src/components/popupTips.vue.style"],names:[],mappings:"AAuCA,kCACA,eAAA,AACA,SAAA,AACA,QAAA,AACA,YAAA,CACA,AACA,oBACA,kBAAA,AACA,SAAA,CACA,AAEA,8BACA,+BAAA,sBAAA,CACA,AAEA,yBACA,SAAA,CACA",file:"popupTips.vue",sourcesContent:['<!-- popupTips.vue -->\n<template>\n\t<div class="popuptips-container" v-if="show" transition="fade">\n\t    <div class="panel panel-{{ tipsType }}">\n\t\t\t<div class="panel-heading">\n\t\t   \t\t<h3 class="panel-title">{{ tipsTitle }}</h3>\n\t\t\t</div>\n\t\t\t<div class="panel-body">\n\t\t    \t{{ tipsContent }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n    name: \'PopupTipsView\',\n    replace: false,\n    props: {\n    \tshow: Boolean,\n    \ttipsType: String,\n    \ttipsTitle: String,\n    \ttipsContent: String\n    },\n    watch: {\n        show(val, oldVal) {\n            if (val === true) {\n            \tsetTimeout(() => {\n            \t\tthis.show = false;\n            \t}, 1000);\n            }\n        },\n    },\n}\n\n</script>\n\n<style scoped>\n.popuptips-container {\n\tposition: fixed;\n\tleft: 50%;\n\ttop: 40%;\n    z-index: 2000;\n}\n.panel {\n\tposition: relative;\n    left: -50%;\n}\n\n.fade-transition {\n  transition: all 1s ease;\n}\n\n.fade-leave {\n  opacity: 0;\n}\n</style>'],sourceRoot:"webpack://"}])},83:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"PopupTipsView",replace:!1,props:{show:Boolean,tipsType:String,tipsTitle:String,tipsContent:String},watch:{show:function(t,e){var s=this;t===!0&&setTimeout(function(){s.show=!1},1e3)}}}},84:function(t,e){t.exports=' <div class=popuptips-container v-if=show transition=fade _v-d1dee2ce=""> <div class="panel panel-{{ tipsType }}" _v-d1dee2ce=""> <div class=panel-heading _v-d1dee2ce=""> <h3 class=panel-title _v-d1dee2ce="">{{ tipsTitle }}</h3> </div> <div class=panel-body _v-d1dee2ce=""> {{ tipsContent }} </div> </div> </div> '},85:function(t,e){"use strict";function s(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="产品名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="产品名称不能为空",e)}function i(t){var e={};return e.ok=!1,t?t.length>12?(e.errorMsg="产品数量长度不能大于12",e):(e.ok=!0,e):(e.errorMsg="产品数量不能为空",e)}function a(t){var e={};return e.ok=!1,!t||t<0?(e.errorMsg="产品价格不能为空且必须为正数",e):(e.ok=!0,e)}function r(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="客户名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="客户名称不能为空",e)}function n(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="收货人名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="收货人名称不能为空",e)}function o(t){var e={};e.ok=!1;var s=/^[0-9]{11}$/;return t?s.test(t)?(e.ok=!0,e):(e.errorMsg="收货人手机格式有误",e):(e.errorMsg="收货人手机不能为空",e)}function l(t,e){var s={};return s.ok=!1,0===t?(s.errorMsg="请选择收货人所在地省市区",s):e?e.length>50?(s.errorMsg="收货人详细地址不能大于50",s):(s.ok=!0,s):(s.errorMsg="收货人详细地址不能为空",s)}function d(t){var e={};return e.ok=!1,!t||t<0?(e.errorMsg="开票金额不能为空且必须为正数",e):(e.ok=!0,e)}function p(t,e){var s={};return s.ok=!1,e?e.length>50?(s.errorMsg=t+"长度不能大于50",s):(s.ok=!0,s):(s.errorMsg=t+"不能为空",s)}function c(t,e){var s={};return s.ok=!1,void 0===t||null===t||""===t?(s.errorMsg="使用额度不能为空",s):t<=0||t>e?(s.errorMsg="使用额度必须为正数且不能超过"+e/100+"元",s):(s.ok=!0,s)}function u(t,e){var s={};return s.ok=!1,void 0===t||null===t||""===t?(s.errorMsg="补充金额不能为空",s):t<=e?(s.errorMsg="补充金额必须大于"+e/100+"元",s):(s.ok=!0,s)}function m(t){var e={};return e.ok=!1,void 0===t||null===t||""===t?(e.errorMsg="额外成本不能为空",e):t<0?(e.errorMsg="额外成本必须大于等于0",e):(e.ok=!0,e)}function g(t,e){var s={};return s.ok=!1,e?e.length>2e3?(s.errorMsg=t+"长度不能大于2000",s):(s.ok=!0,s):(s.errorMsg=t+"不能为空",s)}function v(t,e){var s={};return s.ok=!1,t?t<0?(s.errorMsg="成本必须大于0",s):(s.ok=!0,s):e?(s.ok=!0,s):(s.errorMsg="成本不能为空或者0",s)}function h(t){var e={};return e.ok=!1,void 0===t||null===t||""===t?(e.errorMsg="物流成本不能为空",e):t<0?(e.errorMsg="物流成本必须大于等于0",e):(e.ok=!0,e)}function f(t,e){var s={};return s.ok=!1,e?e.length>2e3?(s.errorMsg=t+"长度不能大于2000",s):(s.ok=!0,s):(s.errorMsg=t+"不能为空",s)}function b(t,e){var s={};return s.ok=!1,!t||t<0?(s.errorMsg="退款金额不能为空且必须为正数",s):t>e?(s.errorMsg="退款金额不能大于"+e/100+"元",s):(s.ok=!0,s)}function y(t){var e={};return e.ok=!1,t?t.length>50?(e.errorMsg="对方账号长度不能大于50",e):(e.ok=!0,e):(e.errorMsg="对方账号不能为空",e)}function _(t){var e={};return e.ok=!1,t?t.length>2e3?(e.errorMsg="退款原因长度不能大于2000",e):(e.ok=!0,e):(e.errorMsg="退款原因不能为空",e)}function I(t,e){var s={};return s.ok=!1,!t||t<0?(s.errorMsg="付款金额不能为空且必须为正数",s):t>e?(s.errorMsg="付款金额不能大于该订单剩余的待支付金额("+e/100+"元)",s):(s.ok=!0,s)}function w(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="供应商名称长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="供应商名称不能为空",e)}function A(t){var e={};return e.ok=!1,t?t.length>20?(e.errorMsg="真实姓名长度不能大于20",e):(e.ok=!0,e):(e.errorMsg="真实姓名不能为空",e)}function k(t){var e={};return e.ok=!1,t?t.length>50?(e.errorMsg="用户名长度不能大于50",e):(e.ok=!0,e):(e.errorMsg="用户名不能为空",e)}function L(t){var e={};e.ok=!1;var s=/^[a-zA-Z0-9]*$/;return t?t.length>20?(e.errorMsg="密码长度不能超过20",e):s.test(t)?(e.ok=!0,e):(e.errorMsg="密码只能包含英文字母和数字",e):(e.errorMsg="密码不能为空",e)}Object.defineProperty(e,"__esModule",{value:!0});var x="******";e.orderValidator={validateProductName:s,validateProductQuantity:i,validateProductPrice:a,validateCustomerName:r,validateConsigneeName:n,validateConsigneePhone:o,validateConsigneeAddress:l,validateInvoiceAmount:d,validateInvoiceItem:p,validateApplyInvoiceAmount:c,validateExtraAmount:u,validateExtraCost:m,validateAfterSaleItem:g,validateProductCost:v,validateLogisticsCost:h,validateLogisticsItem:f,validateRefundAmount:b,validateRefundAccount:y,validateRefundReason:_},e.financeValidator={validatePaymentAmount:I},e.crmValidator={validateSupplierName:w,validateDisplayName:A,validateUserName:k,validatePassword:L,DEFAULT_PASSWORD:x}},115:function(t,e,s){var i,a;i=s(116),a=s(117),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},116:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"ConsigneeInfoWithLogisticsView",props:["consigneeItem","canAddLogistics","index"],data:function(){return{}},methods:{clickToAddLogistics:function(){this.$dispatch("click-to-add-logistics",this.consigneeItem)}}}},117:function(t,e){t.exports=' <div class="panel panel-default"> <div class=panel-body> <div class=row> <div class=col-lg-6> <h4>收货人{{index + 1}}</h4> <div class=row style="margin: 0"> <label class=pull-left>收货人姓名：</label> <p class=pull-left style="width: 80%">{{consigneeItem.name}}</p> </div> <div class=row style="margin: 0"> <label class=pull-left>手机号码：</label> <p class=pull-left style="width: 80%">{{consigneeItem.phone}}</p> </div> <div class=row style="margin: 0"> <label class=pull-left>收货地址：</label> <p class=pull-left style="width: 80%">{{consigneeItem.full_address}}</p> </div> <div class=row style="margin: 0" v-if=consigneeItem.post_code> <label class=pull-left>邮编：</label> <p class=pull-left style="width: 80%">{{consigneeItem.post_code}}</p> </div> <div class=row style="margin: 0" v-if=consigneeItem.remark> <label class=pull-left>收货备注：</label> <p class=pull-left style="width: 80%">{{consigneeItem.remark}}</p> </div> </div> <div class=col-lg-6> <a class="pull-right btn btn-info btn-sm" v-if=canAddLogistics @click=clickToAddLogistics>录入</a> <h4>物流信息</h4> <p v-if="consigneeItem.logistics.length === 0">未发货，暂无物流信息</p> <template v-else> <div class=row style="margin: 0" v-for="item of consigneeItem.logistics"> <p class=pull-left>{{$index + 1}}、</p> <p class=pull-left style="width: 90%">{{item.delivery_method}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{item.express}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{item.express_order_id}}<br>{{item.cost | realPrice}}元&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{item.create_time | dateFormat}}录入<br>{{item.remark}}</p> </div> </template> </div> </div> </div> </div> '},169:function(t,e,s){var i,a;s(170),i=s(172),a=s(178),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},170:function(t,e,s){var i=s(171);"string"==typeof i&&(i=[[t.id,i,""]]);s(40)(i,{});i.locals&&(t.exports=i.locals)},171:function(t,e,s){e=t.exports=s(39)(),e.push([t.id,".nav-pills>li>a[_v-1d09684a]{cursor:pointer}.order-table[_v-1d09684a],.order-thead-table[_v-1d09684a],.product-table[_v-1d09684a],.product-thead-table[_v-1d09684a]{table-layout:fixed}.order-table td[_v-1d09684a],.order-thead-table th[_v-1d09684a],.product-table td[_v-1d09684a],.product-thead-table th[_v-1d09684a]{text-align:center;vertical-align:middle}.btn-link[_v-1d09684a],.order-table td .btn-link[_v-1d09684a],.product-table td .btn-link[_v-1d09684a]{text-decoration:none;cursor:pointer}.btn-link[_v-1d09684a]:hover,.order-table td .btn-link[_v-1d09684a]:hover,.product-table td .btn-link[_v-1d09684a]:hover{text-decoration:underline}","",{version:3,sources:["/./src/views/order/making.vue.style"],names:[],mappings:"AAsaA,6BACA,cAAA,CACA,AAEA,wHACA,kBAAA,CACA,AAEA,oIACA,kBAAA,AACA,qBAAA,CACA,AAEA,uGACA,qBAAA,AACA,cAAA,CACA,AAEA,yHACA,yBAAA,CACA",file:"making.vue",sourcesContent:['<!-- making.vue -->\n<template>\n    <div class="container-fluid">\n        <ul class="breadcrumb">\n            <li>订单系统</li>\n            <li>制作管理</li>\n        </ul>\n        <ul class="nav nav-pills">\n            <li :class="{\'active\': type === \'ASSIGNED\'}" v-if="permissionList.assignToMeOrderList"><a @click="getList(\'ASSIGNED\')">指派给我</a></li>\n            <li :class="{\'active\': type === \'ALL\'}" v-if="permissionList.allOrderList"><a @click="getList(\'ALL\')">全部</a></li>\n        </ul>\n        <p class="clearfix"></p>\n        <form class="form-inline" style="margin-bottom:10px;" v-if="permissionList.assignToMeOrderList || permissionList.allOrderList">\n            <label class="control-label" for="fitlerType">筛选：</label>\n            <select class="form-control input-sm" id="fitlerType" style="width:80px;" v-model="filterType">\n                <option value="customer">客户信息</option>\n                <option value="supplier">供应商</option>\n                <option value="manager">客户经理</option>\n            </select>\n            <input v-if="filterType === \'customer\'" class="form-control input-sm" style="width:120px;margin-left:20px;" type="text" placeholder="请输入客户信息" v-model="customerKeyword">\n            <template v-else>\n                <select v-if="filterType === \'supplier\'" class="form-control input-sm" style="width:120px;margin-left:20px;" v-model="supplierChoosed" number>\n                    <option value="0">全部</option>\n                    <option v-for="supplier of supplierList" :value="supplier.id">{{supplier.name}}</option>\n                </select>\n                <select v-else class="form-control input-sm" style="width:120px;margin-left:20px;" v-model="managerChoosed" number>\n                    <option value="0">全部</option>\n                    <option v-for="manager of managerList" :value="manager.id">{{manager.display_name}}</option>\n                </select>\n            </template>\n            <a class="btn btn-info btn-sm" style="margin-left:30px;padding:6px 20px;" @click="getList(type, \'\', getFilterParams())">查询</a>\n        </form>\n        <h5 v-show="filterParams.customer || filterParams.managerId || filterParams.supplierId">{{getQueryDesc()}}</h5>\n        <table class="table order-thead-table" style="margin-bottom:0px;">\n            <thead>\n                <tr style="height:40px;background-color:#eee;">\n                    <th style="width:6%;">序号</th>\n                    <th style="width:13%;">订单日期</th>\n                    <th style="width:18%;">订单编号</th>\n                    <th style="width:15%;">客户经理/客服</th>\n                    <th style="width:40%;">客户名称/公司</th>\n                    <th style="width:8%;">操作</th>\n                </tr>\n            </thead>\n        </table>\n        <div style="margin-left:15px;">\n            <table class="table product-thead-table">\n                <thead>\n                    <tr style="background-color:#eee;font-size:14px;">\n                        <th style="width:6%;">ID</th>\n                        <th style="width:8%;">产品名称</th>\n                        <th style="width:17%;">参数</th>\n                        <th style="width:8%;">数量</th>\n                        <th style="width:9%;">到货时间要求</th>\n                        <th style="width:8%;">印刷文件</th>\n                        <th style="width:8%;">供应商</th>\n                        <th style="width:8%;">制作负责人</th>\n                        <th style="width:10%;">制作状态</th>\n                        <th style="width:8%;">成本(元)</th>\n                        <th style="width:10%;">操作</th>\n                    </tr>\n                </thead>\n            </table>\n        </div>\n        <template v-for="orderItem in orderList">\n            <table class="table table-bordered table-hover order-table" style="margin-bottom:0px;">\n                <tbody>\n                    <tr style="height:45px;">\n                        <td style="width:6%;"><b>{{$index + 1}}</b></td>\n                        <td style="width:13%;">{{orderItem.time | dateFormat \'toDate\'}}</td>\n                        <td style="width:18%;"><a class="btn-link" v-link="{path:\'/order/detail/\'+orderItem.id}" target="_blank">{{orderItem.id}}</a></td>\n                        <td style="width:15%;">{{orderItem.manager ? orderItem.manager.display_name : \'\'}}</td>\n                        <td style="width:40%;">{{orderItem.customer.name + (orderItem.customer.company ? \'/\' + orderItem.customer.company : \'\')}}</td>\n                        <td style="width:8%;"><a class="btn-link" @click="showOrHideOrderItem(orderItem)">{{orderItem.showAll ? \'收起\' : \'展开\'}}</a></td>\n                    </tr>\n                </tbody>\n            </table>\n            <div style="margin-left:15px;margin-bottom:15px;">\n                <table class="table table-bordered table-hover product-table" style="margin-bottom:0px;">\n                    <tbody>\n                        <tr v-for="item of orderItem.items">\n                            <td style="width:6%;">{{item.id}}</td>\n                            <template v-if="item.is_custom">\n                                <td style="width:8%;">{{item.detail.name}}</td>\n                                <td style="width:17%;">{{item.detail.size}}{{(item.detail.size && (item.detail.caizhi || item.detail.others)) ? \'_\' : \'\'}}{{item.detail.caizhi}}{{(item.detail.caizhi && item.detail.others) ? \'_\' : \'\'}}{{item.detail.others}}</td>\n                                <td style="width:8%;">{{item.detail.quantity}}</td>\n                            </template>\n                            <template v-else>\n                                <td style="width:8%;">\n                                    <a class="btn-link" :href="\'http://www.soyyin.com/product?id=\'+item.product_id+\'#\'+item.brief" target="_blank">{{item.title}}</a>\n                                </td>\n                                <td style="width:17%;">{{item.brief}}</td>\n                                <td style="width:8%;">{{item.quantity}}</td>\n                            </template>\n                            <td style="width:9%;">{{item.arrival_time}}</td>\n                            <td style="width:8%;"><a class="btn-link" v-if="item.file" :href="item.file.file_key | getQiniuUrl" target="_blank">{{item.file.file_name}}</a></td>\n                            <td style="width:8%;">{{item.supplier ? item.supplier.name : \'\'}}</td>\n                            <td style="width:8%;">{{item.producer ? item.producer.name : \'\'}}</td>\n                            <td style="width:10%;" v-if="!item.assigning">{{item.produce_status | produceStatusFilter}}</td>\n                            <td style="width:10%;" v-else>\n                                <select class="form-control input-sm" v-model="item.assigningProduceStatus">\n                                    <option value="NOT_PRODUCE">尚未生产</option>\n                                    <option value="PRODUCING">制作中</option>\n                                    <option value="COST_ACCOUNTING">成本核算中</option>\n                                    <option value="COMPLETE">制作完成</option>\n                                </select>\n                            </td>\n                            <td style="width:8%;" v-if="!item.assigning">{{item.cost | realPrice}}</td>\n                            <td style="width:8%;" v-else>\n                                <input class="form-control input-sm" type="text" name="assigningCost" v-model="item.assigningCost | priceFilter">\n                            </td>\n                            <td style="width:10%;" v-if="!item.assigning"><a class="btn-link" v-if="permissionList.editProduceStatus && item.supplier && (orderItem.status === \'DELIVERY_CONFIRMED\' || orderItem.status === \'DELIVERY_PAID\' || orderItem.status === \'ONLINE_CONFIRMED\')" @click="changeToEditProduceStatus(item)">编辑</a></td>\n                            <td style="width:10%;" v-else>\n                                <a class="btn-link" @click="assignProduceStatus(item)">确定</a>\n                                <a class="btn-link" style="margin-left:15px;" @click="cancelEdit(item)">取消</a>  \n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n                <div class="panel panel-default" style="margin-bottom:0px;" v-show="orderItem.showAll">\n                    <div class="panel-body">\n                        <div>\n                            <h4>备注信息</h4>\n                            <p>{{orderItem.remark ? orderItem.remark : \'无\'}}</p>\n                            <h4>发货物流</h4>\n                            <template v-for="consigneeItem of orderItem.consignees">\n                                <consignee-info-with-logistics :index="$index" :consignee-item="consigneeItem" :can-add-logistics="permissionList.recordLogistics && (orderItem.status === \'DELIVERY_CONFIRMED\' || orderItem.status === \'DELIVERY_PAID\' || orderItem.status === \'ONLINE_CONFIRMED\')"></consignee-info-with-logistics>\n                            </template>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </template>\n        <a class="btn btn-primary" v-if="sinceId" @click="getList(type, sinceId, filterParams)">查看更多</a>\n        <record-logistics-dialog :show.sync="dataForRecordLogisticsDialog.show" :data="dataForRecordLogisticsDialog.data"></record-logistics-dialog>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport Vue from \'vue\'\nimport popupTips from \'../../components/popupTips.vue\'\nimport consigneeInfoWithLogistics from \'./comp/consigneeInfoWithLogistics.vue\'\nimport recordLogisticsDialog from \'./comp/recordLogisticsDialog.vue\'\nimport { callback } from \'../../store\'\nimport { unique } from \'../../filters\'\nimport { orderValidator } from \'../../store/dataValidator.js\'\nimport { permissionValidator } from \'../../store/rolePermission.js\'\n\nexport default {\n    name: \'OrderMakingView\',\n    components: {\n        popupTips,\n        consigneeInfoWithLogistics,\n        recordLogisticsDialog,\n    },\n    data() {\n        return {\n            type: \'\',\n            sinceId: \'\',\n            orderList: [],\n            permissionList: {\n                assignToMeOrderList: permissionValidator.orderSystem.making.assignToMeOrderList(),\n                allOrderList: permissionValidator.orderSystem.making.allOrderList(),\n                editProduceStatus: permissionValidator.orderSystem.making.editProduceStatus(),\n                recordLogistics: permissionValidator.orderSystem.making.recordLogistics(),\n            },\n            filterType: \'customer\',\n            customerKeyword: \'\',\n            supplierChoosed: 0,\n            supplierList: [],\n            managerChoosed: 0,\n            managerList: [],\n            filterParams: {\n                customer: \'\',\n                supplierId: 0,\n                managerId: 0,\n            },\n            dataForRecordLogisticsDialog: {\n                show: false,\n                data: {\n                    consigneeId: \'\',\n                    deliveryMethod: \'\',\n                    express: \'\',\n                    expressOrderId: \'\',\n                    logisticsCost: \'\',\n                    logisticsRemark: \'\',\n                },\n            },\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    ready() {\n        var getFilterItemsFlag = true;\n        if (this.permissionList.assignToMeOrderList) {\n            this.getList(\'ASSIGNED\');\n        } else if (this.permissions.allOrderList) {\n            this.getList(\'ALL\');\n        } else {\n            getFilterItemsFlag = false;\n        }\n        if (getFilterItemsFlag) {\n            this.getManager();\n            this.getSupplier();\n        }\n    },\n    events: {\n        \'click-to-add-logistics\'(consigneeItem) {\n            this.dataForRecordLogisticsDialog.show = true;\n            this.dataForRecordLogisticsDialog.data.consigneeId = consigneeItem.id;\n            this.dataForRecordLogisticsDialog.data.deliveryMethod = \'\';\n            this.dataForRecordLogisticsDialog.data.express = \'\';\n            this.dataForRecordLogisticsDialog.data.expressOrderId = \'\';\n            this.dataForRecordLogisticsDialog.data.logisticsCost = \'\';\n            this.dataForRecordLogisticsDialog.data.logisticsRemark = \'\';\n            this.dataForRecordLogisticsDialog.data.passingData = consigneeItem;\n        },\n        \'add-logistics\'(data, consigneeItem) {\n            consigneeItem.logistics.push({\n                id: \'\',\n                create_time: (new Date()).getTime(),\n                delivery_method: data.delivery_method,\n                express: data.express,\n                express_order_id: data.express_order_id,\n                cost: data.cost,\n                remark: data.remark,\n            });\n        },\n    },\n    methods: {\n        getList(type, sinceId, filterParams) {\n            var url = \'/api/v2/admin/produce/order-list?limit=50&type=\' + type;\n            if (sinceId) {\n                url += \'&since_id=\' + sinceId;\n            }\n            if (filterParams) {\n                if (filterParams.customer) {\n                    url += \'&customer=\' + filterParams.customer;\n                } else if (filterParams.supplierId) {\n                    url += \'&supplier_id=\' + filterParams.supplierId;\n                } else if (filterParams.managerId) {\n                    url += \'&manager_id=\' + filterParams.managerId;\n                } \n            }\n            this.$http.get(url)\n            .then((response) => {\n                if (!response.data.result || response.data.result === 0) {\n                    var arr = [];\n                    if (sinceId) {\n                        arr = this.orderList.concat(this.preprocessData(response.data.orders, filterParams));\n                    } else {\n                        arr = this.preprocessData(response.data.orders, filterParams);\n                    }\n                    this.orderList = unique(arr);\n                    this.type = type;\n                    this.$set("sinceId", response.data.since_id || \'\');\n                    if (filterParams) {\n                        this.filterParams = filterParams;\n                    } else {\n                        this.filterParams = {\n                            customer: \'\',\n                            supplierId: 0,\n                            managerId: 0,\n                        };\n                    }\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        showOrHideOrderItem(orderItem) {\n            if (orderItem.showAll === undefined) {\n                Vue.set(orderItem, \'showAll\', true);\n            } else {\n                orderItem.showAll = !orderItem.showAll;\n            }\n        },\n        changeToEditProduceStatus(productItem) {\n            productItem.assigningProduceStatus = productItem.produce_status;\n            Vue.set(productItem, \'assigningCost\', productItem.cost);\n            if (productItem.assigning === undefined) {\n                Vue.set(productItem, \'assigning\', true);\n            } else {\n                productItem.assigning = true;\n            }\n        },\n        cancelEdit(productItem) {\n            productItem.assigning = false;\n        },\n        validateProduceStatus(productItem) {\n            var result = orderValidator.validateProductCost(productItem.assigningCost, productItem.assigningProduceStatus === \'COMPLETE\' ? false : true);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        assignProduceStatus(productItem) {\n            var result = this.validateProduceStatus(productItem);\n            if (result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                return;\n            }\n            var url = \'/api/v2/admin/produce/update-status?item_id=\' + productItem.id;\n            var data = {\n                status: productItem.assigningProduceStatus,\n            };\n            if (productItem.assigningCost) {\n                data.cost = productItem.assigningCost;\n            }\n            this.$http.post(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    productItem.produce_status = data.status;\n                    productItem.cost = data.cost;\n                    productItem.assigning = false;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        getManager() {\n            var url = \'/api/v2/admin/permissions/manager-list\';\n            this.$http.get(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.managerList = response.data.data;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            })\n        },\n        getManagerName(managerId) {\n            for (let i = 0; i < this.managerList.length; i++) {\n                if (this.managerList[i].id === managerId) {\n                    return this.managerList[i].display_name;\n                }\n            }\n            return \'\';\n        },\n        getSupplier() {\n            var url = \'/api/v2/admin/suppliers/brief-list\';\n            this.$http.get(url)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0){\n                    this.supplierList = response.data.suppliers;\n                } else {\n                    callback.success(response.data);\n                }\n            },(response) => {\n                callback.error(response);\n            });\n        },\n        getSupplierName(supplierId) {\n            for (let i = 0; i < this.supplierList.length; i++) {\n                if (this.supplierList[i].id === supplierId) {\n                    return this.supplierList[i].name;\n                }\n            }\n            return \'\';\n        },\n        getFilterParams() {\n            var filterParams = {\n                customer: \'\',\n                supplierId: 0,\n                managerId: 0,\n            };\n            if (this.filterType === \'customer\') {\n                filterParams.customer = this.customerKeyword;\n            } else if (this.filterType === \'supplier\') {\n                filterParams.supplierId = this.supplierChoosed;\n            } else {\n                filterParams.managerId = this.managerChoosed;\n            }\n            return filterParams;\n        },\n        getQueryDesc() {\n            if (!this.filterParams.customer && !this.filterParams.supplierId && !this.filterParams.managerId) {\n                return;\n            }\n            if (this.filterParams.customer) {\n                return \'客户信息 {\' + this.filterParams.customer + \'} 的查询结果：\';\n            }\n            if (this.filterParams.supplierId) {\n                return \'供应商 {\' + this.getSupplierName(this.filterParams.supplierId) + \'} 的查询结果：\';\n            }\n            if (this.filterParams.managerId) {\n                return \'客户经理 {\' + this.getManagerName(this.filterParams.managerId) + \'} 的查询结果：\';\n            }\n        },\n        preprocessData(orderList, filterParams) {\n            if (filterParams && filterParams.supplierId) {\n                for (let i = 0; i < orderList.length; i++) {\n                    let items = [];\n                    let productItems = orderList[i].items;\n                    for (let j = 0; j < productItems.length; j++) {\n                        if (productItems[j].supplier && productItems[j].supplier.id === filterParams.supplierId) {\n                            items.push(productItems[j]);\n                        }\n                    }\n                    orderList[i].items = items;\n                }\n            }\n            return orderList;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.nav-pills > li > a{\n    cursor: pointer;\n}\n\n.order-table, .order-thead-table, .product-table, .product-thead-table{\n    table-layout: fixed;\n}\n\n.order-table td, .order-thead-table th, .product-table td, .product-thead-table th {\n    text-align: center;\n    vertical-align: middle;\n}\n\n.order-table td .btn-link, .product-table td .btn-link, .btn-link {\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.order-table td .btn-link:hover, .product-table td .btn-link:hover, .btn-link:hover {\n    text-decoration: underline;\n}\n</style>'],sourceRoot:"webpack://"}])},172:function(t,e,s){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=s(8),r=i(a),n=s(80),o=i(n),l=s(115),d=i(l),p=s(173),c=i(p),u=s(46),m=s(29),g=s(85),v=s(43);e.default={name:"OrderMakingView",components:{popupTips:o.default,consigneeInfoWithLogistics:d.default,recordLogisticsDialog:c.default},data:function(){return{type:"",sinceId:"",orderList:[],permissionList:{assignToMeOrderList:v.permissionValidator.orderSystem.making.assignToMeOrderList(),allOrderList:v.permissionValidator.orderSystem.making.allOrderList(),editProduceStatus:v.permissionValidator.orderSystem.making.editProduceStatus(),
recordLogistics:v.permissionValidator.orderSystem.making.recordLogistics()},filterType:"customer",customerKeyword:"",supplierChoosed:0,supplierList:[],managerChoosed:0,managerList:[],filterParams:{customer:"",supplierId:0,managerId:0},dataForRecordLogisticsDialog:{show:!1,data:{consigneeId:"",deliveryMethod:"",express:"",expressOrderId:"",logisticsCost:"",logisticsRemark:""}},dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},ready:function(){var t=!0;this.permissionList.assignToMeOrderList?this.getList("ASSIGNED"):this.permissions.allOrderList?this.getList("ALL"):t=!1,t&&(this.getManager(),this.getSupplier())},events:{"click-to-add-logistics":function(t){this.dataForRecordLogisticsDialog.show=!0,this.dataForRecordLogisticsDialog.data.consigneeId=t.id,this.dataForRecordLogisticsDialog.data.deliveryMethod="",this.dataForRecordLogisticsDialog.data.express="",this.dataForRecordLogisticsDialog.data.expressOrderId="",this.dataForRecordLogisticsDialog.data.logisticsCost="",this.dataForRecordLogisticsDialog.data.logisticsRemark="",this.dataForRecordLogisticsDialog.data.passingData=t},"add-logistics":function(t,e){e.logistics.push({id:"",create_time:(new Date).getTime(),delivery_method:t.delivery_method,express:t.express,express_order_id:t.express_order_id,cost:t.cost,remark:t.remark})}},methods:{getList:function(t,e,s){var i=this,a="/api/v2/admin/produce/order-list?limit=50&type="+t;e&&(a+="&since_id="+e),s&&(s.customer?a+="&customer="+s.customer:s.supplierId?a+="&supplier_id="+s.supplierId:s.managerId&&(a+="&manager_id="+s.managerId)),this.$http.get(a).then(function(a){if(a.data.result&&0!==a.data.result)u.callback.success(a.data);else{var r=[];r=e?i.orderList.concat(i.preprocessData(a.data.orders,s)):i.preprocessData(a.data.orders,s),i.orderList=(0,m.unique)(r),i.type=t,i.$set("sinceId",a.data.since_id||""),s?i.filterParams=s:i.filterParams={customer:"",supplierId:0,managerId:0}}},function(t){u.callback.error(t)})},showOrHideOrderItem:function(t){void 0===t.showAll?r.default.set(t,"showAll",!0):t.showAll=!t.showAll},changeToEditProduceStatus:function(t){t.assigningProduceStatus=t.produce_status,r.default.set(t,"assigningCost",t.cost),void 0===t.assigning?r.default.set(t,"assigning",!0):t.assigning=!0},cancelEdit:function(t){t.assigning=!1},validateProduceStatus:function(t){var e=g.orderValidator.validateProductCost(t.assigningCost,"COMPLETE"!==t.assigningProduceStatus);if(!e.ok)return e.errorMsg},assignProduceStatus:function(t){var e=this.validateProduceStatus(t);if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",void(this.dataForPopupTips.content=e);var s="/api/v2/admin/produce/update-status?item_id="+t.id,i={status:t.assigningProduceStatus};t.assigningCost&&(i.cost=t.assigningCost),this.$http.post(s,i).then(function(e){e.data.result&&0!==e.data.result?u.callback.success(e.data):(t.produce_status=i.status,t.cost=i.cost,t.assigning=!1)},function(t){u.callback.error(t)})},getManager:function(){var t=this,e="/api/v2/admin/permissions/manager-list";this.$http.get(e).then(function(e){e.data.result&&0!==e.data.result?u.callback.success(e.data):t.managerList=e.data.data},function(t){u.callback.error(t)})},getManagerName:function(t){for(var e=0;e<this.managerList.length;e++)if(this.managerList[e].id===t)return this.managerList[e].display_name;return""},getSupplier:function(){var t=this,e="/api/v2/admin/suppliers/brief-list";this.$http.get(e).then(function(e){e.data.result&&0!==e.data.result?u.callback.success(e.data):t.supplierList=e.data.suppliers},function(t){u.callback.error(t)})},getSupplierName:function(t){for(var e=0;e<this.supplierList.length;e++)if(this.supplierList[e].id===t)return this.supplierList[e].name;return""},getFilterParams:function(){var t={customer:"",supplierId:0,managerId:0};return"customer"===this.filterType?t.customer=this.customerKeyword:"supplier"===this.filterType?t.supplierId=this.supplierChoosed:t.managerId=this.managerChoosed,t},getQueryDesc:function(){if(this.filterParams.customer||this.filterParams.supplierId||this.filterParams.managerId)return this.filterParams.customer?"客户信息 {"+this.filterParams.customer+"} 的查询结果：":this.filterParams.supplierId?"供应商 {"+this.getSupplierName(this.filterParams.supplierId)+"} 的查询结果：":this.filterParams.managerId?"客户经理 {"+this.getManagerName(this.filterParams.managerId)+"} 的查询结果：":void 0},preprocessData:function(t,e){if(e&&e.supplierId)for(var s=0;s<t.length;s++){for(var i=[],a=t[s].items,r=0;r<a.length;r++)a[r].supplier&&a[r].supplier.id===e.supplierId&&i.push(a[r]);t[s].items=i}return t}}}},173:function(t,e,s){var i,a;s(174),i=s(176),a=s(177),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),a&&(("function"==typeof t.exports?t.exports.options:t.exports).template=a)},174:function(t,e,s){var i=s(175);"string"==typeof i&&(i=[[t.id,i,""]]);s(40)(i,{});i.locals&&(t.exports=i.locals)},175:function(t,e,s){e=t.exports=s(39)(),e.push([t.id,".modal[_v-4cc62eda]{height:100%}.modal-dialog[_v-4cc62eda]{top:20%}","",{version:3,sources:["/./src/views/order/comp/recordLogisticsDialog.vue.style"],names:[],mappings:"AAwIA,oBACA,WAAA,CACA,AAEA,2BACA,OAAA,CACA",file:"recordLogisticsDialog.vue",sourcesContent:['<!-- recordLogisticsDialog.vue -->\n<template>\n    <div class="modal" v-show="show">\n    \t<div class="modal-dialog">\n            <div class="modal-content">\n            \t<div class="modal-header">\n                    <button type="button" class="close" @click="closeDialog">&times;</button>\n                    <h4 class="modal-title">物流信息录入</h4>\n                </div>\n                <div class="modal-body">\n                    <form class="form-horizontal">\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="deliveryMethod">配送方式<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="deliveryMethod" type="text" v-model="data.deliveryMethod">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="express">快递公司<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="express" type="text" v-model="data.express">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="expressOrderId">快递单号<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="expressOrderId" type="text" v-model="data.expressOrderId">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="logisticsCost">物流成本<span class="text-danger">*</span>：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="logisticsCost" type="text" v-model="data.logisticsCost | priceFilter">\n                            </div>\n                        </div>\n                        <div class="form-group">\n                            <label class="col-lg-4 control-label" for="logisticsRemark">备注：</label>\n                            <div class="col-lg-6">\n                                <input class="form-control input-sm" id="logisticsRemark" type="text" v-model="data.logisticsRemark">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" :disabled="!buttonEnabled" @click="confirmSubmit">确定</button>\n                </div>\n            </div>\n        </div>\n        <popup-tips :show.sync="dataForPopupTips.show" :tips-type="dataForPopupTips.type" :tips-title="dataForPopupTips.title" :tips-content="dataForPopupTips.content"></popup-tips>\n    </div>\n</template>\n\n<script>\nimport popupTips from \'../../../components/popupTips.vue\'\nimport { callback } from \'../../../store\'\nimport { orderValidator } from \'../../../store/dataValidator.js\'\n\nexport default {\n    name: \'RecordLogisticsDialogView\',\n    components: {\n        popupTips,\n    },\n    props: [\'show\', \'data\', \'passingData\'],\n    data() {\n        return {\n        \tbuttonEnabled: true,\n            dataForPopupTips: {\n                show: false,\n                type: \'danger\',\n                title: \'\',\n                content: \'\',\n            },\n        }\n    },\n    methods: {\n    \tvalidateLogisticsInfo() {\n            var result;\n            var infoName = ["配送方式", "快递公司", "快递单号"];\n            var infoData = [this.data.deliveryMethod, this.data.express, this.data.expressOrderId];\n            for (let i = 0; i < infoName.length; i++) {\n                result = orderValidator.validateLogisticsItem(infoName[i], infoData[i]);\n                if (!result.ok) {\n                    return result.errorMsg;\n                }\n            }\n            result = orderValidator.validateLogisticsCost(this.data.logisticsCost);\n            if (!result.ok) {\n                return result.errorMsg;\n            }\n            return;\n        },\n        confirmSubmit() {\n            if (this.buttonEnabled) {\n                this.buttonEnabled = false;\n                this.addLogistics();\n            }\n        },\n        addLogistics() {\n        \tvar result = this.validateLogisticsInfo();\n            if(result) {\n                this.dataForPopupTips.show = true;\n                this.dataForPopupTips.title = \'输入有误\';\n                this.dataForPopupTips.content = result;\n                this.buttonEnabled = true;\n                return;\n            }\n            var url = \'/api/v2/admin/logistics/add?consignee_id=\' + this.data.consigneeId;\n            var data = {\n                delivery_method: this.data.deliveryMethod,\n                express: this.data.express,\n                express_order_id: this.data.expressOrderId,\n                cost: this.data.logisticsCost,\n                remark: this.data.logisticsRemark,\n            };\n            this.$http.post(url, data)\n            .then((response) => {\n                if(!response.data.result || response.data.result === 0) {\n                    this.show = false;\n                    this.$dispatch(\'add-logistics\', data, this.data.passingData);\n                } else {\n                    callback.success(response.data);\n                }\n                this.buttonEnabled = true;\n            },(response) => {\n                callback.error(response);\n                this.buttonEnabled = true;\n            });\n        },\n    \tcloseDialog() {\n            this.show = false;\n        },\n    }\n}\n</script>\n\n<style scoped>\n.modal {\n    height: 100%;\n}\n\n.modal-dialog {\n    top: 20%;\n}\n\n</style>'],sourceRoot:"webpack://"}])},176:function(t,e,s){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=s(80),r=i(a),n=s(46),o=s(85);e.default={name:"RecordLogisticsDialogView",components:{popupTips:r.default},props:["show","data","passingData"],data:function(){return{buttonEnabled:!0,dataForPopupTips:{show:!1,type:"danger",title:"",content:""}}},methods:{validateLogisticsInfo:function(){for(var t,e=["配送方式","快递公司","快递单号"],s=[this.data.deliveryMethod,this.data.express,this.data.expressOrderId],i=0;i<e.length;i++)if(t=o.orderValidator.validateLogisticsItem(e[i],s[i]),!t.ok)return t.errorMsg;if(t=o.orderValidator.validateLogisticsCost(this.data.logisticsCost),!t.ok)return t.errorMsg},confirmSubmit:function(){this.buttonEnabled&&(this.buttonEnabled=!1,this.addLogistics())},addLogistics:function(){var t=this,e=this.validateLogisticsInfo();if(e)return this.dataForPopupTips.show=!0,this.dataForPopupTips.title="输入有误",this.dataForPopupTips.content=e,void(this.buttonEnabled=!0);var s="/api/v2/admin/logistics/add?consignee_id="+this.data.consigneeId,i={delivery_method:this.data.deliveryMethod,express:this.data.express,express_order_id:this.data.expressOrderId,cost:this.data.logisticsCost,remark:this.data.logisticsRemark};this.$http.post(s,i).then(function(e){e.data.result&&0!==e.data.result?n.callback.success(e.data):(t.show=!1,t.$dispatch("add-logistics",i,t.data.passingData)),t.buttonEnabled=!0},function(e){n.callback.error(e),t.buttonEnabled=!0})},closeDialog:function(){this.show=!1}}}},177:function(t,e){t.exports=' <div class=modal v-show=show _v-4cc62eda=""> <div class=modal-dialog _v-4cc62eda=""> <div class=modal-content _v-4cc62eda=""> <div class=modal-header _v-4cc62eda=""> <button type=button class=close @click=closeDialog _v-4cc62eda="">×</button> <h4 class=modal-title _v-4cc62eda="">物流信息录入</h4> </div> <div class=modal-body _v-4cc62eda=""> <form class=form-horizontal _v-4cc62eda=""> <div class=form-group _v-4cc62eda=""> <label class="col-lg-4 control-label" for=deliveryMethod _v-4cc62eda="">配送方式<span class=text-danger _v-4cc62eda="">*</span>：</label> <div class=col-lg-6 _v-4cc62eda=""> <input class="form-control input-sm" id=deliveryMethod type=text v-model=data.deliveryMethod _v-4cc62eda=""> </div> </div> <div class=form-group _v-4cc62eda=""> <label class="col-lg-4 control-label" for=express _v-4cc62eda="">快递公司<span class=text-danger _v-4cc62eda="">*</span>：</label> <div class=col-lg-6 _v-4cc62eda=""> <input class="form-control input-sm" id=express type=text v-model=data.express _v-4cc62eda=""> </div> </div> <div class=form-group _v-4cc62eda=""> <label class="col-lg-4 control-label" for=expressOrderId _v-4cc62eda="">快递单号<span class=text-danger _v-4cc62eda="">*</span>：</label> <div class=col-lg-6 _v-4cc62eda=""> <input class="form-control input-sm" id=expressOrderId type=text v-model=data.expressOrderId _v-4cc62eda=""> </div> </div> <div class=form-group _v-4cc62eda=""> <label class="col-lg-4 control-label" for=logisticsCost _v-4cc62eda="">物流成本<span class=text-danger _v-4cc62eda="">*</span>：</label> <div class=col-lg-6 _v-4cc62eda=""> <input class="form-control input-sm" id=logisticsCost type=text v-model="data.logisticsCost | priceFilter" _v-4cc62eda=""> </div> </div> <div class=form-group _v-4cc62eda=""> <label class="col-lg-4 control-label" for=logisticsRemark _v-4cc62eda="">备注：</label> <div class=col-lg-6 _v-4cc62eda=""> <input class="form-control input-sm" id=logisticsRemark type=text v-model=data.logisticsRemark _v-4cc62eda=""> </div> </div> </form> </div> <div class=modal-footer _v-4cc62eda=""> <button type=button class="btn btn-primary" :disabled=!buttonEnabled @click=confirmSubmit _v-4cc62eda="">确定</button> </div> </div> </div> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-4cc62eda=""></popup-tips> </div> '},178:function(t,e){t.exports=' <div class=container-fluid _v-1d09684a=""> <ul class=breadcrumb _v-1d09684a=""> <li _v-1d09684a="">订单系统</li> <li _v-1d09684a="">制作管理</li> </ul> <ul class="nav nav-pills" _v-1d09684a=""> <li :class="{\'active\': type === \'ASSIGNED\'}" v-if=permissionList.assignToMeOrderList _v-1d09684a=""><a @click="getList(\'ASSIGNED\')" _v-1d09684a="">指派给我</a></li> <li :class="{\'active\': type === \'ALL\'}" v-if=permissionList.allOrderList _v-1d09684a=""><a @click="getList(\'ALL\')" _v-1d09684a="">全部</a></li> </ul> <p class=clearfix _v-1d09684a=""></p> <form class=form-inline style=margin-bottom:10px v-if="permissionList.assignToMeOrderList || permissionList.allOrderList" _v-1d09684a=""> <label class=control-label for=fitlerType _v-1d09684a="">筛选：</label> <select class="form-control input-sm" id=fitlerType style=width:80px v-model=filterType _v-1d09684a=""> <option value=customer _v-1d09684a="">客户信息</option> <option value=supplier _v-1d09684a="">供应商</option> <option value=manager _v-1d09684a="">客户经理</option> </select> <input v-if="filterType === \'customer\'" class="form-control input-sm" style=width:120px;margin-left:20px type=text placeholder=请输入客户信息 v-model=customerKeyword _v-1d09684a=""> <template v-else="" _v-1d09684a=""> <select v-if="filterType === \'supplier\'" class="form-control input-sm" style=width:120px;margin-left:20px v-model=supplierChoosed number="" _v-1d09684a=""> <option value=0 _v-1d09684a="">全部</option> <option v-for="supplier of supplierList" :value=supplier.id _v-1d09684a="">{{supplier.name}}</option> </select> <select v-else="" class="form-control input-sm" style=width:120px;margin-left:20px v-model=managerChoosed number="" _v-1d09684a=""> <option value=0 _v-1d09684a="">全部</option> <option v-for="manager of managerList" :value=manager.id _v-1d09684a="">{{manager.display_name}}</option> </select> </template> <a class="btn btn-info btn-sm" style="margin-left:30px;padding:6px 20px" @click="getList(type, \'\', getFilterParams())" _v-1d09684a="">查询</a> </form> <h5 v-show="filterParams.customer || filterParams.managerId || filterParams.supplierId" _v-1d09684a="">{{getQueryDesc()}}</h5> <table class="table order-thead-table" style=margin-bottom:0px _v-1d09684a=""> <thead _v-1d09684a=""> <tr style=height:40px;background-color:#eee _v-1d09684a=""> <th style=width:6% _v-1d09684a="">序号</th> <th style=width:13% _v-1d09684a="">订单日期</th> <th style=width:18% _v-1d09684a="">订单编号</th> <th style=width:15% _v-1d09684a="">客户经理/客服</th> <th style=width:40% _v-1d09684a="">客户名称/公司</th> <th style=width:8% _v-1d09684a="">操作</th> </tr> </thead> </table> <div style=margin-left:15px _v-1d09684a=""> <table class="table product-thead-table" _v-1d09684a=""> <thead _v-1d09684a=""> <tr style=background-color:#eee;font-size:14px _v-1d09684a=""> <th style=width:6% _v-1d09684a="">ID</th> <th style=width:8% _v-1d09684a="">产品名称</th> <th style=width:17% _v-1d09684a="">参数</th> <th style=width:8% _v-1d09684a="">数量</th> <th style=width:9% _v-1d09684a="">到货时间要求</th> <th style=width:8% _v-1d09684a="">印刷文件</th> <th style=width:8% _v-1d09684a="">供应商</th> <th style=width:8% _v-1d09684a="">制作负责人</th> <th style=width:10% _v-1d09684a="">制作状态</th> <th style=width:8% _v-1d09684a="">成本(元)</th> <th style=width:10% _v-1d09684a="">操作</th> </tr> </thead> </table> </div> <template v-for="orderItem in orderList" _v-1d09684a=""> <table class="table table-bordered table-hover order-table" style=margin-bottom:0px _v-1d09684a=""> <tbody _v-1d09684a=""> <tr style=height:45px _v-1d09684a=""> <td style=width:6% _v-1d09684a=""><b _v-1d09684a="">{{$index + 1}}</b></td> <td style=width:13% _v-1d09684a="">{{orderItem.time | dateFormat \'toDate\'}}</td> <td style=width:18% _v-1d09684a=""><a class=btn-link v-link="{path:\'/order/detail/\'+orderItem.id}" target=_blank _v-1d09684a="">{{orderItem.id}}</a></td> <td style=width:15% _v-1d09684a="">{{orderItem.manager ? orderItem.manager.display_name : \'\'}}</td> <td style=width:40% _v-1d09684a="">{{orderItem.customer.name + (orderItem.customer.company ? \'/\' + orderItem.customer.company : \'\')}}</td> <td style=width:8% _v-1d09684a=""><a class=btn-link @click=showOrHideOrderItem(orderItem) _v-1d09684a="">{{orderItem.showAll ? \'收起\' : \'展开\'}}</a></td> </tr> </tbody> </table> <div style=margin-left:15px;margin-bottom:15px _v-1d09684a=""> <table class="table table-bordered table-hover product-table" style=margin-bottom:0px _v-1d09684a=""> <tbody _v-1d09684a=""> <tr v-for="item of orderItem.items" _v-1d09684a=""> <td style=width:6% _v-1d09684a="">{{item.id}}</td> <template v-if=item.is_custom _v-1d09684a=""> <td style=width:8% _v-1d09684a="">{{item.detail.name}}</td> <td style=width:17% _v-1d09684a="">{{item.detail.size}}{{(item.detail.size &amp;&amp; (item.detail.caizhi || item.detail.others)) ? \'_\' : \'\'}}{{item.detail.caizhi}}{{(item.detail.caizhi &amp;&amp; item.detail.others) ? \'_\' : \'\'}}{{item.detail.others}}</td> <td style=width:8% _v-1d09684a="">{{item.detail.quantity}}</td> </template> <template v-else="" _v-1d09684a=""> <td style=width:8% _v-1d09684a=""> <a class=btn-link :href="\'http://www.soyyin.com/product?id=\'+item.product_id+\'#\'+item.brief" target=_blank _v-1d09684a="">{{item.title}}</a> </td> <td style=width:17% _v-1d09684a="">{{item.brief}}</td> <td style=width:8% _v-1d09684a="">{{item.quantity}}</td> </template> <td style=width:9% _v-1d09684a="">{{item.arrival_time}}</td> <td style=width:8% _v-1d09684a=""><a class=btn-link v-if=item.file :href="item.file.file_key | getQiniuUrl" target=_blank _v-1d09684a="">{{item.file.file_name}}</a></td> <td style=width:8% _v-1d09684a="">{{item.supplier ? item.supplier.name : \'\'}}</td> <td style=width:8% _v-1d09684a="">{{item.producer ? item.producer.name : \'\'}}</td> <td style=width:10% v-if=!item.assigning _v-1d09684a="">{{item.produce_status | produceStatusFilter}}</td> <td style=width:10% v-else="" _v-1d09684a=""> <select class="form-control input-sm" v-model=item.assigningProduceStatus _v-1d09684a=""> <option value=NOT_PRODUCE _v-1d09684a="">尚未生产</option> <option value=PRODUCING _v-1d09684a="">制作中</option> <option value=COST_ACCOUNTING _v-1d09684a="">成本核算中</option> <option value=COMPLETE _v-1d09684a="">制作完成</option> </select> </td> <td style=width:8% v-if=!item.assigning _v-1d09684a="">{{item.cost | realPrice}}</td> <td style=width:8% v-else="" _v-1d09684a=""> <input class="form-control input-sm" type=text name=assigningCost v-model="item.assigningCost | priceFilter" _v-1d09684a=""> </td> <td style=width:10% v-if=!item.assigning _v-1d09684a=""><a class=btn-link v-if="permissionList.editProduceStatus &amp;&amp; item.supplier &amp;&amp; (orderItem.status === \'DELIVERY_CONFIRMED\' || orderItem.status === \'DELIVERY_PAID\' || orderItem.status === \'ONLINE_CONFIRMED\')" @click=changeToEditProduceStatus(item) _v-1d09684a="">编辑</a></td> <td style=width:10% v-else="" _v-1d09684a=""> <a class=btn-link @click=assignProduceStatus(item) _v-1d09684a="">确定</a> <a class=btn-link style=margin-left:15px @click=cancelEdit(item) _v-1d09684a="">取消</a> </td> </tr> </tbody> </table> <div class="panel panel-default" style=margin-bottom:0px v-show=orderItem.showAll _v-1d09684a=""> <div class=panel-body _v-1d09684a=""> <div _v-1d09684a=""> <h4 _v-1d09684a="">备注信息</h4> <p _v-1d09684a="">{{orderItem.remark ? orderItem.remark : \'无\'}}</p> <h4 _v-1d09684a="">发货物流</h4> <template v-for="consigneeItem of orderItem.consignees" _v-1d09684a=""> <consignee-info-with-logistics :index=$index :consignee-item=consigneeItem :can-add-logistics="permissionList.recordLogistics &amp;&amp; (orderItem.status === \'DELIVERY_CONFIRMED\' || orderItem.status === \'DELIVERY_PAID\' || orderItem.status === \'ONLINE_CONFIRMED\')" _v-1d09684a=""></consignee-info-with-logistics> </template> </div> </div> </div> </div> </template> <a class="btn btn-primary" v-if=sinceId @click="getList(type, sinceId, filterParams)" _v-1d09684a="">查看更多</a> <record-logistics-dialog :show.sync=dataForRecordLogisticsDialog.show :data=dataForRecordLogisticsDialog.data _v-1d09684a=""></record-logistics-dialog> <popup-tips :show.sync=dataForPopupTips.show :tips-type=dataForPopupTips.type :tips-title=dataForPopupTips.title :tips-content=dataForPopupTips.content _v-1d09684a=""></popup-tips> </div> '}});
//# sourceMappingURL=7.js.map